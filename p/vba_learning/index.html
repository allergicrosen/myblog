<!DOCTYPE html>
<html lang="zh-cn" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content="VBAå…¥é—¨æ•™ç¨‹ VBAåŸºç¡€æ¦‚è¿° ä»€ä¹ˆæ˜¯VBAï¼Ÿ VBAï¼ˆVisual Basic for Applicationsï¼‰æ˜¯å¾®è½¯å¼€å‘çš„ç¼–ç¨‹è¯­è¨€ï¼ŒåµŒå…¥åœ¨Officeå¥—ä»¶ä¸­ï¼ˆå¦‚Excelã€Wordã€Outlookï¼‰ï¼Œç”¨äºè‡ªåŠ¨åŒ–é‡å¤ä»»åŠ¡ã€æ‰©å±•è½¯ä»¶åŠŸèƒ½ã€‚é€šè¿‡ç¼–å†™VBAä»£ç ï¼Œç”¨æˆ·å¯ä»¥å®ç°æ•°æ®å¤„ç†ã€æŠ¥è¡¨ç”Ÿæˆã€ç•Œé¢äº¤äº’ç­‰å¤æ‚æ“ä½œã€‚\n">
<title>VBA_learning</title>

<link rel='canonical' href='www.allergicrosen.xyz/p/vba_learning/'>

<link rel="stylesheet" href="www.allergicrosen.xyz/scss/style.min.24f2752e4eee339566d5faaf8a2441bdd05965b02398daaa153a02ccd4cbf58d.css"><meta property='og:title' content="VBA_learning">
<meta property='og:description' content="VBAå…¥é—¨æ•™ç¨‹ VBAåŸºç¡€æ¦‚è¿° ä»€ä¹ˆæ˜¯VBAï¼Ÿ VBAï¼ˆVisual Basic for Applicationsï¼‰æ˜¯å¾®è½¯å¼€å‘çš„ç¼–ç¨‹è¯­è¨€ï¼ŒåµŒå…¥åœ¨Officeå¥—ä»¶ä¸­ï¼ˆå¦‚Excelã€Wordã€Outlookï¼‰ï¼Œç”¨äºè‡ªåŠ¨åŒ–é‡å¤ä»»åŠ¡ã€æ‰©å±•è½¯ä»¶åŠŸèƒ½ã€‚é€šè¿‡ç¼–å†™VBAä»£ç ï¼Œç”¨æˆ·å¯ä»¥å®ç°æ•°æ®å¤„ç†ã€æŠ¥è¡¨ç”Ÿæˆã€ç•Œé¢äº¤äº’ç­‰å¤æ‚æ“ä½œã€‚\n">
<meta property='og:url' content='www.allergicrosen.xyz/p/vba_learning/'>
<meta property='og:site_name' content='allergicrosen'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='VBA' /><meta property='article:tag' content='ç¼–ç¨‹' /><meta property='article:published_time' content='2025-10-16T21:56:27&#43;08:00'/><meta property='article:modified_time' content='2025-10-20T22:30:44&#43;08:00'/>
<meta name="twitter:title" content="VBA_learning">
<meta name="twitter:description" content="VBAå…¥é—¨æ•™ç¨‹ VBAåŸºç¡€æ¦‚è¿° ä»€ä¹ˆæ˜¯VBAï¼Ÿ VBAï¼ˆVisual Basic for Applicationsï¼‰æ˜¯å¾®è½¯å¼€å‘çš„ç¼–ç¨‹è¯­è¨€ï¼ŒåµŒå…¥åœ¨Officeå¥—ä»¶ä¸­ï¼ˆå¦‚Excelã€Wordã€Outlookï¼‰ï¼Œç”¨äºè‡ªåŠ¨åŒ–é‡å¤ä»»åŠ¡ã€æ‰©å±•è½¯ä»¶åŠŸèƒ½ã€‚é€šè¿‡ç¼–å†™VBAä»£ç ï¼Œç”¨æˆ·å¯ä»¥å®ç°æ•°æ®å¤„ç†ã€æŠ¥è¡¨ç”Ÿæˆã€ç•Œé¢äº¤äº’ç­‰å¤æ‚æ“ä½œã€‚\n">
    <link rel="shortcut icon" href="/www.allergicrosen.xyz/favicon.ico" />
<div class="loading">
     
<svg class="pl" width="240" height="240" viewBox="0 0 240 240">
	<circle class="pl__ring pl__ring--a" cx="120" cy="120" r="105" fill="none" stroke="#000" stroke-width="20" stroke-dasharray="0 660" stroke-dashoffset="-330" stroke-linecap="round"></circle>
	<circle class="pl__ring pl__ring--b" cx="120" cy="120" r="35" fill="none" stroke="#000" stroke-width="20" stroke-dasharray="0 220" stroke-dashoffset="-110" stroke-linecap="round"></circle>
	<circle class="pl__ring pl__ring--c" cx="85" cy="120" r="70" fill="none" stroke="#000" stroke-width="20" stroke-dasharray="0 440" stroke-linecap="round"></circle>
	<circle class="pl__ring pl__ring--d" cx="155" cy="120" r="70" fill="none" stroke="#000" stroke-width="20" stroke-dasharray="0 440" stroke-linecap="round"></circle>
</svg>
</div>

<style>
    .loading {
        position: fixed;
        display: flex;
        justify-content: center;
        align-items: center;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: 99;
        background-color: #f5f5fa;
    }
	
      
.pl {
  width: 6em;
  height: 6em;
}

.pl__ring {
  animation: ringA 2s linear infinite;
}

.pl__ring--a {
  stroke: #f42f25;
}

.pl__ring--b {
  animation-name: ringB;
  stroke: #f49725;
}

.pl__ring--c {
  animation-name: ringC;
  stroke: #255ff4;
}

.pl__ring--d {
  animation-name: ringD;
  stroke: #f42582;
}

 
@keyframes ringA {
  from, 4% {
    stroke-dasharray: 0 660;
    stroke-width: 20;
    stroke-dashoffset: -330;
  }

  12% {
    stroke-dasharray: 60 600;
    stroke-width: 30;
    stroke-dashoffset: -335;
  }

  32% {
    stroke-dasharray: 60 600;
    stroke-width: 30;
    stroke-dashoffset: -595;
  }

  40%, 54% {
    stroke-dasharray: 0 660;
    stroke-width: 20;
    stroke-dashoffset: -660;
  }

  62% {
    stroke-dasharray: 60 600;
    stroke-width: 30;
    stroke-dashoffset: -665;
  }

  82% {
    stroke-dasharray: 60 600;
    stroke-width: 30;
    stroke-dashoffset: -925;
  }

  90%, to {
    stroke-dasharray: 0 660;
    stroke-width: 20;
    stroke-dashoffset: -990;
  }
}

@keyframes ringB {
  from, 12% {
    stroke-dasharray: 0 220;
    stroke-width: 20;
    stroke-dashoffset: -110;
  }

  20% {
    stroke-dasharray: 20 200;
    stroke-width: 30;
    stroke-dashoffset: -115;
  }

  40% {
    stroke-dasharray: 20 200;
    stroke-width: 30;
    stroke-dashoffset: -195;
  }

  48%, 62% {
    stroke-dasharray: 0 220;
    stroke-width: 20;
    stroke-dashoffset: -220;
  }

  70% {
    stroke-dasharray: 20 200;
    stroke-width: 30;
    stroke-dashoffset: -225;
  }

  90% {
    stroke-dasharray: 20 200;
    stroke-width: 30;
    stroke-dashoffset: -305;
  }

  98%, to {
    stroke-dasharray: 0 220;
    stroke-width: 20;
    stroke-dashoffset: -330;
  }
}

@keyframes ringC {
  from {
    stroke-dasharray: 0 440;
    stroke-width: 20;
    stroke-dashoffset: 0;
  }

  8% {
    stroke-dasharray: 40 400;
    stroke-width: 30;
    stroke-dashoffset: -5;
  }

  28% {
    stroke-dasharray: 40 400;
    stroke-width: 30;
    stroke-dashoffset: -175;
  }

  36%, 58% {
    stroke-dasharray: 0 440;
    stroke-width: 20;
    stroke-dashoffset: -220;
  }

  66% {
    stroke-dasharray: 40 400;
    stroke-width: 30;
    stroke-dashoffset: -225;
  }

  86% {
    stroke-dasharray: 40 400;
    stroke-width: 30;
    stroke-dashoffset: -395;
  }

  94%, to {
    stroke-dasharray: 0 440;
    stroke-width: 20;
    stroke-dashoffset: -440;
  }
}

@keyframes ringD {
  from, 8% {
    stroke-dasharray: 0 440;
    stroke-width: 20;
    stroke-dashoffset: 0;
  }

  16% {
    stroke-dasharray: 40 400;
    stroke-width: 30;
    stroke-dashoffset: -5;
  }

  36% {
    stroke-dasharray: 40 400;
    stroke-width: 30;
    stroke-dashoffset: -175;
  }

  44%, 50% {
    stroke-dasharray: 0 440;
    stroke-width: 20;
    stroke-dashoffset: -220;
  }

  58% {
    stroke-dasharray: 40 400;
    stroke-width: 30;
    stroke-dashoffset: -225;
  }

  78% {
    stroke-dasharray: 40 400;
    stroke-width: 30;
    stroke-dashoffset: -395;
  }

  86%, to {
    stroke-dasharray: 0 440;
    stroke-width: 20;
    stroke-dashoffset: -440;
  }
}
</style>

<script>	
    function initLoading() {
        let loading = document.querySelector(".loading");
        document.addEventListener('DOMContentLoaded', function() {
            
            loading.style.display = "none";
        });
    }

    initLoading();
</script>

    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="åˆ‡æ¢èœå•">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/www.allergicrosen.xyz/">
                
                    
                    
                    
                        
                        <img src="www.allergicrosen.xyz/img/avatar_hu_937d2c1ad8e47311.png" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
                    <span class="emoji">ğŸ‘¨â€ğŸ’»</span>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/www.allergicrosen.xyz">allergicrosen</a></h1>
            <h2 class="site-description">ä¸ªäººåšå®¢ï¼Œaaaallllergicrooosenã€‚ã€‚ã€‚</h2>
        </div>
    </header><ol class="menu-social">
            
                <li>
                    <a 
                        href='https://space.bilibili.com/386854280'
                        target="_blank"
                        title="Bilibili"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="872" height="834" viewBox="0 0 872 834">
  <metadata><?xpacket begin="ï»¿" id="W5M0MpCehiHzreSzNTczkc9d"?>
<x:xmpmeta xmlns:x="adobe:ns:meta/" x:xmptk="Adobe XMP Core 5.6-c142 79.160924, 2017/07/13-01:06:39        ">
   <rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
      <rdf:Description rdf:about=""/>
   </rdf:RDF>
</x:xmpmeta>
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                                                                                                    
                           
<?xpacket end="w"?></metadata>
<image id="å›¾å±‚_1" data-name="å›¾å±‚ 1" width="872" height="834" xlink:href="data:img/png;base64,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"/>
</svg>

                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://github.com/allergicrosen'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://main.allergicrosen.dynv6.net/'
                        target="_blank"
                        title="Personal Page"
                        rel="me"
                    >
                        
                        
                            <?xml version="1.0" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 20010904//EN"
 "http://www.w3.org/TR/2001/REC-SVG-20010904/DTD/svg10.dtd">
<svg version="1.0" xmlns="http://www.w3.org/2000/svg"
 width="35.000000pt" height="18.000000pt" viewBox="0 0 35.000000 18.000000"
 preserveAspectRatio="xMidYMid meet">

<g transform="translate(0.000000,18.000000) scale(0.100000,-0.100000)"
fill="#000000" stroke="none">
<path d="M147 148 c76 -129 75 -128 59 -128 -9 0 -29 21 -44 46 -15 25 -35 59
-45 76 l-19 31 -44 -79 c-24 -43 -44 -82 -44 -86 0 -5 15 -8 33 -8 27 0 36 6
51 34 10 19 16 40 14 46 -2 7 -12 -4 -23 -24 -12 -21 -27 -36 -38 -36 -17 0
-17 2 4 38 13 20 28 45 33 55 15 24 20 22 39 -19 16 -32 16 -37 2 -57 -17 -25
-19 -37 -6 -37 5 0 13 9 16 20 3 11 10 20 15 20 5 0 12 -9 15 -20 5 -15 15
-20 41 -20 19 0 34 3 34 8 0 4 -13 30 -29 59 -16 28 -25 57 -21 63 5 8 22 -14
45 -59 35 -67 40 -71 71 -71 19 0 34 3 34 6 0 15 -93 174 -102 174 -9 0 8 -35
64 -127 19 -32 19 -33 1 -33 -12 0 -31 24 -58 75 -22 41 -42 75 -44 75 -2 0
-9 -8 -16 -17 -11 -15 -13 -15 -24 5 -6 12 -16 22 -22 22 -6 0 -2 -15 8 -32z"/>
</g>
</svg>

                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='www.allergicrosen.xyz/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>ä¸»é¡µ</span>
            </a>
        </li>
        
        
        <li >
            <a href='www.allergicrosen.xyz/%E5%85%B3%E4%BA%8E/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>å…³äº</span>
            </a>
        </li>
        
        
        <li >
            <a href='www.allergicrosen.xyz/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>å½’æ¡£</span>
            </a>
        </li>
        
        
        <li >
            <a href='www.allergicrosen.xyz/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>æœç´¢</span>
            </a>
        </li>
        
        
        <li >
            <a href='www.allergicrosen.xyz/%E9%93%BE%E6%8E%A5/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5" />
  <path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5" />
</svg>



                
                <span>é“¾æ¥</span>
            </a>
        </li>
        
        <li class="menu-bottom-section">
            <ol class="menu">
                    
                        <li id="i18n-switch">  
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-language" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M4 5h7" />
  <path d="M9 3v2c0 4.418 -2.239 8 -5 8" />
  <path d="M5 9c-.003 2.144 2.952 3.908 6.7 4" />
  <path d="M12 20l4 -9l4 9" />
  <path d="M19.1 18h-6.2" />
</svg>



                            <select name="language" title="language" onchange="window.location.href = this.selectedOptions[0].value">
                                
                                    <option value="www.allergicrosen.xyz/en/" >English</option>
                                
                                    <option value="www.allergicrosen.xyz/" selected>ç®€ä½“ä¸­æ–‡</option>
                                
                            </select>
                        </li>
                    
                

                
                    <li id="dark-mode-toggle">
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <span>æš—è‰²æ¨¡å¼</span>
                    </li>
                
            </ol>
        </li>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">ç›®å½•</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li><a href="#vbaåŸºç¡€æ¦‚è¿°">VBAåŸºç¡€æ¦‚è¿°</a>
      <ol>
        <li><a href="#ä»€ä¹ˆæ˜¯vba">ä»€ä¹ˆæ˜¯VBAï¼Ÿ</a></li>
        <li><a href="#å¼€å‘ç¯å¢ƒè®¾ç½®">å¼€å‘ç¯å¢ƒè®¾ç½®</a></li>
      </ol>
    </li>
    <li><a href="#vbaè¯­æ³•åŸºç¡€">VBAè¯­æ³•åŸºç¡€</a>
      <ol>
        <li><a href="#å˜é‡ä¸æ•°æ®ç±»å‹">å˜é‡ä¸æ•°æ®ç±»å‹</a></li>
        <li><a href="#è¿ç®—ç¬¦ä¸è¡¨è¾¾å¼">è¿ç®—ç¬¦ä¸è¡¨è¾¾å¼</a></li>
        <li><a href="#æµç¨‹æ§åˆ¶">æµç¨‹æ§åˆ¶</a>
          <ol>
            <li><a href="#æ¡ä»¶åˆ¤æ–­">æ¡ä»¶åˆ¤æ–­</a></li>
            <li><a href="#å¾ªç¯ç»“æ„">å¾ªç¯ç»“æ„</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#excelå¯¹è±¡æ¨¡å‹æ“ä½œ">Excelå¯¹è±¡æ¨¡å‹æ“ä½œ</a>
      <ol>
        <li><a href="#å•å…ƒæ ¼ä¸èŒƒå›´æ“ä½œ">å•å…ƒæ ¼ä¸èŒƒå›´æ“ä½œ</a></li>
        <li><a href="#å·¥ä½œè¡¨ä¸å·¥ä½œç°¿">å·¥ä½œè¡¨ä¸å·¥ä½œç°¿</a></li>
      </ol>
    </li>
    <li><a href="#å®ç”¨è„šæœ¬ç¤ºä¾‹">å®ç”¨è„šæœ¬ç¤ºä¾‹</a>
      <ol>
        <li><a href="#æ•°æ®æ¸…æ´—ä¸æ ¼å¼åŒ–">æ•°æ®æ¸…æ´—ä¸æ ¼å¼åŒ–</a>
          <ol>
            <li><a href="#åˆ é™¤é‡å¤å€¼">åˆ é™¤é‡å¤å€¼</a></li>
            <li><a href="#412-æ‰¹é‡æ·»åŠ å‰ç¼€">4.1.2 æ‰¹é‡æ·»åŠ å‰ç¼€</a></li>
          </ol>
        </li>
        <li><a href="#è‡ªåŠ¨åŒ–æŠ¥è¡¨ç”Ÿæˆ">è‡ªåŠ¨åŒ–æŠ¥è¡¨ç”Ÿæˆ</a>
          <ol>
            <li><a href="#ç”Ÿæˆæ•°æ®é€è§†è¡¨">ç”Ÿæˆæ•°æ®é€è§†è¡¨</a></li>
          </ol>
        </li>
        <li><a href="#é‚®ä»¶è‡ªåŠ¨åŒ–">é‚®ä»¶è‡ªåŠ¨åŒ–</a>
          <ol>
            <li><a href="#å‘é€å¸¦é™„ä»¶çš„é‚®ä»¶">å‘é€å¸¦é™„ä»¶çš„é‚®ä»¶</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#é«˜çº§æŠ€å·§ä¸æœ€ä½³å®è·µ">é«˜çº§æŠ€å·§ä¸æœ€ä½³å®è·µ</a>
      <ol>
        <li><a href="#é”™è¯¯å¤„ç†">é”™è¯¯å¤„ç†</a></li>
        <li><a href="#è‡ªå®šä¹‰å‡½æ•°">è‡ªå®šä¹‰å‡½æ•°</a></li>
        <li><a href="#äº‹ä»¶ç¼–ç¨‹">äº‹ä»¶ç¼–ç¨‹</a></li>
      </ol>
    </li>
    <li><a href="#å›¾è¡¨ç»˜åˆ¶æ“ä½œ">å›¾è¡¨ç»˜åˆ¶æ“ä½œ</a>
      <ol>
        <li><a href="#åŸºæœ¬å›¾è¡¨åˆ›å»º">åŸºæœ¬å›¾è¡¨åˆ›å»º</a></li>
        <li><a href="#ä¸åŒç±»å‹å›¾è¡¨ç¤ºä¾‹">ä¸åŒç±»å‹å›¾è¡¨ç¤ºä¾‹</a></li>
        <li><a href="#å›¾è¡¨æ ·å¼ç¾åŒ–">å›¾è¡¨æ ·å¼ç¾åŒ–</a></li>
      </ol>
    </li>
    <li><a href="#è‡ªåŠ¨ç­›é€‰åŠŸèƒ½">è‡ªåŠ¨ç­›é€‰åŠŸèƒ½</a>
      <ol>
        <li><a href="#åŸºæœ¬è‡ªåŠ¨ç­›é€‰">åŸºæœ¬è‡ªåŠ¨ç­›é€‰</a></li>
        <li><a href="#å¤šæ¡ä»¶ç­›é€‰">å¤šæ¡ä»¶ç­›é€‰</a></li>
        <li><a href="#é«˜çº§ç­›é€‰ä½¿ç”¨æ¡ä»¶åŒºåŸŸ">é«˜çº§ç­›é€‰ï¼ˆä½¿ç”¨æ¡ä»¶åŒºåŸŸï¼‰</a></li>
        <li><a href="#å–æ¶ˆç­›é€‰ä¸æ¢å¤æ•°æ®">å–æ¶ˆç­›é€‰ä¸æ¢å¤æ•°æ®</a></li>
      </ol>
    </li>
    <li><a href="#withè¯­å¥çš„ä½¿ç”¨">Withè¯­å¥çš„ä½¿ç”¨</a>
      <ol>
        <li><a href="#withè¯­å¥åŸºç¡€ç”¨æ³•">Withè¯­å¥åŸºç¡€ç”¨æ³•</a></li>
        <li><a href="#withè¯­å¥åœ¨å¯¹è±¡æ“ä½œä¸­çš„åº”ç”¨">Withè¯­å¥åœ¨å¯¹è±¡æ“ä½œä¸­çš„åº”ç”¨</a></li>
        <li><a href="#åµŒå¥—withè¯­å¥">åµŒå¥—Withè¯­å¥</a></li>
        <li><a href="#withè¯­å¥çš„ä¼˜åŠ¿æ€»ç»“">Withè¯­å¥çš„ä¼˜åŠ¿æ€»ç»“</a></li>
      </ol>
    </li>
    <li><a href="#userformç”¨æˆ·çª—ä½“">UserFormï¼ˆç”¨æˆ·çª—ä½“ï¼‰</a>
      <ol>
        <li><a href="#åˆ›å»ºuserformçš„æ­¥éª¤">åˆ›å»ºUserFormçš„æ­¥éª¤</a></li>
        <li><a href="#åŸºæœ¬userformç¤ºä¾‹æ•°æ®å½•å…¥è¡¨å•">åŸºæœ¬UserFormç¤ºä¾‹ï¼šæ•°æ®å½•å…¥è¡¨å•</a></li>
        <li><a href="#æ˜¾ç¤ºuserformçš„ä»£ç ">æ˜¾ç¤ºUserFormçš„ä»£ç </a></li>
        <li><a href="#å¸¸ç”¨æ§ä»¶åŠå±æ€§">å¸¸ç”¨æ§ä»¶åŠå±æ€§</a></li>
        <li><a href="#å®Œæ•´userformç¤ºä¾‹æŸ¥è¯¢å·¥å…·">å®Œæ•´UserFormç¤ºä¾‹ï¼šæŸ¥è¯¢å·¥å…·</a></li>
      </ol>
    </li>
    <li><a href="#ç»¼åˆæ¡ˆä¾‹é”€å”®æ•°æ®å¤„ç†ç³»ç»Ÿ">ç»¼åˆæ¡ˆä¾‹ï¼šé”€å”®æ•°æ®å¤„ç†ç³»ç»Ÿ</a></li>
    <li><a href="#æ–‡ä»¶æ“ä½œ">æ–‡ä»¶æ“ä½œ</a>
      <ol>
        <li><a href="#æ–‡ä»¶æ“ä½œåŸºç¡€æ¦‚å¿µ">æ–‡ä»¶æ“ä½œåŸºç¡€æ¦‚å¿µ</a></li>
        <li><a href="#è¯»å–æ–‡æœ¬æ–‡ä»¶">è¯»å–æ–‡æœ¬æ–‡ä»¶</a></li>
        <li><a href="#å†™å…¥æ–‡æœ¬æ–‡ä»¶">å†™å…¥æ–‡æœ¬æ–‡ä»¶</a></li>
        <li><a href="#è¿½åŠ å†…å®¹åˆ°æ–‡ä»¶">è¿½åŠ å†…å®¹åˆ°æ–‡ä»¶</a></li>
        <li><a href="#è¯»å–æ•´ä¸ªæ–‡ä»¶å†…å®¹">è¯»å–æ•´ä¸ªæ–‡ä»¶å†…å®¹</a></li>
        <li><a href="#æ‰¹é‡å¤„ç†å¤šä¸ªæ–‡ä»¶">æ‰¹é‡å¤„ç†å¤šä¸ªæ–‡ä»¶</a></li>
        <li><a href="#æ–‡ä»¶æ“ä½œçš„é”™è¯¯å¤„ç†">æ–‡ä»¶æ“ä½œçš„é”™è¯¯å¤„ç†</a></li>
        <li><a href="#filedialogåŸºç¡€">FileDialogåŸºç¡€</a>
          <ol>
            <li><a href="#filedialogçš„å››ç§ç±»å‹">FileDialogçš„å››ç§ç±»å‹</a></li>
            <li><a href="#åŸºæœ¬ä½¿ç”¨æ–¹æ³•">åŸºæœ¬ä½¿ç”¨æ–¹æ³•</a></li>
            <li><a href="#å•æ–‡ä»¶é€‰æ‹©å¯¹è¯æ¡†æ‰“å¼€æ–‡ä»¶">å•æ–‡ä»¶é€‰æ‹©å¯¹è¯æ¡†ï¼ˆæ‰“å¼€æ–‡ä»¶ï¼‰</a></li>
            <li><a href="#å¤šæ–‡ä»¶é€‰æ‹©å¯¹è¯æ¡†">å¤šæ–‡ä»¶é€‰æ‹©å¯¹è¯æ¡†</a></li>
            <li><a href="#ä¿å­˜æ–‡ä»¶å¯¹è¯æ¡†">ä¿å­˜æ–‡ä»¶å¯¹è¯æ¡†</a></li>
            <li><a href="#æ–‡ä»¶å¤¹é€‰æ‹©å¯¹è¯æ¡†">æ–‡ä»¶å¤¹é€‰æ‹©å¯¹è¯æ¡†</a></li>
            <li><a href="#å¸¦é¢„è§ˆåŠŸèƒ½çš„æ–‡ä»¶é€‰æ‹©å™¨">å¸¦é¢„è§ˆåŠŸèƒ½çš„æ–‡ä»¶é€‰æ‹©å™¨</a></li>
            <li><a href="#ç»“åˆuserformçš„æ–‡ä»¶é€‰æ‹©å™¨">ç»“åˆUserFormçš„æ–‡ä»¶é€‰æ‹©å™¨</a></li>
            <li><a href="#æ‰¹é‡æ–‡ä»¶å¤„ç†å·¥å…·">æ‰¹é‡æ–‡ä»¶å¤„ç†å·¥å…·</a></li>
            <li><a href="#filedialogä¸ä¼ ç»Ÿæ–‡ä»¶æ“ä½œå¯¹æ¯”">FileDialogä¸ä¼ ç»Ÿæ–‡ä»¶æ“ä½œå¯¹æ¯”</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#inputboxå‡½æ•°">InputBoxå‡½æ•°</a>
      <ol>
        <li><a href="#inputboxåŸºç¡€ç”¨æ³•">InputBoxåŸºç¡€ç”¨æ³•</a></li>
        <li><a href="#inputboxçš„å®Œæ•´å‚æ•°">InputBoxçš„å®Œæ•´å‚æ•°</a></li>
        <li><a href="#å¸¦å¸®åŠ©åŠŸèƒ½çš„inputbox">å¸¦å¸®åŠ©åŠŸèƒ½çš„InputBox</a></li>
        <li><a href="#è¾“å…¥éªŒè¯ä¸å¾ªç¯">è¾“å…¥éªŒè¯ä¸å¾ªç¯</a></li>
        <li><a href="#ç»“åˆæ–‡ä»¶æ“ä½œçš„inputboxåº”ç”¨">ç»“åˆæ–‡ä»¶æ“ä½œçš„InputBoxåº”ç”¨</a></li>
        <li><a href="#å¤šæ­¥éª¤è¾“å…¥æµç¨‹">å¤šæ­¥éª¤è¾“å…¥æµç¨‹</a></li>
      </ol>
    </li>
    <li><a href="#ç»¼åˆæ¡ˆä¾‹æ–‡ä»¶ç®¡ç†å·¥å…·">ç»¼åˆæ¡ˆä¾‹ï¼šæ–‡ä»¶ç®¡ç†å·¥å…·</a></li>
    <li><a href="#è¿›é˜¶å­¦ä¹ å»ºè®®">è¿›é˜¶å­¦ä¹ å»ºè®®</a></li>
    <li><a href="#æ€»ç»“">æ€»ç»“</a></li>
    <li><a href="#é™„å½•">é™„å½•</a>
      <ol>
        <li><a href="#å‚è€ƒæ–‡ç« ">å‚è€ƒæ–‡ç« </a></li>
      </ol>
    </li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="main-article">
    <header class="article-header">

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="www.allergicrosen.xyz/categories/vba/" >
                VBA
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="www.allergicrosen.xyz/p/vba_learning/">VBA_learning</a>
        </h2>
    
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">2025-10-16</time>
            </div>
            <div>|</div>
        
        <div class="article-lastmod">
                <?xml version="1.0" encoding="utf-8"?>
<!-- Generator: Adobe Illustrator 17.0.0, SVG Export Plug-In . SVG Version: 6.00 Build 0)  -->
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg version="1.1" id="Layer_1" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns"
	 xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="59px" height="64px"
	 viewBox="0 0 59 64" enable-background="new 0 0 59 64" xml:space="preserve">
<title>Document-edit</title>
<desc>Created with Sketch.</desc>
<g id="Page-1" sketch:type="MSPage">
	<g id="Document-edit" transform="translate(1.000000, 1.000000)" sketch:type="MSLayerGroup">
		<path id="Shape_1_" sketch:type="MSShapeGroup" fill="none" stroke="#6B6C6E" stroke-width="2" d="M47,45v15c0,1.1-0.9,2-2,2H2
			c-1.1,0-2-0.9-2-2V2c0-1.1,0.9-2,2-2h25.9L47,18.1V33"/>
		<path id="Shape" sketch:type="MSShapeGroup" fill="none" stroke="#6B6C6E" stroke-width="2" d="M47,18.9H30c-1.1,0-2-0.9-2-2V1"/>
		<path id="Shape_2_" sketch:type="MSShapeGroup" fill="none" stroke="#6B6C6E" stroke-width="2" d="M9,17h13"/>
		<path id="Shape_3_" sketch:type="MSShapeGroup" fill="none" stroke="#6B6C6E" stroke-width="2" d="M9,27h31"/>
		<path id="Shape_4_" sketch:type="MSShapeGroup" fill="none" stroke="#6B6C6E" stroke-width="2" d="M9,34h31"/>
		<path id="Shape_5_" sketch:type="MSShapeGroup" fill="none" stroke="#6B6C6E" stroke-width="2" d="M9,43h24"/>
		<path id="Shape_6_" sketch:type="MSShapeGroup" fill="none" stroke="#6B6C6E" stroke-width="2" d="M9,49h17"/>
		<g id="Group" transform="translate(27.000000, 29.000000)" sketch:type="MSShapeGroup">
			<path id="Shape_8_" fill="none" stroke="#6B6C6E" stroke-width="2" stroke-linejoin="round" d="M0,30l3.9-9.4L24.2,0.3
				c0.4-0.4,1.1-0.4,1.6,0l3.9,3.9c0.4,0.4,0.4,1.1,0,1.6L9.4,26.1L0,30z"/>
			<path id="Shape_9_" fill="none" stroke="#6B6C6E" stroke-width="2" d="M21.9,2.7l5.4,5.4"/>
		</g>
	</g>
</g>
</svg>

                <time>
                    2025-10-20 22:30
                </time>
            </div>
            <div>|</div>
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    é˜…è¯»æ—¶é•¿: 29 åˆ†é’Ÿ
                </time>
            </div>
            
            <div id="viewCount">
                <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-eye"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" /><path d="M21 12c-2.4 4 -5.4 6 -9 6c-3.6 0 -6.6 -2 -9 -6c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6" /></svg>
                <time class="article-time--reading">
                    
                    <span id="vercount_value_page_pv">loading... </span>æ¬¡
                </time>
            </div>
        


        
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <h1 id="vbaå…¥é—¨æ•™ç¨‹">VBAå…¥é—¨æ•™ç¨‹
</h1><h2 id="vbaåŸºç¡€æ¦‚è¿°">VBAåŸºç¡€æ¦‚è¿°
</h2><h3 id="ä»€ä¹ˆæ˜¯vba">ä»€ä¹ˆæ˜¯VBAï¼Ÿ
</h3><p>VBAï¼ˆVisual Basic for Applicationsï¼‰æ˜¯å¾®è½¯å¼€å‘çš„ç¼–ç¨‹è¯­è¨€ï¼ŒåµŒå…¥åœ¨Officeå¥—ä»¶ä¸­ï¼ˆå¦‚Excelã€Wordã€Outlookï¼‰ï¼Œç”¨äºè‡ªåŠ¨åŒ–é‡å¤ä»»åŠ¡ã€æ‰©å±•è½¯ä»¶åŠŸèƒ½ã€‚é€šè¿‡ç¼–å†™VBAä»£ç ï¼Œç”¨æˆ·å¯ä»¥å®ç°æ•°æ®å¤„ç†ã€æŠ¥è¡¨ç”Ÿæˆã€ç•Œé¢äº¤äº’ç­‰å¤æ‚æ“ä½œã€‚</p>
<h3 id="å¼€å‘ç¯å¢ƒè®¾ç½®">å¼€å‘ç¯å¢ƒè®¾ç½®
</h3><ol>
<li><strong>å¯ç”¨å¼€å‘è€…é€‰é¡¹å¡</strong>ï¼š
<ul>
<li>Excel/Wordï¼š<code>æ–‡ä»¶ &gt; é€‰é¡¹ &gt; è‡ªå®šä¹‰åŠŸèƒ½åŒº &gt; å‹¾é€‰å¼€å‘è€…</code></li>
</ul>
</li>
<li><strong>æ‰“å¼€VBAç¼–è¾‘å™¨</strong>ï¼š
<ul>
<li>å¿«æ·é”®ï¼š<code>Alt + F11</code></li>
</ul>
</li>
<li><strong>åˆ›å»ºæ¨¡å—</strong>ï¼š
<ul>
<li>åœ¨VBAç¼–è¾‘å™¨ä¸­ï¼Œ<code>æ’å…¥ &gt; æ¨¡å—</code>ï¼Œå¼€å§‹ç¼–å†™ä»£ç ã€‚</li>
</ul>
</li>
</ol>
<h2 id="vbaè¯­æ³•åŸºç¡€">VBAè¯­æ³•åŸºç¡€
</h2><h3 id="å˜é‡ä¸æ•°æ®ç±»å‹">å˜é‡ä¸æ•°æ®ç±»å‹
</h3><p>å˜é‡ç”¨äºå­˜å‚¨æ•°æ®ï¼ŒVBAæ”¯æŒå¤šç§æ•°æ®ç±»å‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="s1">&#39; å£°æ˜å˜é‡</span>
</span></span><span class="line"><span class="cl"><span class="n">Dim</span> <span class="n">num</span> <span class="n">As</span> <span class="n">Integer</span>       <span class="s1">&#39; æ•´æ•°</span>
</span></span><span class="line"><span class="cl"><span class="n">Dim</span> <span class="n">name</span> <span class="n">As</span> <span class="ne">String</span>      <span class="s1">&#39; å­—ç¬¦ä¸²</span>
</span></span><span class="line"><span class="cl"><span class="n">Dim</span> <span class="n">price</span> <span class="n">As</span> <span class="n">Double</span>     <span class="s1">&#39; åŒç²¾åº¦æµ®ç‚¹æ•°</span>
</span></span><span class="line"><span class="cl"><span class="n">Dim</span> <span class="n">isReady</span> <span class="n">As</span> <span class="n">Boolean</span>  <span class="s1">&#39; å¸ƒå°”å€¼</span>
</span></span><span class="line"><span class="cl"><span class="n">Dim</span> <span class="n">dateValue</span> <span class="n">As</span> <span class="n">Date</span>   <span class="s1">&#39; æ—¥æœŸ</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="s1">&#39; å˜ä½“ç±»å‹ï¼ˆä¸‡èƒ½ç±»å‹ï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="n">Dim</span> <span class="k">var</span> <span class="n">As</span> <span class="n">Variant</span>
</span></span><span class="line"><span class="cl"><span class="k">var</span> <span class="o">=</span> <span class="s2">&#34;Hello&#34;</span>
</span></span><span class="line"><span class="cl"><span class="k">var</span> <span class="o">=</span> <span class="mi">123</span>
</span></span><span class="line"><span class="cl"><span class="k">var</span> <span class="o">=</span> <span class="c1">#2023-10-01#</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="s1">&#39; æ•°ç»„å£°æ˜</span>
</span></span><span class="line"><span class="cl"><span class="n">Dim</span> <span class="n">arr</span><span class="p">(</span><span class="mi">1</span> <span class="n">To</span> <span class="mi">5</span><span class="p">)</span> <span class="n">As</span> <span class="n">Integer</span>  <span class="s1">&#39; å›ºå®šå¤§å°æ•°ç»„</span>
</span></span><span class="line"><span class="cl"><span class="n">Dim</span> <span class="n">dynamicArr</span><span class="p">()</span> <span class="n">As</span> <span class="ne">String</span>  <span class="s1">&#39; åŠ¨æ€æ•°ç»„</span>
</span></span><span class="line"><span class="cl"><span class="n">ReDim</span> <span class="n">dynamicArr</span><span class="p">(</span><span class="mi">1</span> <span class="n">To</span> <span class="mi">3</span><span class="p">)</span>    <span class="s1">&#39; è°ƒæ•´åŠ¨æ€æ•°ç»„å¤§å°</span>
</span></span></code></pre></div><h3 id="è¿ç®—ç¬¦ä¸è¡¨è¾¾å¼">è¿ç®—ç¬¦ä¸è¡¨è¾¾å¼
</h3><p>VBAæ”¯æŒç®—æœ¯ã€æ¯”è¾ƒã€é€»è¾‘è¿ç®—ç¬¦ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&#39; ç®—æœ¯è¿ç®—
</span></span><span class="line"><span class="cl">result = 10 + 5 * 2       &#39; ç»“æœï¼š20
</span></span><span class="line"><span class="cl">result = (10 + 5) * 2     &#39; ç»“æœï¼š30
</span></span><span class="line"><span class="cl">result = 10 / 3           &#39; ç»“æœï¼š3.333...
</span></span><span class="line"><span class="cl">result = 10 \ 3           &#39; æ•´é™¤ï¼š3
</span></span><span class="line"><span class="cl">result = 10 Mod 3         &#39; å–ä½™ï¼š1
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">&#39; æ¯”è¾ƒè¿ç®—
</span></span><span class="line"><span class="cl">If 5 &gt; 3 Then MsgBox &#34;True&#34;
</span></span><span class="line"><span class="cl">If &#34;A&#34; = &#34;a&#34; Then MsgBox &#34;Equal&#34; &#39; åŒºåˆ†å¤§å°å†™ï¼Œè¾“å‡ºFalse
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">&#39; é€»è¾‘è¿ç®—
</span></span><span class="line"><span class="cl">If (5 &gt; 3) And (2 &lt; 4) Then MsgBox &#34;Both True&#34;
</span></span><span class="line"><span class="cl">If (5 &gt; 3) Or (2 &gt; 4) Then MsgBox &#34;At least one True&#34;
</span></span></code></pre></div><h3 id="æµç¨‹æ§åˆ¶">æµç¨‹æ§åˆ¶
</h3><h4 id="æ¡ä»¶åˆ¤æ–­">æ¡ä»¶åˆ¤æ–­
</h4><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&#39; If...Then...Else
</span></span><span class="line"><span class="cl">If score &gt;= 90 Then
</span></span><span class="line"><span class="cl">    MsgBox &#34;ä¼˜ç§€&#34;
</span></span><span class="line"><span class="cl">ElseIf score &gt;= 80 Then
</span></span><span class="line"><span class="cl">    MsgBox &#34;è‰¯å¥½&#34;
</span></span><span class="line"><span class="cl">Else
</span></span><span class="line"><span class="cl">    MsgBox &#34;ä¸åŠæ ¼&#34;
</span></span><span class="line"><span class="cl">End If
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">&#39; Select Case
</span></span><span class="line"><span class="cl">Select Case dayOfWeek
</span></span><span class="line"><span class="cl">    Case 1: MsgBox &#34;æ˜ŸæœŸæ—¥&#34;
</span></span><span class="line"><span class="cl">    Case 2: MsgBox &#34;æ˜ŸæœŸä¸€&#34;
</span></span><span class="line"><span class="cl">    &#39; å…¶ä»–æƒ…å†µ...
</span></span><span class="line"><span class="cl">    Case Else: MsgBox &#34;æ— æ•ˆ&#34;
</span></span><span class="line"><span class="cl">End Select
</span></span></code></pre></div><h4 id="å¾ªç¯ç»“æ„">å¾ªç¯ç»“æ„
</h4><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&#39; For...Nextå¾ªç¯
</span></span><span class="line"><span class="cl">For i = 1 To 10
</span></span><span class="line"><span class="cl">    Cells(i, 1).Value = i  &#39; å‘Aåˆ—å†™å…¥1-10
</span></span><span class="line"><span class="cl">Next i
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">&#39; For Each...Nextéå†å¯¹è±¡
</span></span><span class="line"><span class="cl">For Each cell In Range(&#34;A1:A10&#34;)
</span></span><span class="line"><span class="cl">    If cell.Value &gt; 5 Then cell.Interior.Color = RGB(255, 0, 0)
</span></span><span class="line"><span class="cl">Next cell
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">&#39; Do...Loopå¾ªç¯
</span></span><span class="line"><span class="cl">Do While i &lt;= 10
</span></span><span class="line"><span class="cl">    i = i + 1
</span></span><span class="line"><span class="cl">Loop
</span></span></code></pre></div><h2 id="excelå¯¹è±¡æ¨¡å‹æ“ä½œ">Excelå¯¹è±¡æ¨¡å‹æ“ä½œ
</h2><h3 id="å•å…ƒæ ¼ä¸èŒƒå›´æ“ä½œ">å•å…ƒæ ¼ä¸èŒƒå›´æ“ä½œ
</h3><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&#39; è¯»å–å•å…ƒæ ¼å€¼
</span></span><span class="line"><span class="cl">value = Range(&#34;A1&#34;).Value
</span></span><span class="line"><span class="cl">value = Cells(1, 1).Value &#39; è¡Œå·1ï¼Œåˆ—å·1
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">&#39; å†™å…¥å•å…ƒæ ¼å€¼
</span></span><span class="line"><span class="cl">Range(&#34;B1&#34;).Value = &#34;Hello&#34;
</span></span><span class="line"><span class="cl">Cells(2, 2).Value = 100
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">&#39; é€‰æ‹©èŒƒå›´
</span></span><span class="line"><span class="cl">Range(&#34;A1:C10&#34;).Select
</span></span><span class="line"><span class="cl">Range(&#34;A1&#34;).Resize(5, 3).Select &#39; é€‰æ‹©A1åˆ°C5
</span></span></code></pre></div><h3 id="å·¥ä½œè¡¨ä¸å·¥ä½œç°¿">å·¥ä½œè¡¨ä¸å·¥ä½œç°¿
</h3><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&#39; æ·»åŠ æ–°å·¥ä½œè¡¨
</span></span><span class="line"><span class="cl">Sheets.Add.Name = &#34;æ•°æ®æ±‡æ€»&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">&#39; åˆ é™¤å·¥ä½œè¡¨
</span></span><span class="line"><span class="cl">Application.DisplayAlerts = False &#39; å…³é—­æç¤º
</span></span><span class="line"><span class="cl">Sheets(&#34;Sheet1&#34;).Delete
</span></span><span class="line"><span class="cl">Application.DisplayAlerts = True
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">&#39; ä¿å­˜å·¥ä½œç°¿
</span></span><span class="line"><span class="cl">ActiveWorkbook.Save
</span></span><span class="line"><span class="cl">ActiveWorkbook.SaveAs &#34;C:\è·¯å¾„\æ–‡ä»¶å.xlsx&#34;
</span></span></code></pre></div><h2 id="å®ç”¨è„šæœ¬ç¤ºä¾‹">å®ç”¨è„šæœ¬ç¤ºä¾‹
</h2><h3 id="æ•°æ®æ¸…æ´—ä¸æ ¼å¼åŒ–">æ•°æ®æ¸…æ´—ä¸æ ¼å¼åŒ–
</h3><h4 id="åˆ é™¤é‡å¤å€¼">åˆ é™¤é‡å¤å€¼
</h4><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Sub RemoveDuplicates()
</span></span><span class="line"><span class="cl">    Dim lastRow As Long
</span></span><span class="line"><span class="cl">    lastRow = Cells(Rows.Count, 1).End(xlUp).Row &#39; è·å–Aåˆ—æœ€åä¸€è¡Œ
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    Range(&#34;A1:A&#34; &amp; lastRow).RemoveDuplicates Columns:=1, Header:=xlYes
</span></span><span class="line"><span class="cl">    MsgBox &#34;é‡å¤å€¼å·²åˆ é™¤ï¼&#34;
</span></span><span class="line"><span class="cl">End Sub
</span></span></code></pre></div><h4 id="412-æ‰¹é‡æ·»åŠ å‰ç¼€">4.1.2 æ‰¹é‡æ·»åŠ å‰ç¼€
</h4><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Sub AddPrefix()
</span></span><span class="line"><span class="cl">    Dim cell As Range
</span></span><span class="line"><span class="cl">    For Each cell In Range(&#34;A1:A100&#34;)
</span></span><span class="line"><span class="cl">        If cell.Value &lt;&gt; &#34;&#34; Then
</span></span><span class="line"><span class="cl">            cell.Value = &#34;ID-&#34; &amp; cell.Value
</span></span><span class="line"><span class="cl">        End If
</span></span><span class="line"><span class="cl">    Next cell
</span></span><span class="line"><span class="cl">End Sub
</span></span></code></pre></div><h3 id="è‡ªåŠ¨åŒ–æŠ¥è¡¨ç”Ÿæˆ">è‡ªåŠ¨åŒ–æŠ¥è¡¨ç”Ÿæˆ
</h3><h4 id="ç”Ÿæˆæ•°æ®é€è§†è¡¨">ç”Ÿæˆæ•°æ®é€è§†è¡¨
</h4><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Sub CreatePivotTable()
</span></span><span class="line"><span class="cl">    Dim wsData As Worksheet
</span></span><span class="line"><span class="cl">    Dim wsPivot As Worksheet
</span></span><span class="line"><span class="cl">    Dim lastRow As Long
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    Set wsData = ThisWorkbook.Sheets(&#34;æ•°æ®æº&#34;)
</span></span><span class="line"><span class="cl">    Set wsPivot = ThisWorkbook.Sheets.Add
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    lastRow = wsData.Cells(wsData.Rows.Count, 1).End(xlUp).Row
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; åˆ›å»ºæ•°æ®é€è§†è¡¨
</span></span><span class="line"><span class="cl">    wsData.Range(&#34;A1:C&#34; &amp; lastRow).PivotTable _
</span></span><span class="line"><span class="cl">        TableDestination:=wsPivot.Range(&#34;A1&#34;), _
</span></span><span class="line"><span class="cl">        TableName:=&#34;é”€å”®æ•°æ®é€è§†è¡¨&#34;
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; æ·»åŠ å­—æ®µ
</span></span><span class="line"><span class="cl">    With wsPivot.PivotTables(&#34;é”€å”®æ•°æ®é€è§†è¡¨&#34;)
</span></span><span class="line"><span class="cl">        .AddDataField .PivotFields(&#34;é”€å”®é¢&#34;), &#34;æ±‡æ€»é”€å”®é¢&#34;, xlSum
</span></span><span class="line"><span class="cl">        .PivotFields(&#34;äº§å“åç§°&#34;).Orientation = xlRowField
</span></span><span class="line"><span class="cl">    End With
</span></span><span class="line"><span class="cl">End Sub
</span></span></code></pre></div><h3 id="é‚®ä»¶è‡ªåŠ¨åŒ–">é‚®ä»¶è‡ªåŠ¨åŒ–
</h3><h4 id="å‘é€å¸¦é™„ä»¶çš„é‚®ä»¶">å‘é€å¸¦é™„ä»¶çš„é‚®ä»¶
</h4><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Sub SendEmailWithAttachment()
</span></span><span class="line"><span class="cl">    Dim olApp As Object
</span></span><span class="line"><span class="cl">    Dim olMail As Object
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    Set olApp = CreateObject(&#34;Outlook.Application&#34;)
</span></span><span class="line"><span class="cl">    Set olMail = olApp.CreateItem(0) &#39; 0ä»£è¡¨é‚®ä»¶
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    With olMail
</span></span><span class="line"><span class="cl">        .To = &#34;recipient@example.com&#34;
</span></span><span class="line"><span class="cl">        .CC = &#34;cc@example.com&#34;
</span></span><span class="line"><span class="cl">        .Subject = &#34;æœˆåº¦æŠ¥å‘Š&#34;
</span></span><span class="line"><span class="cl">        .Body = &#34;é™„ä»¶ä¸ºæœ€æ–°æœˆåº¦æŠ¥å‘Šï¼Œè¯·æŸ¥æ”¶ã€‚&#34;
</span></span><span class="line"><span class="cl">        .Attachments.Add ThisWorkbook.FullName &#39; æ·»åŠ å½“å‰å·¥ä½œç°¿ä½œä¸ºé™„ä»¶
</span></span><span class="line"><span class="cl">        .Send &#39; å‘é€é‚®ä»¶ï¼ˆæˆ–ä½¿ç”¨.Displayæ˜¾ç¤ºï¼‰
</span></span><span class="line"><span class="cl">    End With
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    Set olMail = Nothing
</span></span><span class="line"><span class="cl">    Set olApp = Nothing
</span></span><span class="line"><span class="cl">End Sub
</span></span></code></pre></div><h2 id="é«˜çº§æŠ€å·§ä¸æœ€ä½³å®è·µ">é«˜çº§æŠ€å·§ä¸æœ€ä½³å®è·µ
</h2><h3 id="é”™è¯¯å¤„ç†">é”™è¯¯å¤„ç†
</h3><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Sub ErrorHandlingDemo()
</span></span><span class="line"><span class="cl">    On Error GoTo ErrorHandler
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    Dim filePath As String
</span></span><span class="line"><span class="cl">    filePath = &#34;C:\ä¸å­˜åœ¨çš„æ–‡ä»¶.txt&#34;
</span></span><span class="line"><span class="cl">    Open filePath For Input As #1
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    Exit Sub
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">ErrorHandler:
</span></span><span class="line"><span class="cl">    MsgBox &#34;é”™è¯¯ï¼š&#34; &amp; Err.Number &amp; &#34; - &#34; &amp; Err.Description
</span></span><span class="line"><span class="cl">    Resume Next &#39; ç»§ç»­æ‰§è¡Œåç»­ä»£ç 
</span></span><span class="line"><span class="cl">End Sub
</span></span></code></pre></div><h3 id="è‡ªå®šä¹‰å‡½æ•°">è‡ªå®šä¹‰å‡½æ•°
</h3><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&#39; è®¡ç®—BMIæŒ‡æ•°
</span></span><span class="line"><span class="cl">Function CalculateBMI(weight As Double, height As Double) As Double
</span></span><span class="line"><span class="cl">    CalculateBMI = weight / (height ^ 2)
</span></span><span class="line"><span class="cl">End Function
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">&#39; åœ¨Excelå•å…ƒæ ¼ä¸­ä½¿ç”¨ï¼š=CalculateBMI(B1, C1)
</span></span></code></pre></div><h3 id="äº‹ä»¶ç¼–ç¨‹">äº‹ä»¶ç¼–ç¨‹
</h3><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&#39; å½“å•å…ƒæ ¼å†…å®¹å˜åŒ–æ—¶è§¦å‘
</span></span><span class="line"><span class="cl">Private Sub Worksheet_Change(ByVal Target As Range)
</span></span><span class="line"><span class="cl">    If Not Intersect(Target, Range(&#34;A1&#34;)) Is Nothing Then
</span></span><span class="line"><span class="cl">        MsgBox &#34;A1å•å…ƒæ ¼å†…å®¹å·²æ›´æ–°ï¼&#34;
</span></span><span class="line"><span class="cl">    End If
</span></span><span class="line"><span class="cl">End Sub
</span></span></code></pre></div><h2 id="å›¾è¡¨ç»˜åˆ¶æ“ä½œ">å›¾è¡¨ç»˜åˆ¶æ“ä½œ
</h2><h3 id="åŸºæœ¬å›¾è¡¨åˆ›å»º">åŸºæœ¬å›¾è¡¨åˆ›å»º
</h3><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Sub CreateBasicChart()
</span></span><span class="line"><span class="cl">    Dim ws As Worksheet
</span></span><span class="line"><span class="cl">    Dim chartObj As ChartObject
</span></span><span class="line"><span class="cl">    Dim dataRange As Range
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; è®¾ç½®å·¥ä½œè¡¨
</span></span><span class="line"><span class="cl">    Set ws = ThisWorkbook.Sheets(&#34;æ•°æ®&#34;)
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; å®šä¹‰æ•°æ®èŒƒå›´
</span></span><span class="line"><span class="cl">    Set dataRange = ws.Range(&#34;A1:C10&#34;) &#39; å‡è®¾Aåˆ—ä¸ºç±»åˆ«ï¼ŒBã€Cåˆ—ä¸ºæ•°æ®
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; åˆ›å»ºå›¾è¡¨
</span></span><span class="line"><span class="cl">    Set chartObj = ws.ChartObjects.Add( _
</span></span><span class="line"><span class="cl">        Left:=100, Top:=50, Width:=500, Height:=300)
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; è®¾ç½®å›¾è¡¨æ•°æ®å’Œç±»å‹
</span></span><span class="line"><span class="cl">    With chartObj.Chart
</span></span><span class="line"><span class="cl">        .SetSourceData Source:=dataRange
</span></span><span class="line"><span class="cl">        .ChartType = xlColumnClustered &#39; æŸ±çŠ¶å›¾
</span></span><span class="line"><span class="cl">        .HasTitle = True
</span></span><span class="line"><span class="cl">        .ChartTitle.Text = &#34;é”€å”®æ•°æ®å¯¹æ¯”&#34;
</span></span><span class="line"><span class="cl">    End With
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    MsgBox &#34;å›¾è¡¨åˆ›å»ºå®Œæˆï¼&#34;
</span></span><span class="line"><span class="cl">End Sub
</span></span></code></pre></div><h3 id="ä¸åŒç±»å‹å›¾è¡¨ç¤ºä¾‹">ä¸åŒç±»å‹å›¾è¡¨ç¤ºä¾‹
</h3><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Sub CreateVariousCharts()
</span></span><span class="line"><span class="cl">    Dim ws As Worksheet
</span></span><span class="line"><span class="cl">    Dim lastRow As Long
</span></span><span class="line"><span class="cl">    Set ws = ThisWorkbook.ActiveSheet
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; è·å–æ•°æ®æœ€åä¸€è¡Œ
</span></span><span class="line"><span class="cl">    lastRow = ws.Cells(ws.Rows.Count, &#34;A&#34;).End(xlUp).Row
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; åˆ›å»ºæŠ˜çº¿å›¾
</span></span><span class="line"><span class="cl">    ws.ChartObjects.Add(Left:=10, Top:=10, Width:=300, Height:=200).Chart _
</span></span><span class="line"><span class="cl">        .SetSourceData Source:=ws.Range(&#34;A1:B&#34; &amp; lastRow)
</span></span><span class="line"><span class="cl">    ws.ChartObjects(1).Chart.ChartType = xlLine
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; åˆ›å»ºé¥¼å›¾
</span></span><span class="line"><span class="cl">    ws.ChartObjects.Add(Left:=320, Top:=10, Width:=300, Height:=200).Chart _
</span></span><span class="line"><span class="cl">        .SetSourceData Source:=ws.Range(&#34;A1:C&#34; &amp; lastRow)
</span></span><span class="line"><span class="cl">    ws.ChartObjects(2).Chart.ChartType = xlPie
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; åˆ›å»ºæ•£ç‚¹å›¾
</span></span><span class="line"><span class="cl">    ws.ChartObjects.Add(Left:=10, Top:=220, Width:=300, Height:=200).Chart _
</span></span><span class="line"><span class="cl">        .SetSourceData Source:=ws.Range(&#34;A1:D&#34; &amp; lastRow)
</span></span><span class="line"><span class="cl">    ws.ChartObjects(3).Chart.ChartType = xlXYScatter
</span></span><span class="line"><span class="cl">End Sub
</span></span></code></pre></div><h3 id="å›¾è¡¨æ ·å¼ç¾åŒ–">å›¾è¡¨æ ·å¼ç¾åŒ–
</h3><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Sub FormatChart()
</span></span><span class="line"><span class="cl">    Dim cht As Chart
</span></span><span class="line"><span class="cl">    Set cht = ThisWorkbook.Sheets(&#34;æ•°æ®&#34;).ChartObjects(1).Chart
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; è®¾ç½®å›¾è¡¨æ ‡é¢˜
</span></span><span class="line"><span class="cl">    With cht.ChartTitle
</span></span><span class="line"><span class="cl">        .Text = &#34;2023å¹´æœˆåº¦é”€å”®è¶‹åŠ¿&#34;
</span></span><span class="line"><span class="cl">        .Font.Size = 14
</span></span><span class="line"><span class="cl">        .Font.Bold = True
</span></span><span class="line"><span class="cl">    End With
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; è®¾ç½®åæ ‡è½´
</span></span><span class="line"><span class="cl">    With cht.Axes(xlCategory) &#39; Xè½´
</span></span><span class="line"><span class="cl">        .HasTitle = True
</span></span><span class="line"><span class="cl">        .AxisTitle.Text = &#34;æœˆä»½&#34;
</span></span><span class="line"><span class="cl">        .AxisTitle.Font.Italic = True
</span></span><span class="line"><span class="cl">    End With
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    With cht.Axes(xlValue) &#39; Yè½´
</span></span><span class="line"><span class="cl">        .HasTitle = True
</span></span><span class="line"><span class="cl">        .AxisTitle.Text = &#34;é”€å”®é¢(å…ƒ)&#34;
</span></span><span class="line"><span class="cl">        .MinimumScale = 0 &#39; è®¾ç½®æœ€å°å€¼ä¸º0
</span></span><span class="line"><span class="cl">    End With
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; è®¾ç½®å›¾ä¾‹
</span></span><span class="line"><span class="cl">    With cht.Legend
</span></span><span class="line"><span class="cl">        .Position = xlBottom &#39; å›¾ä¾‹åœ¨åº•éƒ¨
</span></span><span class="line"><span class="cl">        .Font.Size = 10
</span></span><span class="line"><span class="cl">    End With
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; è®¾ç½®æ•°æ®ç³»åˆ—æ ¼å¼
</span></span><span class="line"><span class="cl">    With cht.SeriesCollection(1)
</span></span><span class="line"><span class="cl">        .Name = &#34;å®é™…é”€å”®é¢&#34;
</span></span><span class="line"><span class="cl">        .Format.Fill.ForeColor.RGB = RGB(50, 120, 200) &#39; è“è‰²
</span></span><span class="line"><span class="cl">        .MarkerStyle = xlMarkerStyleCircle &#39; æ•°æ®ç‚¹æ ·å¼
</span></span><span class="line"><span class="cl">    End With
</span></span><span class="line"><span class="cl">End Sub
</span></span></code></pre></div><h2 id="è‡ªåŠ¨ç­›é€‰åŠŸèƒ½">è‡ªåŠ¨ç­›é€‰åŠŸèƒ½
</h2><h3 id="åŸºæœ¬è‡ªåŠ¨ç­›é€‰">åŸºæœ¬è‡ªåŠ¨ç­›é€‰
</h3><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Sub BasicAutoFilter()
</span></span><span class="line"><span class="cl">    Dim ws As Worksheet
</span></span><span class="line"><span class="cl">    Set ws = ThisWorkbook.Sheets(&#34;å®¢æˆ·æ•°æ®&#34;)
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; ç¡®ä¿ç­›é€‰è¢«å…³é—­
</span></span><span class="line"><span class="cl">    If ws.AutoFilterMode Then ws.AutoFilterMode = False
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; åº”ç”¨ç­›é€‰
</span></span><span class="line"><span class="cl">    ws.Range(&#34;A1:D1&#34;).AutoFilter &#39; A1:D1ä¸ºæ ‡é¢˜è¡Œ
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; ç­›é€‰å‡º&#34;åä¸œåœ°åŒº&#34;çš„å®¢æˆ·
</span></span><span class="line"><span class="cl">    ws.Range(&#34;A1:D1&#34;).AutoFilter Field:=3, Criteria1:=&#34;åä¸œåœ°åŒº&#34; &#39; ç¬¬3åˆ—æ˜¯åœ°åŒº
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; ç­›é€‰å‡ºé”€å”®é¢å¤§äº10000çš„è®°å½•
</span></span><span class="line"><span class="cl">    &#39; ws.Range(&#34;A1:D1&#34;).AutoFilter Field:=4, Criteria1:=&#34;&gt;10000&#34;
</span></span><span class="line"><span class="cl">End Sub
</span></span></code></pre></div><h3 id="å¤šæ¡ä»¶ç­›é€‰">å¤šæ¡ä»¶ç­›é€‰
</h3><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Sub AdvancedFilter()
</span></span><span class="line"><span class="cl">    Dim ws As Worksheet
</span></span><span class="line"><span class="cl">    Set ws = ThisWorkbook.Sheets(&#34;é”€å”®æ•°æ®&#34;)
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; å…³é—­ç°æœ‰ç­›é€‰
</span></span><span class="line"><span class="cl">    If ws.AutoFilterMode Then ws.AutoFilterMode = False
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; å¤šæ¡ä»¶ç­›é€‰ï¼šåœ°åŒºä¸º&#34;åå—&#34;ä¸”é”€å”®é¢&gt;5000
</span></span><span class="line"><span class="cl">    With ws.Range(&#34;A1:D1000&#34;)
</span></span><span class="line"><span class="cl">        .AutoFilter
</span></span><span class="line"><span class="cl">        .AutoFilter Field:=3, Criteria1:=&#34;åå—&#34; &#39; ç¬¬3åˆ—ï¼šåœ°åŒº
</span></span><span class="line"><span class="cl">        .AutoFilter Field:=4, Criteria1:=&#34;&gt;5000&#34; &#39; ç¬¬4åˆ—ï¼šé”€å”®é¢
</span></span><span class="line"><span class="cl">    End With
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; ç»Ÿè®¡ç­›é€‰ç»“æœæ•°é‡
</span></span><span class="line"><span class="cl">    Dim visibleCount As Long
</span></span><span class="line"><span class="cl">    visibleCount = ws.Range(&#34;A2:A1000&#34;).SpecialCells(xlCellTypeVisible).Count
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    MsgBox &#34;ç¬¦åˆæ¡ä»¶çš„è®°å½•æœ‰ &#34; &amp; visibleCount &amp; &#34; æ¡&#34;
</span></span><span class="line"><span class="cl">End Sub
</span></span></code></pre></div><h3 id="é«˜çº§ç­›é€‰ä½¿ç”¨æ¡ä»¶åŒºåŸŸ">é«˜çº§ç­›é€‰ï¼ˆä½¿ç”¨æ¡ä»¶åŒºåŸŸï¼‰
</h3><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Sub AdvancedFilterWithCriteria()
</span></span><span class="line"><span class="cl">    Dim wsData As Worksheet
</span></span><span class="line"><span class="cl">    Dim wsCriteria As Worksheet
</span></span><span class="line"><span class="cl">    Dim wsResult As Worksheet
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; è®¾ç½®å·¥ä½œè¡¨
</span></span><span class="line"><span class="cl">    Set wsData = ThisWorkbook.Sheets(&#34;æ•°æ®&#34;)
</span></span><span class="line"><span class="cl">    Set wsCriteria = ThisWorkbook.Sheets(&#34;æ¡ä»¶&#34;)
</span></span><span class="line"><span class="cl">    Set wsResult = ThisWorkbook.Sheets(&#34;ç»“æœ&#34;)
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; æ¸…é™¤ä¹‹å‰çš„ç»“æœ
</span></span><span class="line"><span class="cl">    wsResult.Range(&#34;A2:D1000&#34;).ClearContents
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; åº”ç”¨é«˜çº§ç­›é€‰
</span></span><span class="line"><span class="cl">    wsData.Range(&#34;A1:D1000&#34;).AdvancedFilter _
</span></span><span class="line"><span class="cl">        Action:=xlFilterCopy, _
</span></span><span class="line"><span class="cl">        CriteriaRange:=wsCriteria.Range(&#34;A1:D2&#34;), _
</span></span><span class="line"><span class="cl">        CopyToRange:=wsResult.Range(&#34;A1:D1&#34;), _
</span></span><span class="line"><span class="cl">        Unique:=False
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">    MsgBox &#34;é«˜çº§ç­›é€‰å®Œæˆï¼Œç»“æœå·²å¤åˆ¶åˆ°ç»“æœè¡¨&#34;
</span></span><span class="line"><span class="cl">End Sub
</span></span></code></pre></div><h3 id="å–æ¶ˆç­›é€‰ä¸æ¢å¤æ•°æ®">å–æ¶ˆç­›é€‰ä¸æ¢å¤æ•°æ®
</h3><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Sub RemoveFilter()
</span></span><span class="line"><span class="cl">    Dim ws As Worksheet
</span></span><span class="line"><span class="cl">    Set ws = ThisWorkbook.ActiveSheet
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; æ£€æŸ¥æ˜¯å¦æœ‰ç­›é€‰
</span></span><span class="line"><span class="cl">    If ws.AutoFilterMode Then
</span></span><span class="line"><span class="cl">        &#39; å…³é—­ç­›é€‰
</span></span><span class="line"><span class="cl">        ws.AutoFilterMode = False
</span></span><span class="line"><span class="cl">        MsgBox &#34;ç­›é€‰å·²å–æ¶ˆ&#34;
</span></span><span class="line"><span class="cl">    Else
</span></span><span class="line"><span class="cl">        MsgBox &#34;å½“å‰æ²¡æœ‰åº”ç”¨ç­›é€‰&#34;
</span></span><span class="line"><span class="cl">    End If
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; é€‰ä¸­æ•°æ®åŒºåŸŸç¬¬ä¸€è¡Œ
</span></span><span class="line"><span class="cl">    ws.Range(&#34;A1&#34;).Select
</span></span><span class="line"><span class="cl">End Sub
</span></span></code></pre></div><h2 id="withè¯­å¥çš„ä½¿ç”¨">Withè¯­å¥çš„ä½¿ç”¨
</h2><p>Withè¯­å¥æ˜¯VBAä¸­æé«˜ä»£ç æ•ˆç‡å’Œå¯è¯»æ€§çš„é‡è¦å·¥å…·ï¼Œç‰¹åˆ«é€‚åˆå¯¹åŒä¸€å¯¹è±¡è¿›è¡Œå¤šé¡¹æ“ä½œã€‚</p>
<h3 id="withè¯­å¥åŸºç¡€ç”¨æ³•">Withè¯­å¥åŸºç¡€ç”¨æ³•
</h3><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Sub WithStatementBasic()
</span></span><span class="line"><span class="cl">    &#39; ä¸ä½¿ç”¨Withè¯­å¥
</span></span><span class="line"><span class="cl">    Range(&#34;A1&#34;).Value = &#34;å§“å&#34;
</span></span><span class="line"><span class="cl">    Range(&#34;A1&#34;).Font.Bold = True
</span></span><span class="line"><span class="cl">    Range(&#34;A1&#34;).Font.Size = 12
</span></span><span class="line"><span class="cl">    Range(&#34;A1&#34;).Interior.Color = RGB(200, 200, 200)
</span></span><span class="line"><span class="cl">    Range(&#34;A1&#34;).HorizontalAlignment = xlCenter
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; ä½¿ç”¨Withè¯­å¥ï¼Œæ›´ç®€æ´é«˜æ•ˆ
</span></span><span class="line"><span class="cl">    With Range(&#34;B1&#34;)
</span></span><span class="line"><span class="cl">        .Value = &#34;å¹´é¾„&#34;
</span></span><span class="line"><span class="cl">        .Font.Bold = True
</span></span><span class="line"><span class="cl">        .Font.Size = 12
</span></span><span class="line"><span class="cl">        .Interior.Color = RGB(200, 200, 200)
</span></span><span class="line"><span class="cl">        .HorizontalAlignment = xlCenter
</span></span><span class="line"><span class="cl">    End With
</span></span><span class="line"><span class="cl">End Sub
</span></span></code></pre></div><h3 id="withè¯­å¥åœ¨å¯¹è±¡æ“ä½œä¸­çš„åº”ç”¨">Withè¯­å¥åœ¨å¯¹è±¡æ“ä½œä¸­çš„åº”ç”¨
</h3><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Sub WithStatementForObjects()
</span></span><span class="line"><span class="cl">    Dim ws As Worksheet
</span></span><span class="line"><span class="cl">    Set ws = ThisWorkbook.Sheets.Add
</span></span><span class="line"><span class="cl">    ws.Name = &#34;Withç¤ºä¾‹&#34;
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; ä½¿ç”¨Withé…ç½®å·¥ä½œè¡¨
</span></span><span class="line"><span class="cl">    With ws
</span></span><span class="line"><span class="cl">        &#39; è®¾ç½®æ ‡é¢˜
</span></span><span class="line"><span class="cl">        With .Range(&#34;A1:C1&#34;)
</span></span><span class="line"><span class="cl">            .Value = Array(&#34;ID&#34;, &#34;åç§°&#34;, &#34;æ•°é‡&#34;)
</span></span><span class="line"><span class="cl">            .Font.Bold = True
</span></span><span class="line"><span class="cl">            .Interior.Color = RGB(180, 200, 255)
</span></span><span class="line"><span class="cl">            .EntireColumn.AutoFit
</span></span><span class="line"><span class="cl">        End With
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        &#39; å¡«å……ç¤ºä¾‹æ•°æ®
</span></span><span class="line"><span class="cl">        .Range(&#34;A2&#34;).Value = 1
</span></span><span class="line"><span class="cl">        .Range(&#34;B2&#34;).Value = &#34;äº§å“A&#34;
</span></span><span class="line"><span class="cl">        .Range(&#34;C2&#34;).Value = 100
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        .Range(&#34;A3&#34;).Value = 2
</span></span><span class="line"><span class="cl">        .Range(&#34;B3&#34;).Value = &#34;äº§å“B&#34;
</span></span><span class="line"><span class="cl">        .Range(&#34;C3&#34;).Value = 200
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        &#39; æ·»åŠ è¾¹æ¡†
</span></span><span class="line"><span class="cl">        .Range(&#34;A1:C3&#34;).Borders.LineStyle = xlContinuous
</span></span><span class="line"><span class="cl">    End With
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    MsgBox &#34;å·¥ä½œè¡¨åˆ›å»ºå®Œæˆ&#34;
</span></span><span class="line"><span class="cl">End Sub
</span></span></code></pre></div><h3 id="åµŒå¥—withè¯­å¥">åµŒå¥—Withè¯­å¥
</h3><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Sub NestedWithStatements()
</span></span><span class="line"><span class="cl">    Dim ws As Worksheet
</span></span><span class="line"><span class="cl">    Set ws = ThisWorkbook.ActiveSheet
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; åµŒå¥—Withè¯­å¥ç¤ºä¾‹
</span></span><span class="line"><span class="cl">    With ws.ChartObjects.Add(Left:=100, Top:=50, Width:=500, Height:=300).Chart
</span></span><span class="line"><span class="cl">        .ChartType = xlColumnClustered
</span></span><span class="line"><span class="cl">        .SetSourceData Source:=ws.Range(&#34;A1:C6&#34;)
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        &#39; åµŒå¥—Withè®¾ç½®æ ‡é¢˜
</span></span><span class="line"><span class="cl">        With .ChartTitle
</span></span><span class="line"><span class="cl">            .Text = &#34;å­£åº¦é”€å”®æŠ¥è¡¨&#34;
</span></span><span class="line"><span class="cl">            .Font.Size = 16
</span></span><span class="line"><span class="cl">            .Font.Bold = True
</span></span><span class="line"><span class="cl">        End With
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        &#39; åµŒå¥—Withè®¾ç½®Xè½´
</span></span><span class="line"><span class="cl">        With .Axes(xlCategory)
</span></span><span class="line"><span class="cl">            .HasTitle = True
</span></span><span class="line"><span class="cl">            .AxisTitle.Text = &#34;å­£åº¦&#34;
</span></span><span class="line"><span class="cl">        End With
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        &#39; åµŒå¥—Withè®¾ç½®Yè½´
</span></span><span class="line"><span class="cl">        With .Axes(xlValue)
</span></span><span class="line"><span class="cl">            .HasTitle = True
</span></span><span class="line"><span class="cl">            .AxisTitle.Text = &#34;é”€å”®é¢&#34;
</span></span><span class="line"><span class="cl">            .MinimumScale = 0
</span></span><span class="line"><span class="cl">        End With
</span></span><span class="line"><span class="cl">    End With
</span></span><span class="line"><span class="cl">End Sub
</span></span></code></pre></div><h3 id="withè¯­å¥çš„ä¼˜åŠ¿æ€»ç»“">Withè¯­å¥çš„ä¼˜åŠ¿æ€»ç»“
</h3><ol>
<li>å‡å°‘ä»£ç é‡ï¼Œä½¿ä»£ç æ›´ç®€æ´</li>
<li>æé«˜æ‰§è¡Œæ•ˆç‡ï¼Œå¯¹è±¡åªéœ€å¼•ç”¨ä¸€æ¬¡</li>
<li>å¢å¼ºä»£ç å¯è¯»æ€§ï¼Œæ˜ç¡®æ“ä½œå¯¹è±¡</li>
<li>å‡å°‘è¾“å…¥é”™è¯¯ï¼Œç‰¹åˆ«æ˜¯é•¿å¯¹è±¡åç§°</li>
</ol>
<h2 id="userformç”¨æˆ·çª—ä½“">UserFormï¼ˆç”¨æˆ·çª—ä½“ï¼‰
</h2><p>UserFormæ˜¯VBAä¸­åˆ›å»ºè‡ªå®šä¹‰ç•Œé¢çš„å¼ºå¤§å·¥å…·ï¼Œå¯ç”¨äºæ•°æ®å½•å…¥ã€å‚æ•°è®¾ç½®ç­‰äº¤äº’æ“ä½œã€‚</p>
<h3 id="åˆ›å»ºuserformçš„æ­¥éª¤">åˆ›å»ºUserFormçš„æ­¥éª¤
</h3><ol>
<li>æ‰“å¼€VBAç¼–è¾‘å™¨ï¼ˆAlt+F11ï¼‰</li>
<li>æ’å…¥UserFormï¼šæ’å…¥ &gt; ç”¨æˆ·çª—ä½“</li>
<li>åœ¨å·¥å…·ç®±ä¸­é€‰æ‹©æ§ä»¶æ·»åŠ åˆ°çª—ä½“</li>
<li>è®¾ç½®æ§ä»¶å±æ€§</li>
<li>ç¼–å†™äº‹ä»¶ä»£ç </li>
</ol>
<h3 id="åŸºæœ¬userformç¤ºä¾‹æ•°æ®å½•å…¥è¡¨å•">åŸºæœ¬UserFormç¤ºä¾‹ï¼šæ•°æ®å½•å…¥è¡¨å•
</h3><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="s1">&#39; ä»¥ä¸‹ä»£ç éœ€è¦åœ¨UserFormçš„ä»£ç çª—å£ä¸­ç¼–å†™</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="s1">&#39; UserFormåˆå§‹åŒ–äº‹ä»¶</span>
</span></span><span class="line"><span class="cl"><span class="n">Private</span> <span class="n">Sub</span> <span class="n">UserForm_Initialize</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39; åˆå§‹åŒ–ä¸‹æ‹‰åˆ—è¡¨</span>
</span></span><span class="line"><span class="cl">    <span class="n">Me</span><span class="o">.</span><span class="n">cboDepartment</span><span class="o">.</span><span class="n">List</span> <span class="o">=</span> <span class="ne">Array</span><span class="p">(</span><span class="s2">&#34;é”€å”®éƒ¨&#34;</span><span class="p">,</span> <span class="s2">&#34;å¸‚åœºéƒ¨&#34;</span><span class="p">,</span> <span class="s2">&#34;æŠ€æœ¯éƒ¨&#34;</span><span class="p">,</span> <span class="s2">&#34;è¡Œæ”¿éƒ¨&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="s1">&#39; è®¾ç½®é»˜è®¤æ—¥æœŸä¸ºä»Šå¤©</span>
</span></span><span class="line"><span class="cl">    <span class="n">Me</span><span class="o">.</span><span class="n">txtDate</span><span class="o">.</span><span class="n">Value</span> <span class="o">=</span> <span class="n">Date</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="s1">&#39; è®¾ç½®æ ‡é¢˜</span>
</span></span><span class="line"><span class="cl">    <span class="n">Me</span><span class="o">.</span><span class="n">Caption</span> <span class="o">=</span> <span class="s2">&#34;å‘˜å·¥ä¿¡æ¯å½•å…¥&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">End</span> <span class="n">Sub</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="s1">&#39; ç¡®å®šæŒ‰é’®ç‚¹å‡»äº‹ä»¶</span>
</span></span><span class="line"><span class="cl"><span class="n">Private</span> <span class="n">Sub</span> <span class="n">cmdOK_Click</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">Dim</span> <span class="n">ws</span> <span class="n">As</span> <span class="n">Worksheet</span>
</span></span><span class="line"><span class="cl">    <span class="n">Dim</span> <span class="n">lastRow</span> <span class="n">As</span> <span class="n">Long</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="s1">&#39; æ•°æ®éªŒè¯</span>
</span></span><span class="line"><span class="cl">    <span class="n">If</span> <span class="n">Me</span><span class="o">.</span><span class="n">txtName</span><span class="o">.</span><span class="n">Value</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span> <span class="n">Then</span>
</span></span><span class="line"><span class="cl">        <span class="n">MsgBox</span> <span class="s2">&#34;è¯·è¾“å…¥å§“å&#34;</span><span class="p">,</span> <span class="n">vbExclamation</span>
</span></span><span class="line"><span class="cl">        <span class="n">Me</span><span class="o">.</span><span class="n">txtName</span><span class="o">.</span><span class="n">SetFocus</span>
</span></span><span class="line"><span class="cl">        <span class="n">Exit</span> <span class="n">Sub</span>
</span></span><span class="line"><span class="cl">    <span class="n">End</span> <span class="n">If</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">If</span> <span class="n">Me</span><span class="o">.</span><span class="n">cboDepartment</span><span class="o">.</span><span class="n">Value</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span> <span class="n">Then</span>
</span></span><span class="line"><span class="cl">        <span class="n">MsgBox</span> <span class="s2">&#34;è¯·é€‰æ‹©éƒ¨é—¨&#34;</span><span class="p">,</span> <span class="n">vbExclamation</span>
</span></span><span class="line"><span class="cl">        <span class="n">Me</span><span class="o">.</span><span class="n">cboDepartment</span><span class="o">.</span><span class="n">SetFocus</span>
</span></span><span class="line"><span class="cl">        <span class="n">Exit</span> <span class="n">Sub</span>
</span></span><span class="line"><span class="cl">    <span class="n">End</span> <span class="n">If</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="s1">&#39; å†™å…¥æ•°æ®</span>
</span></span><span class="line"><span class="cl">    <span class="n">Set</span> <span class="n">ws</span> <span class="o">=</span> <span class="n">ThisWorkbook</span><span class="o">.</span><span class="n">Sheets</span><span class="p">(</span><span class="s2">&#34;å‘˜å·¥ä¿¡æ¯&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">lastRow</span> <span class="o">=</span> <span class="n">ws</span><span class="o">.</span><span class="n">Cells</span><span class="p">(</span><span class="n">ws</span><span class="o">.</span><span class="n">Rows</span><span class="o">.</span><span class="n">Count</span><span class="p">,</span> <span class="s2">&#34;A&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">End</span><span class="p">(</span><span class="n">xlUp</span><span class="p">)</span><span class="o">.</span><span class="n">Row</span> <span class="o">+</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">ws</span><span class="o">.</span><span class="n">Cells</span><span class="p">(</span><span class="n">lastRow</span><span class="p">,</span> <span class="s2">&#34;A&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">Value</span> <span class="o">=</span> <span class="n">Me</span><span class="o">.</span><span class="n">txtID</span><span class="o">.</span><span class="n">Value</span>
</span></span><span class="line"><span class="cl">    <span class="n">ws</span><span class="o">.</span><span class="n">Cells</span><span class="p">(</span><span class="n">lastRow</span><span class="p">,</span> <span class="s2">&#34;B&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">Value</span> <span class="o">=</span> <span class="n">Me</span><span class="o">.</span><span class="n">txtName</span><span class="o">.</span><span class="n">Value</span>
</span></span><span class="line"><span class="cl">    <span class="n">ws</span><span class="o">.</span><span class="n">Cells</span><span class="p">(</span><span class="n">lastRow</span><span class="p">,</span> <span class="s2">&#34;C&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">Value</span> <span class="o">=</span> <span class="n">Me</span><span class="o">.</span><span class="n">cboDepartment</span><span class="o">.</span><span class="n">Value</span>
</span></span><span class="line"><span class="cl">    <span class="n">ws</span><span class="o">.</span><span class="n">Cells</span><span class="p">(</span><span class="n">lastRow</span><span class="p">,</span> <span class="s2">&#34;D&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">Value</span> <span class="o">=</span> <span class="n">Me</span><span class="o">.</span><span class="n">txtDate</span><span class="o">.</span><span class="n">Value</span>
</span></span><span class="line"><span class="cl">    <span class="n">ws</span><span class="o">.</span><span class="n">Cells</span><span class="p">(</span><span class="n">lastRow</span><span class="p">,</span> <span class="s2">&#34;E&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">Value</span> <span class="o">=</span> <span class="n">Me</span><span class="o">.</span><span class="n">txtSalary</span><span class="o">.</span><span class="n">Value</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="s1">&#39; æç¤ºæˆåŠŸ</span>
</span></span><span class="line"><span class="cl">    <span class="n">MsgBox</span> <span class="s2">&#34;æ•°æ®å·²æˆåŠŸä¿å­˜ï¼&#34;</span><span class="p">,</span> <span class="n">vbInformation</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="s1">&#39; æ¸…ç©ºè¡¨å•</span>
</span></span><span class="line"><span class="cl">    <span class="n">Me</span><span class="o">.</span><span class="n">txtID</span><span class="o">.</span><span class="n">Value</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">Me</span><span class="o">.</span><span class="n">txtName</span><span class="o">.</span><span class="n">Value</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">Me</span><span class="o">.</span><span class="n">txtSalary</span><span class="o">.</span><span class="n">Value</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">Me</span><span class="o">.</span><span class="n">txtID</span><span class="o">.</span><span class="n">SetFocus</span>
</span></span><span class="line"><span class="cl"><span class="n">End</span> <span class="n">Sub</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="s1">&#39; å–æ¶ˆæŒ‰é’®ç‚¹å‡»äº‹ä»¶</span>
</span></span><span class="line"><span class="cl"><span class="n">Private</span> <span class="n">Sub</span> <span class="n">cmdCancel_Click</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39; å…³é—­è¡¨å•</span>
</span></span><span class="line"><span class="cl">    <span class="n">Unload</span> <span class="n">Me</span>
</span></span><span class="line"><span class="cl"><span class="n">End</span> <span class="n">Sub</span>
</span></span></code></pre></div><h3 id="æ˜¾ç¤ºuserformçš„ä»£ç ">æ˜¾ç¤ºUserFormçš„ä»£ç 
</h3><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&#39; æ ‡å‡†æ¨¡å—ä¸­çš„ä»£ç ï¼Œç”¨äºæ˜¾ç¤ºç”¨æˆ·çª—ä½“
</span></span><span class="line"><span class="cl">Sub ShowEmployeeForm()
</span></span><span class="line"><span class="cl">    &#39; æ˜¾ç¤ºç”¨æˆ·çª—ä½“
</span></span><span class="line"><span class="cl">    EmployeeForm.Show &#39; EmployeeFormæ˜¯ä½ çš„UserFormåç§°
</span></span><span class="line"><span class="cl">End Sub
</span></span></code></pre></div><h3 id="å¸¸ç”¨æ§ä»¶åŠå±æ€§">å¸¸ç”¨æ§ä»¶åŠå±æ€§
</h3><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Sub ControlPropertiesDemo()
</span></span><span class="line"><span class="cl">    &#39; ä»¥ä¸‹æ˜¯å¸¸ç”¨æ§ä»¶åŠå…¶é‡è¦å±æ€§çš„è¯´æ˜
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; TextBoxï¼ˆæ–‡æœ¬æ¡†ï¼‰
</span></span><span class="line"><span class="cl">    &#39; .Value: æ–‡æœ¬æ¡†ä¸­çš„å†…å®¹
</span></span><span class="line"><span class="cl">    &#39; .Text: å½“å‰æ˜¾ç¤ºçš„æ–‡æœ¬
</span></span><span class="line"><span class="cl">    &#39; .Enabled: æ˜¯å¦å¯ç”¨
</span></span><span class="line"><span class="cl">    &#39; .Visible: æ˜¯å¦å¯è§
</span></span><span class="line"><span class="cl">    &#39; ç¤ºä¾‹:
</span></span><span class="line"><span class="cl">    &#39; Me.txtName.Value = &#34;å¼ ä¸‰&#34;
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; ComboBoxï¼ˆç»„åˆæ¡†ï¼‰
</span></span><span class="line"><span class="cl">    &#39; .List: ä¸‹æ‹‰åˆ—è¡¨å†…å®¹
</span></span><span class="line"><span class="cl">    &#39; .Value: å½“å‰é€‰ä¸­çš„å€¼
</span></span><span class="line"><span class="cl">    &#39; .Style: æ ·å¼ï¼ˆ0=ä¸‹æ‹‰ç»„åˆæ¡†ï¼Œ2=ä¸‹æ‹‰åˆ—è¡¨ï¼‰
</span></span><span class="line"><span class="cl">    &#39; ç¤ºä¾‹:
</span></span><span class="line"><span class="cl">    &#39; Me.cboStatus.List = Array(&#34;åœ¨èŒ&#34;, &#34;ç¦»èŒ&#34;, &#34;ä¼‘å‡&#34;)
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; CheckBoxï¼ˆå¤é€‰æ¡†ï¼‰
</span></span><span class="line"><span class="cl">    &#39; .Value: é€‰ä¸­çŠ¶æ€ï¼ˆTrue/Falseï¼‰
</span></span><span class="line"><span class="cl">    &#39; .Caption: æ˜¾ç¤ºæ–‡æœ¬
</span></span><span class="line"><span class="cl">    &#39; ç¤ºä¾‹:
</span></span><span class="line"><span class="cl">    &#39; If Me.chkAgree.Value = True Then ...
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; OptionButtonï¼ˆé€‰é¡¹æŒ‰é’®ï¼‰
</span></span><span class="line"><span class="cl">    &#39; .Value: æ˜¯å¦é€‰ä¸­ï¼ˆTrue/Falseï¼‰
</span></span><span class="line"><span class="cl">    &#39; .GroupName: åˆ†ç»„åç§°ï¼ˆåŒç»„ä¸­åªèƒ½é€‰ä¸€ä¸ªï¼‰
</span></span><span class="line"><span class="cl">    &#39; ç¤ºä¾‹:
</span></span><span class="line"><span class="cl">    &#39; If Me.optMale.Value = True Then ...
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; CommandButtonï¼ˆå‘½ä»¤æŒ‰é’®ï¼‰
</span></span><span class="line"><span class="cl">    &#39; .Caption: æŒ‰é’®æ–‡æœ¬
</span></span><span class="line"><span class="cl">    &#39; .OnClick: ç‚¹å‡»äº‹ä»¶
</span></span><span class="line"><span class="cl">    &#39; ç¤ºä¾‹:
</span></span><span class="line"><span class="cl">    &#39; Me.cmdSubmit.Caption = &#34;æäº¤&#34;
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; Labelï¼ˆæ ‡ç­¾ï¼‰
</span></span><span class="line"><span class="cl">    &#39; .Caption: æ˜¾ç¤ºæ–‡æœ¬
</span></span><span class="line"><span class="cl">    &#39; .Font: å­—ä½“è®¾ç½®
</span></span><span class="line"><span class="cl">    &#39; ç¤ºä¾‹:
</span></span><span class="line"><span class="cl">    &#39; Me.lblTitle.Caption = &#34;ç”¨æˆ·ä¿¡æ¯&#34;
</span></span><span class="line"><span class="cl">End Sub
</span></span></code></pre></div><h3 id="å®Œæ•´userformç¤ºä¾‹æŸ¥è¯¢å·¥å…·">å®Œæ•´UserFormç¤ºä¾‹ï¼šæŸ¥è¯¢å·¥å…·
</h3><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="s1">&#39; UserFormä»£ç </span>
</span></span><span class="line"><span class="cl"><span class="n">Private</span> <span class="n">Sub</span> <span class="n">cmdSearch_Click</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">Dim</span> <span class="n">ws</span> <span class="n">As</span> <span class="n">Worksheet</span>
</span></span><span class="line"><span class="cl">    <span class="n">Dim</span> <span class="n">lastRow</span> <span class="n">As</span> <span class="n">Long</span>
</span></span><span class="line"><span class="cl">    <span class="n">Dim</span> <span class="n">i</span> <span class="n">As</span> <span class="n">Long</span>
</span></span><span class="line"><span class="cl">    <span class="n">Dim</span> <span class="n">searchTerm</span> <span class="n">As</span> <span class="ne">String</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">Set</span> <span class="n">ws</span> <span class="o">=</span> <span class="n">ThisWorkbook</span><span class="o">.</span><span class="n">Sheets</span><span class="p">(</span><span class="s2">&#34;äº§å“æ•°æ®&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">lastRow</span> <span class="o">=</span> <span class="n">ws</span><span class="o">.</span><span class="n">Cells</span><span class="p">(</span><span class="n">ws</span><span class="o">.</span><span class="n">Rows</span><span class="o">.</span><span class="n">Count</span><span class="p">,</span> <span class="s2">&#34;A&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">End</span><span class="p">(</span><span class="n">xlUp</span><span class="p">)</span><span class="o">.</span><span class="n">Row</span>
</span></span><span class="line"><span class="cl">    <span class="n">searchTerm</span> <span class="o">=</span> <span class="n">Me</span><span class="o">.</span><span class="n">txtSearch</span><span class="o">.</span><span class="n">Value</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="s1">&#39; æ¸…é™¤ä¹‹å‰çš„ç»“æœ</span>
</span></span><span class="line"><span class="cl">    <span class="n">Me</span><span class="o">.</span><span class="n">lstResults</span><span class="o">.</span><span class="n">Clear</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="s1">&#39; æœç´¢æ•°æ®</span>
</span></span><span class="line"><span class="cl">    <span class="n">For</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span> <span class="n">To</span> <span class="n">lastRow</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39; æ£€æŸ¥æ˜¯å¦åŒ¹é…ï¼ˆåç§°æˆ–ç¼–å·ï¼‰</span>
</span></span><span class="line"><span class="cl">        <span class="n">If</span> <span class="n">InStr</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">ws</span><span class="o">.</span><span class="n">Cells</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">Value</span><span class="p">,</span> <span class="n">searchTerm</span><span class="p">,</span> <span class="n">vbTextCompare</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="n">Or</span> <span class="n">_</span>
</span></span><span class="line"><span class="cl">           <span class="n">InStr</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">ws</span><span class="o">.</span><span class="n">Cells</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">Value</span><span class="p">,</span> <span class="n">searchTerm</span><span class="p">,</span> <span class="n">vbTextCompare</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="n">Then</span>
</span></span><span class="line"><span class="cl">           
</span></span><span class="line"><span class="cl">            <span class="s1">&#39; æ·»åŠ åˆ°åˆ—è¡¨æ¡†</span>
</span></span><span class="line"><span class="cl">            <span class="n">Me</span><span class="o">.</span><span class="n">lstResults</span><span class="o">.</span><span class="n">AddItem</span>
</span></span><span class="line"><span class="cl">            <span class="n">Me</span><span class="o">.</span><span class="n">lstResults</span><span class="o">.</span><span class="n">List</span><span class="p">(</span><span class="n">Me</span><span class="o">.</span><span class="n">lstResults</span><span class="o">.</span><span class="n">ListCount</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="n">ws</span><span class="o">.</span><span class="n">Cells</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">Value</span> <span class="s1">&#39; äº§å“ç¼–å·</span>
</span></span><span class="line"><span class="cl">            <span class="n">Me</span><span class="o">.</span><span class="n">lstResults</span><span class="o">.</span><span class="n">List</span><span class="p">(</span><span class="n">Me</span><span class="o">.</span><span class="n">lstResults</span><span class="o">.</span><span class="n">ListCount</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">ws</span><span class="o">.</span><span class="n">Cells</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">Value</span> <span class="s1">&#39; äº§å“åç§°</span>
</span></span><span class="line"><span class="cl">            <span class="n">Me</span><span class="o">.</span><span class="n">lstResults</span><span class="o">.</span><span class="n">List</span><span class="p">(</span><span class="n">Me</span><span class="o">.</span><span class="n">lstResults</span><span class="o">.</span><span class="n">ListCount</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">ws</span><span class="o">.</span><span class="n">Cells</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">Value</span> <span class="s1">&#39; ä»·æ ¼</span>
</span></span><span class="line"><span class="cl">        <span class="n">End</span> <span class="n">If</span>
</span></span><span class="line"><span class="cl">    <span class="n">Next</span> <span class="n">i</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="s1">&#39; æ˜¾ç¤ºç»“æœæ•°é‡</span>
</span></span><span class="line"><span class="cl">    <span class="n">Me</span><span class="o">.</span><span class="n">lblCount</span><span class="o">.</span><span class="n">Caption</span> <span class="o">=</span> <span class="s2">&#34;æ‰¾åˆ° &#34;</span> <span class="o">&amp;</span> <span class="n">Me</span><span class="o">.</span><span class="n">lstResults</span><span class="o">.</span><span class="n">ListCount</span> <span class="o">&amp;</span> <span class="s2">&#34; ä¸ªç»“æœ&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">End</span> <span class="n">Sub</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">Private</span> <span class="n">Sub</span> <span class="n">lstResults_Click</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39; åŒå‡»åˆ—è¡¨é¡¹æ—¶æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯</span>
</span></span><span class="line"><span class="cl">    <span class="n">If</span> <span class="n">Me</span><span class="o">.</span><span class="n">lstResults</span><span class="o">.</span><span class="n">ListIndex</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="n">Then</span>
</span></span><span class="line"><span class="cl">        <span class="n">MsgBox</span> <span class="s2">&#34;äº§å“ç¼–å·: &#34;</span> <span class="o">&amp;</span> <span class="n">Me</span><span class="o">.</span><span class="n">lstResults</span><span class="o">.</span><span class="n">List</span><span class="p">(</span><span class="n">Me</span><span class="o">.</span><span class="n">lstResults</span><span class="o">.</span><span class="n">ListIndex</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">vbCrLf</span> <span class="o">&amp;</span> <span class="n">_</span>
</span></span><span class="line"><span class="cl">               <span class="s2">&#34;äº§å“åç§°: &#34;</span> <span class="o">&amp;</span> <span class="n">Me</span><span class="o">.</span><span class="n">lstResults</span><span class="o">.</span><span class="n">List</span><span class="p">(</span><span class="n">Me</span><span class="o">.</span><span class="n">lstResults</span><span class="o">.</span><span class="n">ListIndex</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">vbCrLf</span> <span class="o">&amp;</span> <span class="n">_</span>
</span></span><span class="line"><span class="cl">               <span class="s2">&#34;ä»·æ ¼: &#34;</span> <span class="o">&amp;</span> <span class="n">Me</span><span class="o">.</span><span class="n">lstResults</span><span class="o">.</span><span class="n">List</span><span class="p">(</span><span class="n">Me</span><span class="o">.</span><span class="n">lstResults</span><span class="o">.</span><span class="n">ListIndex</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">_</span>
</span></span><span class="line"><span class="cl">               <span class="n">vbInformation</span><span class="p">,</span> <span class="s2">&#34;äº§å“è¯¦æƒ…&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">End</span> <span class="n">If</span>
</span></span><span class="line"><span class="cl"><span class="n">End</span> <span class="n">Sub</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">Private</span> <span class="n">Sub</span> <span class="n">cmdClose_Click</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">Unload</span> <span class="n">Me</span>
</span></span><span class="line"><span class="cl"><span class="n">End</span> <span class="n">Sub</span>
</span></span></code></pre></div><h2 id="ç»¼åˆæ¡ˆä¾‹é”€å”®æ•°æ®å¤„ç†ç³»ç»Ÿ">ç»¼åˆæ¡ˆä¾‹ï¼šé”€å”®æ•°æ®å¤„ç†ç³»ç»Ÿ
</h2><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&#39; æ¨¡å—1ï¼šä¸»ç¨‹åº
</span></span><span class="line"><span class="cl">Sub SalesDataSystem()
</span></span><span class="line"><span class="cl">    &#39; æ˜¾ç¤ºç³»ç»Ÿèœå•
</span></span><span class="line"><span class="cl">    Dim choice As Integer
</span></span><span class="line"><span class="cl">    choice = MsgBox(&#34;1. æ•°æ®å½•å…¥&#34; &amp; vbCrLf &amp; _
</span></span><span class="line"><span class="cl">                   &#34;2. æ•°æ®ç­›é€‰&#34; &amp; vbCrLf &amp; _
</span></span><span class="line"><span class="cl">                   &#34;3. ç”ŸæˆæŠ¥è¡¨&#34; &amp; vbCrLf &amp; _
</span></span><span class="line"><span class="cl">                   &#34;4. å›¾è¡¨åˆ†æ&#34; &amp; vbCrLf &amp; _
</span></span><span class="line"><span class="cl">                   &#34;5. é€€å‡º&#34;, _
</span></span><span class="line"><span class="cl">                   vbYesNoCancel + vbQuestion, &#34;é”€å”®æ•°æ®å¤„ç†ç³»ç»Ÿ&#34;)
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    Select Case choice
</span></span><span class="line"><span class="cl">        Case vbYes: DataEntryForm.Show &#39; æ•°æ®å½•å…¥
</span></span><span class="line"><span class="cl">        Case vbNo: RunFilter &#39; æ•°æ®ç­›é€‰
</span></span><span class="line"><span class="cl">        Case vbCancel: GenerateReport &#39; ç”ŸæˆæŠ¥è¡¨
</span></span><span class="line"><span class="cl">        &#39; å…¶ä»–é€‰é¡¹å¯ä»¥åœ¨è¿™é‡Œæ·»åŠ 
</span></span><span class="line"><span class="cl">    End Select
</span></span><span class="line"><span class="cl">End Sub
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">&#39; æ¨¡å—2ï¼šæ•°æ®å¤„ç†
</span></span><span class="line"><span class="cl">Sub RunFilter()
</span></span><span class="line"><span class="cl">    Dim ws As Worksheet
</span></span><span class="line"><span class="cl">    Dim filterMonth As String
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    Set ws = ThisWorkbook.Sheets(&#34;é”€å”®è®°å½•&#34;)
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; å…³é—­ç°æœ‰ç­›é€‰
</span></span><span class="line"><span class="cl">    If ws.AutoFilterMode Then ws.AutoFilterMode = False
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; è·å–ç­›é€‰æ¡ä»¶
</span></span><span class="line"><span class="cl">    filterMonth = InputBox(&#34;è¯·è¾“å…¥è¦ç­›é€‰çš„æœˆä»½(1-12):&#34;, &#34;ç­›é€‰æ¡ä»¶&#34;)
</span></span><span class="line"><span class="cl">    If filterMonth = &#34;&#34; Then Exit Sub
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; åº”ç”¨ç­›é€‰
</span></span><span class="line"><span class="cl">    With ws.Range(&#34;A1:E1&#34;)
</span></span><span class="line"><span class="cl">        .AutoFilter
</span></span><span class="line"><span class="cl">        .AutoFilter Field:=2, Criteria1:=&#34;*&#34; &amp; filterMonth &amp; &#34;æœˆ*&#34; &#39; ç¬¬2åˆ—æ˜¯æ—¥æœŸ
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        &#39; æ£€æŸ¥æ˜¯å¦æœ‰ç¬¦åˆæ¡ä»¶çš„æ•°æ®
</span></span><span class="line"><span class="cl">        On Error Resume Next
</span></span><span class="line"><span class="cl">        Dim filteredCount As Long
</span></span><span class="line"><span class="cl">        filteredCount = ws.Range(&#34;A2:A1000&#34;).SpecialCells(xlCellTypeVisible).Count
</span></span><span class="line"><span class="cl">        On Error GoTo 0
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        If filteredCount = 0 Then
</span></span><span class="line"><span class="cl">            MsgBox &#34;æ²¡æœ‰æ‰¾åˆ°ç¬¦åˆæ¡ä»¶çš„æ•°æ®&#34;, vbInformation
</span></span><span class="line"><span class="cl">            ws.AutoFilterMode = False
</span></span><span class="line"><span class="cl">        Else
</span></span><span class="line"><span class="cl">            MsgBox &#34;å·²ç­›é€‰å‡º &#34; &amp; filteredCount &amp; &#34; æ¡è®°å½•&#34;, vbInformation
</span></span><span class="line"><span class="cl">        End If
</span></span><span class="line"><span class="cl">    End With
</span></span><span class="line"><span class="cl">End Sub
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">&#39; æ¨¡å—3ï¼šæŠ¥è¡¨ç”Ÿæˆ
</span></span><span class="line"><span class="cl">Sub GenerateReport()
</span></span><span class="line"><span class="cl">    Dim wsData As Worksheet
</span></span><span class="line"><span class="cl">    Dim wsReport As Worksheet
</span></span><span class="line"><span class="cl">    Dim lastRow As Long
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    Set wsData = ThisWorkbook.Sheets(&#34;é”€å”®è®°å½•&#34;)
</span></span><span class="line"><span class="cl">    Set wsReport = ThisWorkbook.Sheets.Add
</span></span><span class="line"><span class="cl">    wsReport.Name = &#34;é”€å”®æŠ¥è¡¨_&#34; &amp; Format(Date, &#34;yyyymmdd&#34;)
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; å¤åˆ¶æ ‡é¢˜
</span></span><span class="line"><span class="cl">    wsData.Range(&#34;A1:E1&#34;).Copy wsReport.Range(&#34;A1&#34;)
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; å¤åˆ¶ç­›é€‰åçš„æ•°æ®
</span></span><span class="line"><span class="cl">    wsData.Range(&#34;A1:E1000&#34;).SpecialCells(xlCellTypeVisible).Copy _
</span></span><span class="line"><span class="cl">        wsReport.Range(&#34;A1&#34;)
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; æ ¼å¼åŒ–æŠ¥è¡¨
</span></span><span class="line"><span class="cl">    With wsReport
</span></span><span class="line"><span class="cl">        &#39; è°ƒæ•´åˆ—å®½
</span></span><span class="line"><span class="cl">        .Columns(&#34;A:E&#34;).AutoFit
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        &#39; è®¾ç½®æ ‡é¢˜æ ¼å¼
</span></span><span class="line"><span class="cl">        With .Range(&#34;A1:E1&#34;)
</span></span><span class="line"><span class="cl">            .Font.Bold = True
</span></span><span class="line"><span class="cl">            .Interior.Color = RGB(200, 220, 255)
</span></span><span class="line"><span class="cl">        End With
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        &#39; æ·»åŠ æ€»è®¡è¡Œ
</span></span><span class="line"><span class="cl">        lastRow = .Cells(.Rows.Count, &#34;A&#34;).End(xlUp).Row + 1
</span></span><span class="line"><span class="cl">        .Cells(lastRow, &#34;A&#34;).Value = &#34;æ€»è®¡&#34;
</span></span><span class="line"><span class="cl">        .Cells(lastRow, &#34;E&#34;).Formula = &#34;=SUM(E2:E&#34; &amp; lastRow - 1 &amp; &#34;)&#34;
</span></span><span class="line"><span class="cl">        .Cells(lastRow, &#34;E&#34;).Font.Bold = True
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        &#39; åˆ›å»ºå›¾è¡¨
</span></span><span class="line"><span class="cl">        With .ChartObjects.Add(Left:=300, Top:=50, Width:=400, Height:=250).Chart
</span></span><span class="line"><span class="cl">            .ChartType = xlColumnClustered
</span></span><span class="line"><span class="cl">            .SetSourceData Source:=.Parent.Parent.Range(&#34;B2:E&#34; &amp; lastRow - 1)
</span></span><span class="line"><span class="cl">            .HasTitle = True
</span></span><span class="line"><span class="cl">            .ChartTitle.Text = &#34;é”€å”®æ•°æ®æ±‡æ€»&#34;
</span></span><span class="line"><span class="cl">        End With
</span></span><span class="line"><span class="cl">    End With
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    MsgBox &#34;æŠ¥è¡¨å·²ç”Ÿæˆï¼š&#34; &amp; wsReport.Name, vbInformation
</span></span><span class="line"><span class="cl">End Sub
</span></span></code></pre></div><h2 id="æ–‡ä»¶æ“ä½œ">æ–‡ä»¶æ“ä½œ
</h2><p>æ–‡ä»¶æ“ä½œæ˜¯èƒ½å¤Ÿå®ç°æ–‡æœ¬æ–‡ä»¶çš„è¯»å–ã€å†™å…¥å’Œä¿®æ”¹ã€‚</p>
<h3 id="æ–‡ä»¶æ“ä½œåŸºç¡€æ¦‚å¿µ">æ–‡ä»¶æ“ä½œåŸºç¡€æ¦‚å¿µ
</h3><p>VBAä¸­æ–‡ä»¶æ“ä½œçš„æ ¸å¿ƒå‡½æ•°å’Œè¯­å¥ï¼š</p>
<ul>
<li><code>Open</code>ï¼šæ‰“å¼€æ–‡ä»¶</li>
<li><code>Close</code>ï¼šå…³é—­æ–‡ä»¶</li>
<li><code>Input</code>/<code>Line Input</code>ï¼šè¯»å–æ–‡ä»¶å†…å®¹</li>
<li><code>Print</code>/<code>Write</code>ï¼šå†™å…¥æ–‡ä»¶å†…å®¹</li>
<li><code>FreeFile</code>ï¼šè·å–å¯ç”¨çš„æ–‡ä»¶å·</li>
<li><code>EOF</code>ï¼šåˆ¤æ–­æ˜¯å¦åˆ°è¾¾æ–‡ä»¶æœ«å°¾</li>
</ul>
<p>æ–‡ä»¶æ‰“å¼€æ¨¡å¼ï¼š</p>
<ul>
<li><code>For Input</code>ï¼šåªè¯»æ¨¡å¼ï¼Œç”¨äºè¯»å–æ–‡ä»¶</li>
<li><code>For Output</code>ï¼šåªå†™æ¨¡å¼ï¼Œç”¨äºåˆ›å»ºæ–°æ–‡ä»¶æˆ–è¦†ç›–å·²æœ‰æ–‡ä»¶</li>
<li><code>For Append</code>ï¼šè¿½åŠ æ¨¡å¼ï¼Œåœ¨å·²æœ‰æ–‡ä»¶æœ«å°¾æ·»åŠ å†…å®¹</li>
<li><code>For Binary</code>ï¼šäºŒè¿›åˆ¶æ¨¡å¼ï¼Œç”¨äºè¯»å†™äºŒè¿›åˆ¶æ–‡ä»¶</li>
</ul>
<h3 id="è¯»å–æ–‡æœ¬æ–‡ä»¶">è¯»å–æ–‡æœ¬æ–‡ä»¶
</h3><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Sub ReadTextFile()
</span></span><span class="line"><span class="cl">    Dim filePath As String
</span></span><span class="line"><span class="cl">    Dim fileNumber As Integer
</span></span><span class="line"><span class="cl">    Dim lineContent As String
</span></span><span class="line"><span class="cl">    Dim rowNum As Integer
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; è·å–æ–‡ä»¶è·¯å¾„
</span></span><span class="line"><span class="cl">    filePath = &#34;C:\data\example.txt&#34;
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨
</span></span><span class="line"><span class="cl">    If Dir(filePath) = &#34;&#34; Then
</span></span><span class="line"><span class="cl">        MsgBox &#34;æ–‡ä»¶ä¸å­˜åœ¨: &#34; &amp; filePath, vbExclamation
</span></span><span class="line"><span class="cl">        Exit Sub
</span></span><span class="line"><span class="cl">    End If
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; è·å–å¯ç”¨æ–‡ä»¶å·
</span></span><span class="line"><span class="cl">    fileNumber = FreeFile
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; æ‰“å¼€æ–‡ä»¶ç”¨äºè¯»å–
</span></span><span class="line"><span class="cl">    Open filePath For Input As #fileNumber
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; åˆå§‹åŒ–è¡Œå·
</span></span><span class="line"><span class="cl">    rowNum = 1
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; è¯»å–æ–‡ä»¶å†…å®¹å¹¶è¾“å‡ºåˆ°å·¥ä½œè¡¨
</span></span><span class="line"><span class="cl">    Worksheets(&#34;æ•°æ®&#34;).Range(&#34;A:A&#34;).ClearContents &#39; æ¸…ç©ºAåˆ—
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    Do While Not EOF(fileNumber)
</span></span><span class="line"><span class="cl">        &#39; è¯»å–ä¸€è¡Œå†…å®¹
</span></span><span class="line"><span class="cl">        Line Input #fileNumber, lineContent
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        &#39; å†™å…¥åˆ°å·¥ä½œè¡¨
</span></span><span class="line"><span class="cl">        Worksheets(&#34;æ•°æ®&#34;).Cells(rowNum, 1).Value = lineContent
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        rowNum = rowNum + 1
</span></span><span class="line"><span class="cl">    Loop
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; å…³é—­æ–‡ä»¶
</span></span><span class="line"><span class="cl">    Close #fileNumber
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    MsgBox &#34;æ–‡ä»¶è¯»å–å®Œæˆï¼Œå…± &#34; &amp; rowNum - 1 &amp; &#34; è¡Œ&#34;, vbInformation
</span></span><span class="line"><span class="cl">End Sub
</span></span></code></pre></div><h3 id="å†™å…¥æ–‡æœ¬æ–‡ä»¶">å†™å…¥æ–‡æœ¬æ–‡ä»¶
</h3><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Sub WriteToTextFile()
</span></span><span class="line"><span class="cl">    Dim filePath As String
</span></span><span class="line"><span class="cl">    Dim fileNumber As Integer
</span></span><span class="line"><span class="cl">    Dim i As Integer
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; è®¾ç½®æ–‡ä»¶è·¯å¾„
</span></span><span class="line"><span class="cl">    filePath = &#34;C:\data\output.txt&#34;
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; è·å–å¯ç”¨æ–‡ä»¶å·
</span></span><span class="line"><span class="cl">    fileNumber = FreeFile
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; æ‰“å¼€æ–‡ä»¶ç”¨äºå†™å…¥ï¼ˆä¼šè¦†ç›–å·²æœ‰æ–‡ä»¶ï¼‰
</span></span><span class="line"><span class="cl">    Open filePath For Output As #fileNumber
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; å†™å…¥å†…å®¹
</span></span><span class="line"><span class="cl">    Print #fileNumber, &#34;è¿™æ˜¯ä¸€ä¸ªç¤ºä¾‹æ–‡ä»¶&#34;
</span></span><span class="line"><span class="cl">    Print #fileNumber, &#34;ç”Ÿæˆæ—¶é—´: &#34; &amp; Now()
</span></span><span class="line"><span class="cl">    Print #fileNumber, &#34;-------------------------&#34;
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; å†™å…¥ä¸€äº›æ•°æ®
</span></span><span class="line"><span class="cl">    For i = 1 To 5
</span></span><span class="line"><span class="cl">        Print #fileNumber, &#34;æ•°æ®è¡Œ &#34; &amp; i &amp; &#34;: &#34; &amp; i * 100
</span></span><span class="line"><span class="cl">    Next i
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; å…³é—­æ–‡ä»¶
</span></span><span class="line"><span class="cl">    Close #fileNumber
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    MsgBox &#34;æ–‡ä»¶å†™å…¥å®Œæˆ: &#34; &amp; filePath, vbInformation
</span></span><span class="line"><span class="cl">End Sub
</span></span></code></pre></div><h3 id="è¿½åŠ å†…å®¹åˆ°æ–‡ä»¶">è¿½åŠ å†…å®¹åˆ°æ–‡ä»¶
</h3><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Sub AppendToFile()
</span></span><span class="line"><span class="cl">    Dim filePath As String
</span></span><span class="line"><span class="cl">    Dim fileNumber As Integer
</span></span><span class="line"><span class="cl">    Dim newData As String
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; è®¾ç½®æ–‡ä»¶è·¯å¾„
</span></span><span class="line"><span class="cl">    filePath = &#34;C:\data\log.txt&#34;
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; è·å–è¦è¿½åŠ çš„æ•°æ®
</span></span><span class="line"><span class="cl">    newData = InputBox(&#34;è¯·è¾“å…¥è¦è¿½åŠ çš„æ—¥å¿—å†…å®¹:&#34;, &#34;è¿½åŠ æ—¥å¿—&#34;)
</span></span><span class="line"><span class="cl">    If newData = &#34;&#34; Then Exit Sub &#39; ç”¨æˆ·å–æ¶ˆ
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; è·å–å¯ç”¨æ–‡ä»¶å·
</span></span><span class="line"><span class="cl">    fileNumber = FreeFile
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; æ‰“å¼€æ–‡ä»¶ç”¨äºè¿½åŠ 
</span></span><span class="line"><span class="cl">    Open filePath For Append As #fileNumber
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; å†™å…¥å¸¦æ—¶é—´æˆ³çš„å†…å®¹
</span></span><span class="line"><span class="cl">    Print #fileNumber, &#34;[&#34; &amp; Format(Now(), &#34;yyyy-mm-dd hh:nn:ss&#34;) &amp; &#34;] &#34; &amp; newData
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; å…³é—­æ–‡ä»¶
</span></span><span class="line"><span class="cl">    Close #fileNumber
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    MsgBox &#34;å†…å®¹å·²è¿½åŠ åˆ°æ–‡ä»¶&#34;, vbInformation
</span></span><span class="line"><span class="cl">End Sub
</span></span></code></pre></div><h3 id="è¯»å–æ•´ä¸ªæ–‡ä»¶å†…å®¹">è¯»å–æ•´ä¸ªæ–‡ä»¶å†…å®¹
</h3><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Sub ReadEntireFile()
</span></span><span class="line"><span class="cl">    Dim filePath As String
</span></span><span class="line"><span class="cl">    Dim fileNumber As Integer
</span></span><span class="line"><span class="cl">    Dim fileContent As String
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; è®¾ç½®æ–‡ä»¶è·¯å¾„
</span></span><span class="line"><span class="cl">    filePath = &#34;C:\data\notes.txt&#34;
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨
</span></span><span class="line"><span class="cl">    If Dir(filePath) = &#34;&#34; Then
</span></span><span class="line"><span class="cl">        MsgBox &#34;æ–‡ä»¶ä¸å­˜åœ¨&#34;, vbExclamation
</span></span><span class="line"><span class="cl">        Exit Sub
</span></span><span class="line"><span class="cl">    End If
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; è·å–å¯ç”¨æ–‡ä»¶å·
</span></span><span class="line"><span class="cl">    fileNumber = FreeFile
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; æ‰“å¼€æ–‡ä»¶
</span></span><span class="line"><span class="cl">    Open filePath For Input As #fileNumber
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; è¯»å–æ•´ä¸ªæ–‡ä»¶å†…å®¹
</span></span><span class="line"><span class="cl">    fileContent = Input(LOF(fileNumber), fileNumber)
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; å…³é—­æ–‡ä»¶
</span></span><span class="line"><span class="cl">    Close #fileNumber
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; æ˜¾ç¤ºæ–‡ä»¶å†…å®¹ï¼ˆé•¿å†…å®¹ä¼šè‡ªåŠ¨æˆªæ–­ï¼‰
</span></span><span class="line"><span class="cl">    MsgBox &#34;æ–‡ä»¶å†…å®¹: &#34; &amp; vbCrLf &amp; fileContent, vbInformation, &#34;æ–‡ä»¶å†…å®¹&#34;
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; ä¹Ÿå¯ä»¥å°†å†…å®¹å†™å…¥å•å…ƒæ ¼
</span></span><span class="line"><span class="cl">    Worksheets(&#34;æ•°æ®&#34;).Range(&#34;A1&#34;).Value = fileContent
</span></span><span class="line"><span class="cl">End Sub
</span></span></code></pre></div><h3 id="æ‰¹é‡å¤„ç†å¤šä¸ªæ–‡ä»¶">æ‰¹é‡å¤„ç†å¤šä¸ªæ–‡ä»¶
</h3><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Sub ProcessMultipleFiles()
</span></span><span class="line"><span class="cl">    Dim folderPath As String
</span></span><span class="line"><span class="cl">    Dim fileName As String
</span></span><span class="line"><span class="cl">    Dim fileNumber As Integer
</span></span><span class="line"><span class="cl">    Dim content As String
</span></span><span class="line"><span class="cl">    Dim resultRow As Integer
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; è®¾ç½®æ–‡ä»¶å¤¹è·¯å¾„
</span></span><span class="line"><span class="cl">    folderPath = &#34;C:\data\reports\&#34;
</span></span><span class="line"><span class="cl">    resultRow = 1
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; æ¸…ç©ºç»“æœåŒºåŸŸ
</span></span><span class="line"><span class="cl">    Worksheets(&#34;æ±‡æ€»&#34;).Range(&#34;A:B&#34;).ClearContents
</span></span><span class="line"><span class="cl">    Worksheets(&#34;æ±‡æ€»&#34;).Cells(1, 1).Value = &#34;æ–‡ä»¶å&#34;
</span></span><span class="line"><span class="cl">    Worksheets(&#34;æ±‡æ€»&#34;).Cells(1, 2).Value = &#34;ç¬¬ä¸€è¡Œå†…å®¹&#34;
</span></span><span class="line"><span class="cl">    Worksheets(&#34;æ±‡æ€»&#34;).Rows(1).Font.Bold = True
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; è·å–ç¬¬ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶
</span></span><span class="line"><span class="cl">    fileName = Dir(folderPath &amp; &#34;*.txt&#34;)
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; å¾ªç¯å¤„ç†æ‰€æœ‰æ–‡æœ¬æ–‡ä»¶
</span></span><span class="line"><span class="cl">    Do While fileName &lt;&gt; &#34;&#34;
</span></span><span class="line"><span class="cl">        resultRow = resultRow + 1
</span></span><span class="line"><span class="cl">        Worksheets(&#34;æ±‡æ€»&#34;).Cells(resultRow, 1).Value = fileName
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        &#39; è¯»å–æ–‡ä»¶ç¬¬ä¸€è¡Œ
</span></span><span class="line"><span class="cl">        fileNumber = FreeFile
</span></span><span class="line"><span class="cl">        Open folderPath &amp; fileName For Input As #fileNumber
</span></span><span class="line"><span class="cl">        Line Input #fileNumber, content
</span></span><span class="line"><span class="cl">        Close #fileNumber
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        &#39; å†™å…¥ç»“æœ
</span></span><span class="line"><span class="cl">        Worksheets(&#34;æ±‡æ€»&#34;).Cells(resultRow, 2).Value = content
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        &#39; è·å–ä¸‹ä¸€ä¸ªæ–‡ä»¶
</span></span><span class="line"><span class="cl">        fileName = Dir()
</span></span><span class="line"><span class="cl">    Loop
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; è°ƒæ•´åˆ—å®½
</span></span><span class="line"><span class="cl">    Worksheets(&#34;æ±‡æ€»&#34;).Columns(&#34;A:B&#34;).AutoFit
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    MsgBox &#34;å¤„ç†å®Œæˆï¼Œå…± &#34; &amp; resultRow - 1 &amp; &#34; ä¸ªæ–‡ä»¶&#34;, vbInformation
</span></span><span class="line"><span class="cl">End Sub
</span></span></code></pre></div><h3 id="æ–‡ä»¶æ“ä½œçš„é”™è¯¯å¤„ç†">æ–‡ä»¶æ“ä½œçš„é”™è¯¯å¤„ç†
</h3><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Sub FileOperationWithErrorHandling()
</span></span><span class="line"><span class="cl">    Dim filePath As String
</span></span><span class="line"><span class="cl">    Dim fileNumber As Integer
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    filePath = &#34;C:\data\sensitive.txt&#34;
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    On Error GoTo ErrorHandler
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    fileNumber = FreeFile
</span></span><span class="line"><span class="cl">    Open filePath For Input As #fileNumber
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; è¿™é‡Œæ·»åŠ æ–‡ä»¶å¤„ç†ä»£ç 
</span></span><span class="line"><span class="cl">    MsgBox &#34;æ–‡ä»¶æ‰“å¼€æˆåŠŸï¼Œå¯ä»¥è¿›è¡Œè¯»å†™æ“ä½œ&#34;, vbInformation
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    Close #fileNumber
</span></span><span class="line"><span class="cl">    Exit Sub
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">ErrorHandler:
</span></span><span class="line"><span class="cl">    &#39; å¤„ç†ä¸åŒç±»å‹çš„é”™è¯¯
</span></span><span class="line"><span class="cl">    Select Case Err.Number
</span></span><span class="line"><span class="cl">        Case 53 &#39; æ–‡ä»¶æœªæ‰¾åˆ°
</span></span><span class="line"><span class="cl">            MsgBox &#34;é”™è¯¯: æ‰¾ä¸åˆ°æ–‡ä»¶ &#34; &amp; filePath, vbCritical
</span></span><span class="line"><span class="cl">        Case 70 &#39; æƒé™è¢«æ‹’ç»
</span></span><span class="line"><span class="cl">            MsgBox &#34;é”™è¯¯: æ²¡æœ‰æƒé™è®¿é—®æ–‡ä»¶ &#34; &amp; filePath, vbCritical
</span></span><span class="line"><span class="cl">        Case Else
</span></span><span class="line"><span class="cl">            MsgBox &#34;å‘ç”Ÿé”™è¯¯ &#34; &amp; Err.Number &amp; &#34;: &#34; &amp; Err.Description, vbCritical
</span></span><span class="line"><span class="cl">    End Select
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; ç¡®ä¿æ–‡ä»¶è¢«å…³é—­
</span></span><span class="line"><span class="cl">    On Error Resume Next
</span></span><span class="line"><span class="cl">    Close #fileNumber
</span></span><span class="line"><span class="cl">End Sub
</span></span></code></pre></div><h3 id="filedialogåŸºç¡€">FileDialogåŸºç¡€
</h3><p><code>FileDialog</code>æ˜¯Officeåº”ç”¨ç¨‹åºæä¾›çš„æ–‡ä»¶å¯¹è¯æ¡†å¯¹è±¡ï¼Œæ”¯æŒå¤šç§æ“ä½œç±»å‹ï¼ŒåŒ…æ‹¬æ‰“å¼€æ–‡ä»¶ã€ä¿å­˜æ–‡ä»¶å’Œé€‰æ‹©æ–‡ä»¶å¤¹ã€‚åœ¨Excel VBAä¸­ï¼Œæˆ‘ä»¬é€šè¿‡<code>Application.FileDialog</code>æ¥ä½¿ç”¨è¿™ä¸€åŠŸèƒ½ã€‚</p>
<h4 id="filedialogçš„å››ç§ç±»å‹">FileDialogçš„å››ç§ç±»å‹
</h4><p>VBAæä¾›å››ç§æ–‡ä»¶å¯¹è¯æ¡†ç±»å‹ï¼š</p>
<ul>
<li><code>msoFileDialogOpen</code>ï¼šæ‰“å¼€æ–‡ä»¶å¯¹è¯æ¡†ï¼ˆå¯é€‰æ‹©ä¸€ä¸ªæˆ–å¤šä¸ªæ–‡ä»¶ï¼‰</li>
<li><code>msoFileDialogSaveAs</code>ï¼šä¿å­˜æ–‡ä»¶å¯¹è¯æ¡†</li>
<li><code>msoFileDialogFilePicker</code>ï¼šæ–‡ä»¶é€‰æ‹©å¯¹è¯æ¡†ï¼ˆç±»ä¼¼æ‰“å¼€ï¼Œä½†æ›´é€šç”¨ï¼‰</li>
<li><code>msoFileDialogFolderPicker</code>ï¼šæ–‡ä»¶å¤¹é€‰æ‹©å¯¹è¯æ¡†</li>
</ul>
<h4 id="åŸºæœ¬ä½¿ç”¨æ–¹æ³•">åŸºæœ¬ä½¿ç”¨æ–¹æ³•
</h4><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Sub BasicFileDialog()
</span></span><span class="line"><span class="cl">    Dim fd As FileDialog
</span></span><span class="line"><span class="cl">    Dim selectedFile As String
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; åˆ›å»ºæ–‡ä»¶å¯¹è¯æ¡†å®ä¾‹ï¼ˆæ‰“å¼€æ–‡ä»¶ç±»å‹ï¼‰
</span></span><span class="line"><span class="cl">    Set fd = Application.FileDialog(msoFileDialogOpen)
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; è®¾ç½®å¯¹è¯æ¡†æ ‡é¢˜
</span></span><span class="line"><span class="cl">    fd.Title = &#34;è¯·é€‰æ‹©è¦æ‰“å¼€çš„æ–‡æœ¬æ–‡ä»¶&#34;
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; è®¾ç½®å…è®¸é€‰æ‹©çš„æ–‡ä»¶ç±»å‹
</span></span><span class="line"><span class="cl">    fd.Filters.Clear &#39; æ¸…é™¤é»˜è®¤ç­›é€‰å™¨
</span></span><span class="line"><span class="cl">    fd.Filters.Add &#34;æ–‡æœ¬æ–‡ä»¶&#34;, &#34;*.txt&#34; &#39; æ·»åŠ æ–‡æœ¬æ–‡ä»¶ç­›é€‰
</span></span><span class="line"><span class="cl">    fd.Filters.Add &#34;Excelæ–‡ä»¶&#34;, &#34;*.xlsx;*.xls&#34; &#39; æ·»åŠ Excelæ–‡ä»¶ç­›é€‰
</span></span><span class="line"><span class="cl">    fd.Filters.Add &#34;æ‰€æœ‰æ–‡ä»¶&#34;, &#34;*.*&#34; &#39; æ·»åŠ æ‰€æœ‰æ–‡ä»¶ç­›é€‰
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; å…è®¸é€‰æ‹©å¤šä¸ªæ–‡ä»¶ï¼ˆé»˜è®¤æ˜¯Falseï¼‰
</span></span><span class="line"><span class="cl">    fd.AllowMultiSelect = False
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; æ˜¾ç¤ºå¯¹è¯æ¡†ï¼Œå¦‚æœç”¨æˆ·ç‚¹å‡»äº†&#34;ç¡®å®š&#34;æŒ‰é’®
</span></span><span class="line"><span class="cl">    If fd.Show = -1 Then
</span></span><span class="line"><span class="cl">        &#39; è·å–é€‰ä¸­çš„æ–‡ä»¶è·¯å¾„
</span></span><span class="line"><span class="cl">        selectedFile = fd.SelectedItems(1)
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        &#39; æ˜¾ç¤ºé€‰ä¸­çš„æ–‡ä»¶
</span></span><span class="line"><span class="cl">        MsgBox &#34;æ‚¨é€‰æ‹©çš„æ–‡ä»¶æ˜¯: &#34; &amp; vbCrLf &amp; selectedFile, vbInformation
</span></span><span class="line"><span class="cl">    Else
</span></span><span class="line"><span class="cl">        &#39; ç”¨æˆ·å–æ¶ˆäº†æ“ä½œ
</span></span><span class="line"><span class="cl">        MsgBox &#34;æ‚¨å–æ¶ˆäº†æ–‡ä»¶é€‰æ‹©&#34;, vbInformation
</span></span><span class="line"><span class="cl">    End If
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; é‡Šæ”¾å¯¹è±¡
</span></span><span class="line"><span class="cl">    Set fd = Nothing
</span></span><span class="line"><span class="cl">End Sub
</span></span></code></pre></div><h4 id="å•æ–‡ä»¶é€‰æ‹©å¯¹è¯æ¡†æ‰“å¼€æ–‡ä»¶">å•æ–‡ä»¶é€‰æ‹©å¯¹è¯æ¡†ï¼ˆæ‰“å¼€æ–‡ä»¶ï¼‰
</h4><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Sub SelectSingleFile()
</span></span><span class="line"><span class="cl">    Dim fd As FileDialog
</span></span><span class="line"><span class="cl">    Dim filePath As String
</span></span><span class="line"><span class="cl">    Dim ws As Worksheet
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; åˆ›å»ºæ–‡ä»¶é€‰æ‹©å¯¹è¯æ¡†
</span></span><span class="line"><span class="cl">    Set fd = Application.FileDialog(msoFileDialogFilePicker)
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    With fd
</span></span><span class="line"><span class="cl">        .Title = &#34;é€‰æ‹©è¦å¯¼å…¥çš„æ•°æ®æ–‡ä»¶&#34;
</span></span><span class="line"><span class="cl">        .Filters.Clear
</span></span><span class="line"><span class="cl">        .Filters.Add &#34;CSVæ–‡ä»¶&#34;, &#34;*.csv&#34;
</span></span><span class="line"><span class="cl">        .Filters.Add &#34;æ–‡æœ¬æ–‡ä»¶&#34;, &#34;*.txt&#34;
</span></span><span class="line"><span class="cl">        .AllowMultiSelect = False &#39; åªå…è®¸é€‰æ‹©ä¸€ä¸ªæ–‡ä»¶
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        &#39; æ˜¾ç¤ºå¯¹è¯æ¡†
</span></span><span class="line"><span class="cl">        If .Show = -1 Then
</span></span><span class="line"><span class="cl">            filePath = .SelectedItems(1)
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            &#39; è¿™é‡Œå¯ä»¥æ·»åŠ å¤„ç†æ–‡ä»¶çš„ä»£ç 
</span></span><span class="line"><span class="cl">            Set ws = ThisWorkbook.Sheets.Add
</span></span><span class="line"><span class="cl">            ws.Name = &#34;å¯¼å…¥æ•°æ®&#34;
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            MsgBox &#34;å·²é€‰æ‹©æ–‡ä»¶: &#34; &amp; filePath &amp; vbCrLf &amp; _
</span></span><span class="line"><span class="cl">                   &#34;æ•°æ®å°†å¯¼å…¥åˆ° &#34;&#34;&#34; &amp; ws.Name &amp; &#34;&#34;&#34; å·¥ä½œè¡¨&#34;, vbInformation
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            &#39; è°ƒç”¨æ–‡ä»¶è¯»å–å‡½æ•°ï¼ˆä½¿ç”¨ä¹‹å‰å­¦è¿‡çš„æ–‡ä»¶è¯»å–æ–¹æ³•ï¼‰
</span></span><span class="line"><span class="cl">            ReadDataToWorksheet filePath, ws
</span></span><span class="line"><span class="cl">        End If
</span></span><span class="line"><span class="cl">    End With
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    Set fd = Nothing
</span></span><span class="line"><span class="cl">End Sub
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">&#39; è¾…åŠ©å‡½æ•°ï¼šå°†æ–‡ä»¶å†…å®¹è¯»å–åˆ°å·¥ä½œè¡¨
</span></span><span class="line"><span class="cl">Sub ReadDataToWorksheet(filePath As String, ws As Worksheet)
</span></span><span class="line"><span class="cl">    Dim fileNum As Integer
</span></span><span class="line"><span class="cl">    Dim lineContent As String
</span></span><span class="line"><span class="cl">    Dim rowNum As Long
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    rowNum = 1
</span></span><span class="line"><span class="cl">    fileNum = FreeFile
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    Open filePath For Input As #fileNum
</span></span><span class="line"><span class="cl">        Do While Not EOF(fileNum)
</span></span><span class="line"><span class="cl">            Line Input #fileNum, lineContent
</span></span><span class="line"><span class="cl">            ws.Cells(rowNum, 1).Value = lineContent
</span></span><span class="line"><span class="cl">            rowNum = rowNum + 1
</span></span><span class="line"><span class="cl">        Loop
</span></span><span class="line"><span class="cl">    Close #fileNum
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    ws.Columns(&#34;A:A&#34;).AutoFit
</span></span><span class="line"><span class="cl">    MsgBox &#34;æ•°æ®å¯¼å…¥å®Œæˆï¼Œå…± &#34; &amp; rowNum - 1 &amp; &#34; è¡Œ&#34;, vbInformation
</span></span><span class="line"><span class="cl">End Sub
</span></span></code></pre></div><h4 id="å¤šæ–‡ä»¶é€‰æ‹©å¯¹è¯æ¡†">å¤šæ–‡ä»¶é€‰æ‹©å¯¹è¯æ¡†
</h4><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Sub SelectMultipleFiles()
</span></span><span class="line"><span class="cl">    Dim fd As FileDialog
</span></span><span class="line"><span class="cl">    Dim i As Integer
</span></span><span class="line"><span class="cl">    Dim ws As Worksheet
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; åˆ›å»ºæ–‡ä»¶é€‰æ‹©å¯¹è¯æ¡†
</span></span><span class="line"><span class="cl">    Set fd = Application.FileDialog(msoFileDialogFilePicker)
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    With fd
</span></span><span class="line"><span class="cl">        .Title = &#34;é€‰æ‹©å¤šä¸ªè¦å¤„ç†çš„æ–‡ä»¶&#34;
</span></span><span class="line"><span class="cl">        .Filters.Clear
</span></span><span class="line"><span class="cl">        .Filters.Add &#34;æ–‡æœ¬æ–‡ä»¶&#34;, &#34;*.txt&#34;
</span></span><span class="line"><span class="cl">        .AllowMultiSelect = True &#39; å…è®¸é€‰æ‹©å¤šä¸ªæ–‡ä»¶
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        &#39; æ˜¾ç¤ºå¯¹è¯æ¡†
</span></span><span class="line"><span class="cl">        If .Show = -1 Then
</span></span><span class="line"><span class="cl">            &#39; åˆ›å»ºç»“æœå·¥ä½œè¡¨
</span></span><span class="line"><span class="cl">            Set ws = ThisWorkbook.Sheets.Add
</span></span><span class="line"><span class="cl">            ws.Name = &#34;å¤šæ–‡ä»¶å¤„ç†ç»“æœ&#34;
</span></span><span class="line"><span class="cl">            ws.Cells(1, 1).Value = &#34;æ–‡ä»¶å&#34;
</span></span><span class="line"><span class="cl">            ws.Cells(1, 2).Value = &#34;è·¯å¾„&#34;
</span></span><span class="line"><span class="cl">            ws.Cells(1, 3).Value = &#34;è¡Œæ•°&#34;
</span></span><span class="line"><span class="cl">            ws.Rows(1).Font.Bold = True
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            &#39; å¤„ç†æ¯ä¸ªé€‰ä¸­çš„æ–‡ä»¶
</span></span><span class="line"><span class="cl">            For i = 1 To .SelectedItems.Count
</span></span><span class="line"><span class="cl">                ProcessFile .SelectedItems(i), ws, i + 1
</span></span><span class="line"><span class="cl">            Next i
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            ws.Columns(&#34;A:C&#34;).AutoFit
</span></span><span class="line"><span class="cl">            MsgBox &#34;å·²å¤„ç† &#34; &amp; .SelectedItems.Count &amp; &#34; ä¸ªæ–‡ä»¶&#34;, vbInformation
</span></span><span class="line"><span class="cl">        End If
</span></span><span class="line"><span class="cl">    End With
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    Set fd = Nothing
</span></span><span class="line"><span class="cl">End Sub
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">&#39; è¾…åŠ©å‡½æ•°ï¼šå¤„ç†å•ä¸ªæ–‡ä»¶å¹¶è®°å½•ä¿¡æ¯
</span></span><span class="line"><span class="cl">Sub ProcessFile(filePath As String, ws As Worksheet, rowNum As Long)
</span></span><span class="line"><span class="cl">    Dim fileNum As Integer
</span></span><span class="line"><span class="cl">    Dim lineCount As Long
</span></span><span class="line"><span class="cl">    Dim dummy As String
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; è·å–æ–‡ä»¶åï¼ˆä¸åŒ…å«è·¯å¾„ï¼‰
</span></span><span class="line"><span class="cl">    Dim fileName As String
</span></span><span class="line"><span class="cl">    fileName = Mid(filePath, InStrRev(filePath, &#34;\&#34;) + 1)
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; è®¡ç®—æ–‡ä»¶è¡Œæ•°
</span></span><span class="line"><span class="cl">    lineCount = 0
</span></span><span class="line"><span class="cl">    fileNum = FreeFile
</span></span><span class="line"><span class="cl">    Open filePath For Input As #fileNum
</span></span><span class="line"><span class="cl">        Do While Not EOF(fileNum)
</span></span><span class="line"><span class="cl">            Line Input #fileNum, dummy
</span></span><span class="line"><span class="cl">            lineCount = lineCount + 1
</span></span><span class="line"><span class="cl">        Loop
</span></span><span class="line"><span class="cl">    Close #fileNum
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; è®°å½•ä¿¡æ¯åˆ°å·¥ä½œè¡¨
</span></span><span class="line"><span class="cl">    ws.Cells(rowNum, 1).Value = fileName
</span></span><span class="line"><span class="cl">    ws.Cells(rowNum, 2).Value = filePath
</span></span><span class="line"><span class="cl">    ws.Cells(rowNum, 3).Value = lineCount
</span></span><span class="line"><span class="cl">End Sub
</span></span></code></pre></div><h4 id="ä¿å­˜æ–‡ä»¶å¯¹è¯æ¡†">ä¿å­˜æ–‡ä»¶å¯¹è¯æ¡†
</h4><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Sub SaveFileDialogDemo()
</span></span><span class="line"><span class="cl">    Dim fd As FileDialog
</span></span><span class="line"><span class="cl">    Dim savePath As String
</span></span><span class="line"><span class="cl">    Dim fileNum As Integer
</span></span><span class="line"><span class="cl">    Dim i As Integer
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; åˆ›å»ºä¿å­˜æ–‡ä»¶å¯¹è¯æ¡†
</span></span><span class="line"><span class="cl">    Set fd = Application.FileDialog(msoFileDialogSaveAs)
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    With fd
</span></span><span class="line"><span class="cl">        .Title = &#34;ä¿å­˜å¯¼å‡ºæ•°æ®&#34;
</span></span><span class="line"><span class="cl">        .InitialFileName = &#34;å¯¼å‡ºæ•°æ®_&#34; &amp; Format(Date, &#34;yyyymmdd&#34;) &amp; &#34;.txt&#34; &#39; é»˜è®¤æ–‡ä»¶å
</span></span><span class="line"><span class="cl">        .InitialView = msoFileDialogViewDetails &#39; è¯¦ç»†è§†å›¾
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        &#39; æ˜¾ç¤ºå¯¹è¯æ¡†
</span></span><span class="line"><span class="cl">        If .Show = -1 Then
</span></span><span class="line"><span class="cl">            savePath = .SelectedItems(1)
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            &#39; æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å·²å­˜åœ¨
</span></span><span class="line"><span class="cl">            If Dir(savePath) &lt;&gt; &#34;&#34; Then
</span></span><span class="line"><span class="cl">                If MsgBox(&#34;æ–‡ä»¶å·²å­˜åœ¨ï¼Œæ˜¯å¦è¦†ç›–?&#34;, vbYesNo + vbQuestion) = vbNo Then
</span></span><span class="line"><span class="cl">                    MsgBox &#34;ä¿å­˜æ“ä½œå·²å–æ¶ˆ&#34;, vbInformation
</span></span><span class="line"><span class="cl">                    Exit Sub
</span></span><span class="line"><span class="cl">                End If
</span></span><span class="line"><span class="cl">            End If
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            &#39; å†™å…¥ç¤ºä¾‹æ•°æ®
</span></span><span class="line"><span class="cl">            fileNum = FreeFile
</span></span><span class="line"><span class="cl">            Open savePath For Output As #fileNum
</span></span><span class="line"><span class="cl">                Print #fileNum, &#34;æ•°æ®å¯¼å‡ºæ—¶é—´: &#34; &amp; Now()
</span></span><span class="line"><span class="cl">                Print #fileNum, &#34;====================&#34;
</span></span><span class="line"><span class="cl">                For i = 1 To 10
</span></span><span class="line"><span class="cl">                    Print #fileNum, &#34;ç¤ºä¾‹æ•°æ®è¡Œ &#34; &amp; i &amp; &#34;: &#34; &amp; i * Rnd() * 1000
</span></span><span class="line"><span class="cl">                Next i
</span></span><span class="line"><span class="cl">            Close #fileNum
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            MsgBox &#34;æ•°æ®å·²æˆåŠŸä¿å­˜åˆ°: &#34; &amp; vbCrLf &amp; savePath, vbInformation
</span></span><span class="line"><span class="cl">        End If
</span></span><span class="line"><span class="cl">    End With
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    Set fd = Nothing
</span></span><span class="line"><span class="cl">End Sub
</span></span></code></pre></div><h4 id="æ–‡ä»¶å¤¹é€‰æ‹©å¯¹è¯æ¡†">æ–‡ä»¶å¤¹é€‰æ‹©å¯¹è¯æ¡†
</h4><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Sub SelectFolderDialog()
</span></span><span class="line"><span class="cl">    Dim fd As FileDialog
</span></span><span class="line"><span class="cl">    Dim folderPath As String
</span></span><span class="line"><span class="cl">    Dim fileName As String
</span></span><span class="line"><span class="cl">    Dim ws As Worksheet
</span></span><span class="line"><span class="cl">    Dim rowNum As Long
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; åˆ›å»ºæ–‡ä»¶å¤¹é€‰æ‹©å¯¹è¯æ¡†
</span></span><span class="line"><span class="cl">    Set fd = Application.FileDialog(msoFileDialogFolderPicker)
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    With fd
</span></span><span class="line"><span class="cl">        .Title = &#34;é€‰æ‹©è¦æ‰«æçš„æ–‡ä»¶å¤¹&#34;
</span></span><span class="line"><span class="cl">        .InitialFileName = ThisWorkbook.Path &#39; åˆå§‹è·¯å¾„ä¸ºå½“å‰å·¥ä½œç°¿æ‰€åœ¨æ–‡ä»¶å¤¹
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        &#39; æ˜¾ç¤ºå¯¹è¯æ¡†
</span></span><span class="line"><span class="cl">        If .Show = -1 Then
</span></span><span class="line"><span class="cl">            folderPath = .SelectedItems(1)
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            &#39; åˆ›å»ºç»“æœå·¥ä½œè¡¨
</span></span><span class="line"><span class="cl">            Set ws = ThisWorkbook.Sheets.Add
</span></span><span class="line"><span class="cl">            ws.Name = &#34;æ–‡ä»¶å¤¹æ‰«æç»“æœ&#34;
</span></span><span class="line"><span class="cl">            ws.Cells(1, 1).Value = &#34;æ–‡ä»¶å&#34;
</span></span><span class="line"><span class="cl">            ws.Cells(1, 2).Value = &#34;è·¯å¾„&#34;
</span></span><span class="line"><span class="cl">            ws.Cells(1, 3).Value = &#34;å¤§å°(å­—èŠ‚)&#34;
</span></span><span class="line"><span class="cl">            ws.Cells(1, 4).Value = &#34;ä¿®æ”¹æ—¥æœŸ&#34;
</span></span><span class="line"><span class="cl">            ws.Rows(1).Font.Bold = True
</span></span><span class="line"><span class="cl">            rowNum = 2
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            &#39; è·å–æ–‡ä»¶å¤¹ä¸­çš„æ‰€æœ‰æ–‡ä»¶
</span></span><span class="line"><span class="cl">            fileName = Dir(folderPath &amp; &#34;\*.*&#34;)
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            &#39; å¾ªç¯å¤„ç†æ‰€æœ‰æ–‡ä»¶
</span></span><span class="line"><span class="cl">            Do While fileName &lt;&gt; &#34;&#34;
</span></span><span class="line"><span class="cl">                ws.Cells(rowNum, 1).Value = fileName
</span></span><span class="line"><span class="cl">                ws.Cells(rowNum, 2).Value = folderPath &amp; &#34;\&#34; &amp; fileName
</span></span><span class="line"><span class="cl">                ws.Cells(rowNum, 3).Value = FileLen(folderPath &amp; &#34;\&#34; &amp; fileName)
</span></span><span class="line"><span class="cl">                ws.Cells(rowNum, 4).Value = FileDateTime(folderPath &amp; &#34;\&#34; &amp; fileName)
</span></span><span class="line"><span class="cl">                rowNum = rowNum + 1
</span></span><span class="line"><span class="cl">                
</span></span><span class="line"><span class="cl">                &#39; è·å–ä¸‹ä¸€ä¸ªæ–‡ä»¶
</span></span><span class="line"><span class="cl">                fileName = Dir()
</span></span><span class="line"><span class="cl">            Loop
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            ws.Columns(&#34;A:D&#34;).AutoFit
</span></span><span class="line"><span class="cl">            MsgBox &#34;æ–‡ä»¶å¤¹æ‰«æå®Œæˆï¼Œå…±å‘ç° &#34; &amp; rowNum - 2 &amp; &#34; ä¸ªæ–‡ä»¶&#34;, vbInformation
</span></span><span class="line"><span class="cl">        End If
</span></span><span class="line"><span class="cl">    End With
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    Set fd = Nothing
</span></span><span class="line"><span class="cl">End Sub
</span></span></code></pre></div><h4 id="å¸¦é¢„è§ˆåŠŸèƒ½çš„æ–‡ä»¶é€‰æ‹©å™¨">å¸¦é¢„è§ˆåŠŸèƒ½çš„æ–‡ä»¶é€‰æ‹©å™¨
</h4><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Sub FileDialogWithPreview()
</span></span><span class="line"><span class="cl">    Dim fd As FileDialog
</span></span><span class="line"><span class="cl">    Dim selectedFile As String
</span></span><span class="line"><span class="cl">    Dim wsPreview As Worksheet
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; åˆ›å»ºæ–‡ä»¶å¯¹è¯æ¡†
</span></span><span class="line"><span class="cl">    Set fd = Application.FileDialog(msoFileDialogOpen)
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    With fd
</span></span><span class="line"><span class="cl">        .Title = &#34;é€‰æ‹©æ–‡æœ¬æ–‡ä»¶ï¼ˆå¸¦é¢„è§ˆï¼‰&#34;
</span></span><span class="line"><span class="cl">        .Filters.Clear
</span></span><span class="line"><span class="cl">        .Filters.Add &#34;æ–‡æœ¬æ–‡ä»¶&#34;, &#34;*.txt&#34;
</span></span><span class="line"><span class="cl">        .AllowMultiSelect = False
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        &#39; åˆ›å»ºé¢„è§ˆå·¥ä½œè¡¨
</span></span><span class="line"><span class="cl">        On Error Resume Next
</span></span><span class="line"><span class="cl">        Set wsPreview = ThisWorkbook.Sheets(&#34;æ–‡ä»¶é¢„è§ˆ&#34;)
</span></span><span class="line"><span class="cl">        On Error GoTo 0
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        If wsPreview Is Nothing Then
</span></span><span class="line"><span class="cl">            Set wsPreview = ThisWorkbook.Sheets.Add
</span></span><span class="line"><span class="cl">            wsPreview.Name = &#34;æ–‡ä»¶é¢„è§ˆ&#34;
</span></span><span class="line"><span class="cl">        End If
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        &#39; å¾ªç¯æ˜¾ç¤ºå¯¹è¯æ¡†ï¼Œç›´åˆ°ç”¨æˆ·å–æ¶ˆæˆ–é€‰æ‹©æ–‡ä»¶
</span></span><span class="line"><span class="cl">        Do
</span></span><span class="line"><span class="cl">            If .Show = -1 Then
</span></span><span class="line"><span class="cl">                selectedFile = .SelectedItems(1)
</span></span><span class="line"><span class="cl">                
</span></span><span class="line"><span class="cl">                &#39; é¢„è§ˆæ–‡ä»¶å†…å®¹
</span></span><span class="line"><span class="cl">                wsPreview.Cells.Clear
</span></span><span class="line"><span class="cl">                wsPreview.Cells(1, 1).Value = &#34;æ–‡ä»¶é¢„è§ˆ: &#34; &amp; selectedFile
</span></span><span class="line"><span class="cl">                wsPreview.Cells(1, 1).Font.Bold = True
</span></span><span class="line"><span class="cl">                
</span></span><span class="line"><span class="cl">                PreviewTextFile selectedFile, wsPreview
</span></span><span class="line"><span class="cl">                
</span></span><span class="line"><span class="cl">                &#39; è¯¢é—®ç”¨æˆ·æ˜¯å¦ç¡®è®¤é€‰æ‹©
</span></span><span class="line"><span class="cl">                If MsgBox(&#34;æ˜¯å¦ç¡®è®¤é€‰æ‹©æ­¤æ–‡ä»¶?&#34;, vbYesNo + vbQuestion) = vbYes Then
</span></span><span class="line"><span class="cl">                    MsgBox &#34;æ‚¨é€‰æ‹©äº†: &#34; &amp; selectedFile, vbInformation
</span></span><span class="line"><span class="cl">                    Exit Do
</span></span><span class="line"><span class="cl">                End If
</span></span><span class="line"><span class="cl">            Else
</span></span><span class="line"><span class="cl">                &#39; ç”¨æˆ·å–æ¶ˆ
</span></span><span class="line"><span class="cl">                MsgBox &#34;å·²å–æ¶ˆæ–‡ä»¶é€‰æ‹©&#34;, vbInformation
</span></span><span class="line"><span class="cl">                Exit Do
</span></span><span class="line"><span class="cl">            End If
</span></span><span class="line"><span class="cl">        Loop
</span></span><span class="line"><span class="cl">    End With
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    Set fd = Nothing
</span></span><span class="line"><span class="cl">End Sub
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">&#39; è¾…åŠ©å‡½æ•°ï¼šé¢„è§ˆæ–‡æœ¬æ–‡ä»¶å†…å®¹
</span></span><span class="line"><span class="cl">Sub PreviewTextFile(filePath As String, ws As Worksheet)
</span></span><span class="line"><span class="cl">    Dim fileNum As Integer
</span></span><span class="line"><span class="cl">    Dim lineContent As String
</span></span><span class="line"><span class="cl">    Dim rowNum As Long
</span></span><span class="line"><span class="cl">    Dim maxLines As Integer
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    maxLines = 50 &#39; æœ€å¤šé¢„è§ˆ50è¡Œ
</span></span><span class="line"><span class="cl">    rowNum = 3
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    fileNum = FreeFile
</span></span><span class="line"><span class="cl">    Open filePath For Input As #fileNum
</span></span><span class="line"><span class="cl">        Do While Not EOF(fileNum) And rowNum &lt;= maxLines + 2
</span></span><span class="line"><span class="cl">            Line Input #fileNum, lineContent
</span></span><span class="line"><span class="cl">            ws.Cells(rowNum, 1).Value = lineContent
</span></span><span class="line"><span class="cl">            rowNum = rowNum + 1
</span></span><span class="line"><span class="cl">        Loop
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        &#39; å¦‚æœæ–‡ä»¶è¶…è¿‡æœ€å¤§é¢„è§ˆè¡Œæ•°
</span></span><span class="line"><span class="cl">        If Not EOF(fileNum) Then
</span></span><span class="line"><span class="cl">            ws.Cells(rowNum, 1).Value = &#34;...&#34;
</span></span><span class="line"><span class="cl">            ws.Cells(rowNum, 1).Font.Italic = True
</span></span><span class="line"><span class="cl">        End If
</span></span><span class="line"><span class="cl">    Close #fileNum
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    ws.Columns(&#34;A:A&#34;).ColumnWidth = 80
</span></span><span class="line"><span class="cl">    ws.Range(&#34;A2&#34;).Value = &#34;ï¼ˆæœ€å¤šæ˜¾ç¤º&#34; &amp; maxLines &amp; &#34;è¡Œï¼‰&#34;
</span></span><span class="line"><span class="cl">    ws.Range(&#34;A2&#34;).Font.Italic = True
</span></span><span class="line"><span class="cl">End Sub
</span></span></code></pre></div><h4 id="ç»“åˆuserformçš„æ–‡ä»¶é€‰æ‹©å™¨">ç»“åˆUserFormçš„æ–‡ä»¶é€‰æ‹©å™¨
</h4><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="s1">&#39; ä»¥ä¸‹ä»£ç åº”æ”¾åœ¨UserFormçš„ä»£ç çª—å£ä¸­</span>
</span></span><span class="line"><span class="cl"><span class="n">Private</span> <span class="n">Sub</span> <span class="n">cmdBrowse_Click</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">Dim</span> <span class="n">fd</span> <span class="n">As</span> <span class="ne">FileDialog</span>
</span></span><span class="line"><span class="cl">    <span class="n">Dim</span> <span class="n">selectedFile</span> <span class="n">As</span> <span class="ne">String</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="s1">&#39; åˆ›å»ºæ–‡ä»¶å¯¹è¯æ¡†</span>
</span></span><span class="line"><span class="cl">    <span class="n">Set</span> <span class="n">fd</span> <span class="o">=</span> <span class="n">Application</span><span class="o">.</span><span class="n">FileDialog</span><span class="p">(</span><span class="n">msoFileDialogOpen</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">With</span> <span class="n">fd</span>
</span></span><span class="line"><span class="cl">        <span class="o">.</span><span class="n">Title</span> <span class="o">=</span> <span class="s2">&#34;é€‰æ‹©æ•°æ®æ–‡ä»¶&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="o">.</span><span class="n">Filters</span><span class="o">.</span><span class="n">Clear</span>
</span></span><span class="line"><span class="cl">        <span class="o">.</span><span class="n">Filters</span><span class="o">.</span><span class="n">Add</span> <span class="s2">&#34;Excelæ–‡ä»¶&#34;</span><span class="p">,</span> <span class="s2">&#34;*.xlsx;*.xls&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="o">.</span><span class="n">Filters</span><span class="o">.</span><span class="n">Add</span> <span class="s2">&#34;CSVæ–‡ä»¶&#34;</span><span class="p">,</span> <span class="s2">&#34;*.csv&#34;</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="n">If</span> <span class="o">.</span><span class="n">Show</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="n">Then</span>
</span></span><span class="line"><span class="cl">            <span class="n">selectedFile</span> <span class="o">=</span> <span class="o">.</span><span class="n">SelectedItems</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">Me</span><span class="o">.</span><span class="n">txtFilePath</span><span class="o">.</span><span class="n">Value</span> <span class="o">=</span> <span class="n">selectedFile</span> <span class="s1">&#39; åœ¨æ–‡æœ¬æ¡†ä¸­æ˜¾ç¤ºè·¯å¾„</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            <span class="s1">&#39; æå–æ–‡ä»¶åæ˜¾ç¤ºåœ¨æ ‡ç­¾ä¸­</span>
</span></span><span class="line"><span class="cl">            <span class="n">Me</span><span class="o">.</span><span class="n">lblFileName</span><span class="o">.</span><span class="n">Caption</span> <span class="o">=</span> <span class="s2">&#34;æ–‡ä»¶å: &#34;</span> <span class="o">&amp;</span> <span class="n">Mid</span><span class="p">(</span><span class="n">selectedFile</span><span class="p">,</span> <span class="n">InStrRev</span><span class="p">(</span><span class="n">selectedFile</span><span class="p">,</span> <span class="s2">&#34;</span><span class="se">\&#34;</span><span class="s2">) + 1)</span>
</span></span><span class="line"><span class="cl">        <span class="n">End</span> <span class="n">If</span>
</span></span><span class="line"><span class="cl">    <span class="n">End</span> <span class="n">With</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">Set</span> <span class="n">fd</span> <span class="o">=</span> <span class="n">Nothing</span>
</span></span><span class="line"><span class="cl"><span class="n">End</span> <span class="n">Sub</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">Private</span> <span class="n">Sub</span> <span class="n">cmdImport_Click</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39; æ£€æŸ¥æ˜¯å¦é€‰æ‹©äº†æ–‡ä»¶</span>
</span></span><span class="line"><span class="cl">    <span class="n">If</span> <span class="n">Me</span><span class="o">.</span><span class="n">txtFilePath</span><span class="o">.</span><span class="n">Value</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span> <span class="n">Then</span>
</span></span><span class="line"><span class="cl">        <span class="n">MsgBox</span> <span class="s2">&#34;è¯·å…ˆé€‰æ‹©æ–‡ä»¶&#34;</span><span class="p">,</span> <span class="n">vbExclamation</span>
</span></span><span class="line"><span class="cl">        <span class="n">Exit</span> <span class="n">Sub</span>
</span></span><span class="line"><span class="cl">    <span class="n">End</span> <span class="n">If</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="s1">&#39; æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨</span>
</span></span><span class="line"><span class="cl">    <span class="n">If</span> <span class="n">Dir</span><span class="p">(</span><span class="n">Me</span><span class="o">.</span><span class="n">txtFilePath</span><span class="o">.</span><span class="n">Value</span><span class="p">)</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span> <span class="n">Then</span>
</span></span><span class="line"><span class="cl">        <span class="n">MsgBox</span> <span class="s2">&#34;æ‰€é€‰æ–‡ä»¶ä¸å­˜åœ¨&#34;</span><span class="p">,</span> <span class="n">vbExclamation</span>
</span></span><span class="line"><span class="cl">        <span class="n">Exit</span> <span class="n">Sub</span>
</span></span><span class="line"><span class="cl">    <span class="n">End</span> <span class="n">If</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="s1">&#39; æ‰§è¡Œå¯¼å…¥æ“ä½œï¼ˆè¿™é‡Œåªæ˜¯ç¤ºä¾‹ï¼‰</span>
</span></span><span class="line"><span class="cl">    <span class="n">MsgBox</span> <span class="s2">&#34;å¼€å§‹å¯¼å…¥æ–‡ä»¶: &#34;</span> <span class="o">&amp;</span> <span class="n">Me</span><span class="o">.</span><span class="n">txtFilePath</span><span class="o">.</span><span class="n">Value</span><span class="p">,</span> <span class="n">vbInformation</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="s1">&#39; å…³é—­çª—ä½“</span>
</span></span><span class="line"><span class="cl">    <span class="n">Unload</span> <span class="n">Me</span>
</span></span><span class="line"><span class="cl"><span class="n">End</span> <span class="n">Sub</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">Private</span> <span class="n">Sub</span> <span class="n">cmdCancel_Click</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">Unload</span> <span class="n">Me</span>
</span></span><span class="line"><span class="cl"><span class="n">End</span> <span class="n">Sub</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="s1">&#39; æ ‡å‡†æ¨¡å—ä¸­çš„ä»£ç ï¼Œç”¨äºæ˜¾ç¤ºUserForm</span>
</span></span><span class="line"><span class="cl"><span class="n">Sub</span> <span class="n">ShowFileImportForm</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">FileImportForm</span><span class="o">.</span><span class="n">Show</span> <span class="s1">&#39; å‡è®¾UserFormåç§°ä¸ºFileImportForm</span>
</span></span><span class="line"><span class="cl"><span class="n">End</span> <span class="n">Sub</span>
</span></span></code></pre></div><h4 id="æ‰¹é‡æ–‡ä»¶å¤„ç†å·¥å…·">æ‰¹é‡æ–‡ä»¶å¤„ç†å·¥å…·
</h4><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Sub BatchFileProcessor()
</span></span><span class="line"><span class="cl">    Dim fd As FileDialog
</span></span><span class="line"><span class="cl">    Dim i As Integer
</span></span><span class="line"><span class="cl">    Dim filePaths As Variant
</span></span><span class="line"><span class="cl">    Dim outputPath As String
</span></span><span class="line"><span class="cl">    Dim wsReport As Worksheet
</span></span><span class="line"><span class="cl">    Dim rowNum As Long
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; é€‰æ‹©è¦å¤„ç†çš„å¤šä¸ªæ–‡ä»¶
</span></span><span class="line"><span class="cl">    Set fd = Application.FileDialog(msoFileDialogFilePicker)
</span></span><span class="line"><span class="cl">    With fd
</span></span><span class="line"><span class="cl">        .Title = &#34;é€‰æ‹©è¦å¤„ç†çš„æ–‡æœ¬æ–‡ä»¶&#34;
</span></span><span class="line"><span class="cl">        .Filters.Clear
</span></span><span class="line"><span class="cl">        .Filters.Add &#34;æ–‡æœ¬æ–‡ä»¶&#34;, &#34;*.txt&#34;
</span></span><span class="line"><span class="cl">        .AllowMultiSelect = True
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        If .Show &lt;&gt; -1 Then
</span></span><span class="line"><span class="cl">            MsgBox &#34;æœªé€‰æ‹©ä»»ä½•æ–‡ä»¶ï¼Œæ“ä½œå·²å–æ¶ˆ&#34;, vbInformation
</span></span><span class="line"><span class="cl">            Exit Sub
</span></span><span class="line"><span class="cl">        End If
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        filePaths = .SelectedItems
</span></span><span class="line"><span class="cl">    End With
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; é€‰æ‹©ä¿å­˜ç»“æœçš„æ–‡ä»¶å¤¹
</span></span><span class="line"><span class="cl">    Set fd = Application.FileDialog(msoFileDialogFolderPicker)
</span></span><span class="line"><span class="cl">    With fd
</span></span><span class="line"><span class="cl">        .Title = &#34;é€‰æ‹©ç»“æœä¿å­˜æ–‡ä»¶å¤¹&#34;
</span></span><span class="line"><span class="cl">        .InitialFileName = ThisWorkbook.Path
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        If .Show &lt;&gt; -1 Then
</span></span><span class="line"><span class="cl">            MsgBox &#34;æœªé€‰æ‹©ä¿å­˜æ–‡ä»¶å¤¹ï¼Œæ“ä½œå·²å–æ¶ˆ&#34;, vbInformation
</span></span><span class="line"><span class="cl">            Exit Sub
</span></span><span class="line"><span class="cl">        End If
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        outputPath = .SelectedItems(1)
</span></span><span class="line"><span class="cl">    End With
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; åˆ›å»ºæŠ¥å‘Šå·¥ä½œè¡¨
</span></span><span class="line"><span class="cl">    Set wsReport = ThisWorkbook.Sheets.Add
</span></span><span class="line"><span class="cl">    wsReport.Name = &#34;æ‰¹é‡å¤„ç†æŠ¥å‘Š&#34;
</span></span><span class="line"><span class="cl">    wsReport.Cells(1, 1).Value = &#34;åŸå§‹æ–‡ä»¶&#34;
</span></span><span class="line"><span class="cl">    wsReport.Cells(1, 2).Value = &#34;å¤„ç†åæ–‡ä»¶&#34;
</span></span><span class="line"><span class="cl">    wsReport.Cells(1, 3).Value = &#34;çŠ¶æ€&#34;
</span></span><span class="line"><span class="cl">    wsReport.Cells(1, 4).Value = &#34;å¤„ç†æ—¶é—´&#34;
</span></span><span class="line"><span class="cl">    wsReport.Rows(1).Font.Bold = True
</span></span><span class="line"><span class="cl">    rowNum = 2
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; å¤„ç†æ¯ä¸ªé€‰ä¸­çš„æ–‡ä»¶
</span></span><span class="line"><span class="cl">    For i = LBound(filePaths) To UBound(filePaths)
</span></span><span class="line"><span class="cl">        wsReport.Cells(rowNum, 1).Value = filePaths(i)
</span></span><span class="line"><span class="cl">        wsReport.Cells(rowNum, 4).Value = Now()
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        On Error Resume Next
</span></span><span class="line"><span class="cl">        &#39; å¤„ç†æ–‡ä»¶ï¼ˆè¿™é‡Œåªæ˜¯ç¤ºä¾‹ï¼šå¤åˆ¶å¹¶æ·»åŠ å¤„ç†æ ‡è®°ï¼‰
</span></span><span class="line"><span class="cl">        Dim sourceNum As Integer, destNum As Integer
</span></span><span class="line"><span class="cl">        Dim content As String
</span></span><span class="line"><span class="cl">        Dim fileName As String
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        &#39; è·å–æ–‡ä»¶å
</span></span><span class="line"><span class="cl">        fileName = Mid(filePaths(i), InStrRev(filePaths(i), &#34;\&#34;) + 1)
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        &#39; è¯»å–æºæ–‡ä»¶
</span></span><span class="line"><span class="cl">        sourceNum = FreeFile
</span></span><span class="line"><span class="cl">        Open filePaths(i) For Input As #sourceNum
</span></span><span class="line"><span class="cl">            content = Input(LOF(sourceNum), sourceNum)
</span></span><span class="line"><span class="cl">        Close #sourceNum
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        &#39; å†™å…¥å¤„ç†åçš„æ–‡ä»¶
</span></span><span class="line"><span class="cl">        destNum = FreeFile
</span></span><span class="line"><span class="cl">        Open outputPath &amp; &#34;\&#34; &amp; Replace(fileName, &#34;.txt&#34;, &#34;_processed.txt&#34;) For Output As #destNum
</span></span><span class="line"><span class="cl">            Print #destNum, &#34;=== å¤„ç†äº &#34; &amp; Now() &amp; &#34; ===&#34; &amp; vbCrLf
</span></span><span class="line"><span class="cl">            Print #destNum, content
</span></span><span class="line"><span class="cl">        Close #destNum
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        &#39; è®°å½•ç»“æœ
</span></span><span class="line"><span class="cl">        If Err.Number = 0 Then
</span></span><span class="line"><span class="cl">            wsReport.Cells(rowNum, 2).Value = outputPath &amp; &#34;\&#34; &amp; Replace(fileName, &#34;.txt&#34;, &#34;_processed.txt&#34;)
</span></span><span class="line"><span class="cl">            wsReport.Cells(rowNum, 3).Value = &#34;æˆåŠŸ&#34;
</span></span><span class="line"><span class="cl">        Else
</span></span><span class="line"><span class="cl">            wsReport.Cells(rowNum, 3).Value = &#34;å¤±è´¥: &#34; &amp; Err.Description
</span></span><span class="line"><span class="cl">        End If
</span></span><span class="line"><span class="cl">        On Error GoTo 0
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        rowNum = rowNum + 1
</span></span><span class="line"><span class="cl">    Next i
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    wsReport.Columns(&#34;A:D&#34;).AutoFit
</span></span><span class="line"><span class="cl">    MsgBox &#34;æ‰¹é‡å¤„ç†å®Œæˆï¼Œå…±å¤„ç† &#34; &amp; UBound(filePaths) - LBound(filePaths) + 1 &amp; &#34; ä¸ªæ–‡ä»¶&#34;, vbInformation
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    Set fd = Nothing
</span></span><span class="line"><span class="cl">End Sub
</span></span></code></pre></div><h4 id="filedialogä¸ä¼ ç»Ÿæ–‡ä»¶æ“ä½œå¯¹æ¯”">FileDialogä¸ä¼ ç»Ÿæ–‡ä»¶æ“ä½œå¯¹æ¯”
</h4><div class="table-wrapper"><table>
  <thead>
      <tr>
          <th>ç‰¹æ€§</th>
          <th>ä¼ ç»Ÿæ–‡ä»¶æ“ä½œï¼ˆOpenè¯­å¥ï¼‰</th>
          <th>FileDialog</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>ç”¨æˆ·äº¤äº’</td>
          <td>éœ€è¦æ‰‹åŠ¨è¾“å…¥è·¯å¾„ï¼Œä¸ç›´è§‚</td>
          <td>å›¾å½¢ç•Œé¢é€‰æ‹©ï¼Œç›´è§‚å‹å¥½</td>
      </tr>
      <tr>
          <td>è·¯å¾„å‡†ç¡®æ€§</td>
          <td>å®¹æ˜“è¾“å…¥é”™è¯¯è·¯å¾„</td>
          <td>é¿å…æ‰‹åŠ¨è¾“å…¥é”™è¯¯</td>
      </tr>
      <tr>
          <td>æ–‡ä»¶ç­›é€‰</td>
          <td>éœ€è¦æ‰‹åŠ¨éªŒè¯æ–‡ä»¶ç±»å‹</td>
          <td>å†…ç½®ç­›é€‰åŠŸèƒ½</td>
      </tr>
      <tr>
          <td>å¤šæ–‡ä»¶å¤„ç†</td>
          <td>éœ€è¦æ‰‹åŠ¨è¾“å…¥å¤šä¸ªè·¯å¾„</td>
          <td>æ”¯æŒä¸€æ¬¡æ€§é€‰æ‹©å¤šä¸ªæ–‡ä»¶</td>
      </tr>
      <tr>
          <td>æ–‡ä»¶å¤¹é€‰æ‹©</td>
          <td>éœ€è¦æ‰‹åŠ¨è¾“å…¥æ–‡ä»¶å¤¹è·¯å¾„</td>
          <td>ç›´è§‚çš„æ–‡ä»¶å¤¹æµè§ˆé€‰æ‹©</td>
      </tr>
      <tr>
          <td>ä½¿ç”¨å¤æ‚åº¦</td>
          <td>ç®€å•ï¼Œé€‚åˆå›ºå®šè·¯å¾„</td>
          <td>ç¨å¤æ‚ï¼Œä½†æ›´çµæ´»</td>
      </tr>
      <tr>
          <td>é€‚ç”¨åœºæ™¯</td>
          <td>è·¯å¾„å›ºå®šçš„è‡ªåŠ¨åŒ–ä»»åŠ¡</td>
          <td>éœ€è¦ç”¨æˆ·äº¤äº’çš„åœºæ™¯</td>
      </tr>
  </tbody>
</table></div>
<h2 id="inputboxå‡½æ•°">InputBoxå‡½æ•°
</h2><p>InputBoxå‡½æ•°å¯ä»¥åˆ›å»ºä¸€ä¸ªç®€å•çš„å¯¹è¯æ¡†ï¼Œè¾“å…¥æ–‡æœ¬æˆ–æ•°å€¼ã€‚</p>
<h3 id="inputboxåŸºç¡€ç”¨æ³•">InputBoxåŸºç¡€ç”¨æ³•
</h3><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Sub BasicInputBox()
</span></span><span class="line"><span class="cl">    Dim userName As String
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; åŸºæœ¬ç”¨æ³•
</span></span><span class="line"><span class="cl">    userName = InputBox(&#34;è¯·è¾“å…¥æ‚¨çš„å§“å:&#34;, &#34;è¾“å…¥å§“å&#34;)
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; æ£€æŸ¥ç”¨æˆ·è¾“å…¥
</span></span><span class="line"><span class="cl">    If userName = &#34;&#34; Then
</span></span><span class="line"><span class="cl">        MsgBox &#34;æ‚¨æ²¡æœ‰è¾“å…¥å§“å&#34;, vbInformation
</span></span><span class="line"><span class="cl">    Else
</span></span><span class="line"><span class="cl">        MsgBox &#34;æ‚¨å¥½ï¼Œ&#34; &amp; userName &amp; &#34;ï¼&#34;, vbWelcomeMsg
</span></span><span class="line"><span class="cl">    End If
</span></span><span class="line"><span class="cl">End Sub
</span></span></code></pre></div><h3 id="inputboxçš„å®Œæ•´å‚æ•°">InputBoxçš„å®Œæ•´å‚æ•°
</h3><p>InputBoxå‡½æ•°çš„å®Œæ•´è¯­æ³•ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">InputBox(prompt, [title], [default], [xpos], [ypos], [helpfile], [context])
</span></span></code></pre></div><p>å‚æ•°è¯´æ˜ï¼š</p>
<ul>
<li><code>prompt</code>ï¼šå¿…éœ€ï¼Œæ˜¾ç¤ºåœ¨å¯¹è¯æ¡†ä¸­çš„æç¤ºä¿¡æ¯</li>
<li><code>title</code>ï¼šå¯é€‰ï¼Œå¯¹è¯æ¡†çš„æ ‡é¢˜</li>
<li><code>default</code>ï¼šå¯é€‰ï¼Œè¾“å…¥æ¡†ä¸­çš„é»˜è®¤å€¼</li>
<li><code>xpos</code>ï¼šå¯é€‰ï¼Œå¯¹è¯æ¡†çš„æ°´å¹³ä½ç½®</li>
<li><code>ypos</code>ï¼šå¯é€‰ï¼Œå¯¹è¯æ¡†çš„å‚ç›´ä½ç½®</li>
<li><code>helpfile</code>ï¼šå¯é€‰ï¼Œå¸®åŠ©æ–‡ä»¶çš„è·¯å¾„</li>
<li><code>context</code>ï¼šå¯é€‰ï¼Œå¸®åŠ©ä¸»é¢˜çš„ä¸Šä¸‹æ–‡ç¼–å·</li>
</ul>
<p>ç¤ºä¾‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Sub InputBoxWithParameters()
</span></span><span class="line"><span class="cl">    Dim ageStr As String
</span></span><span class="line"><span class="cl">    Dim age As Integer
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; ä½¿ç”¨å®Œæ•´å‚æ•°çš„InputBox
</span></span><span class="line"><span class="cl">    ageStr = InputBox( _
</span></span><span class="line"><span class="cl">        prompt:=&#34;è¯·è¾“å…¥æ‚¨çš„å¹´é¾„:&#34;, _
</span></span><span class="line"><span class="cl">        title:=&#34;å¹´é¾„è¾“å…¥&#34;, _
</span></span><span class="line"><span class="cl">        default:=&#34;30&#34;, _
</span></span><span class="line"><span class="cl">        xpos:=Application.Left + 100, _
</span></span><span class="line"><span class="cl">        ypos:=Application.Top + 100 _
</span></span><span class="line"><span class="cl">    )
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; éªŒè¯è¾“å…¥
</span></span><span class="line"><span class="cl">    If ageStr = &#34;&#34; Then
</span></span><span class="line"><span class="cl">        MsgBox &#34;æ‚¨å–æ¶ˆäº†è¾“å…¥&#34;, vbInformation
</span></span><span class="line"><span class="cl">    ElseIf IsNumeric(ageStr) Then
</span></span><span class="line"><span class="cl">        age = CInt(ageStr)
</span></span><span class="line"><span class="cl">        If age &gt; 0 And age &lt; 150 Then
</span></span><span class="line"><span class="cl">            MsgBox &#34;æ‚¨çš„å¹´é¾„æ˜¯: &#34; &amp; age, vbInformation
</span></span><span class="line"><span class="cl">        Else
</span></span><span class="line"><span class="cl">            MsgBox &#34;è¯·è¾“å…¥æœ‰æ•ˆçš„å¹´é¾„&#34;, vbExclamation
</span></span><span class="line"><span class="cl">        End If
</span></span><span class="line"><span class="cl">    Else
</span></span><span class="line"><span class="cl">        MsgBox &#34;è¯·è¾“å…¥æ•°å­—&#34;, vbExclamation
</span></span><span class="line"><span class="cl">    End If
</span></span><span class="line"><span class="cl">End Sub
</span></span></code></pre></div><h3 id="å¸¦å¸®åŠ©åŠŸèƒ½çš„inputbox">å¸¦å¸®åŠ©åŠŸèƒ½çš„InputBox
</h3><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Sub InputBoxWithHelp()
</span></span><span class="line"><span class="cl">    Dim scoreStr As String
</span></span><span class="line"><span class="cl">    Dim helpFile As String
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; è®¾ç½®å¸®åŠ©æ–‡ä»¶è·¯å¾„ï¼ˆå®é™…ä½¿ç”¨æ—¶æ›¿æ¢ä¸ºä½ çš„å¸®åŠ©æ–‡ä»¶ï¼‰
</span></span><span class="line"><span class="cl">    helpFile = &#34;C:\help\score_help.chm&#34;
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; å¸¦å¸®åŠ©æŒ‰é’®çš„InputBox
</span></span><span class="line"><span class="cl">    scoreStr = InputBox( _
</span></span><span class="line"><span class="cl">        prompt:=&#34;è¯·è¾“å…¥è€ƒè¯•åˆ†æ•°(0-100):&#34;, _
</span></span><span class="line"><span class="cl">        title:=&#34;åˆ†æ•°è¾“å…¥&#34;, _
</span></span><span class="line"><span class="cl">        default:=&#34;80&#34;, _
</span></span><span class="line"><span class="cl">        helpfile:=helpFile, _
</span></span><span class="line"><span class="cl">        context:=100 _
</span></span><span class="line"><span class="cl">    )
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; å¤„ç†è¾“å…¥
</span></span><span class="line"><span class="cl">    If scoreStr = &#34;&#34; Then
</span></span><span class="line"><span class="cl">        MsgBox &#34;è¾“å…¥å·²å–æ¶ˆ&#34;, vbInformation
</span></span><span class="line"><span class="cl">    ElseIf IsNumeric(scoreStr) Then
</span></span><span class="line"><span class="cl">        If CDbl(scoreStr) &gt;= 0 And CDbl(scoreStr) &lt;= 100 Then
</span></span><span class="line"><span class="cl">            MsgBox &#34;æ‚¨è¾“å…¥çš„åˆ†æ•°æ˜¯: &#34; &amp; scoreStr, vbInformation
</span></span><span class="line"><span class="cl">        Else
</span></span><span class="line"><span class="cl">            MsgBox &#34;åˆ†æ•°å¿…é¡»åœ¨0-100ä¹‹é—´&#34;, vbExclamation
</span></span><span class="line"><span class="cl">        End If
</span></span><span class="line"><span class="cl">    Else
</span></span><span class="line"><span class="cl">        MsgBox &#34;è¯·è¾“å…¥æœ‰æ•ˆçš„æ•°å­—&#34;, vbExclamation
</span></span><span class="line"><span class="cl">    End If
</span></span><span class="line"><span class="cl">End Sub
</span></span></code></pre></div><h3 id="è¾“å…¥éªŒè¯ä¸å¾ªç¯">è¾“å…¥éªŒè¯ä¸å¾ªç¯
</h3><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Sub InputBoxWithValidation()
</span></span><span class="line"><span class="cl">    Dim quantityStr As String
</span></span><span class="line"><span class="cl">    Dim quantity As Integer
</span></span><span class="line"><span class="cl">    Dim isValid As Boolean
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    isValid = False
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; å¾ªç¯ç›´åˆ°è·å¾—æœ‰æ•ˆè¾“å…¥
</span></span><span class="line"><span class="cl">    Do While Not isValid
</span></span><span class="line"><span class="cl">        quantityStr = InputBox( _
</span></span><span class="line"><span class="cl">            prompt:=&#34;è¯·è¾“å…¥è®¢è´­æ•°é‡(1-100):&#34; &amp; vbCrLf &amp; _
</span></span><span class="line"><span class="cl">                    &#34;å¿…é¡»æ˜¯1åˆ°100ä¹‹é—´çš„æ•´æ•°&#34;, _
</span></span><span class="line"><span class="cl">            title:=&#34;æ•°é‡è¾“å…¥&#34;, _
</span></span><span class="line"><span class="cl">            default:=&#34;10&#34; _
</span></span><span class="line"><span class="cl">        )
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        &#39; æ£€æŸ¥æ˜¯å¦å–æ¶ˆ
</span></span><span class="line"><span class="cl">        If quantityStr = &#34;&#34; Then
</span></span><span class="line"><span class="cl">            MsgBox &#34;å·²å–æ¶ˆæ“ä½œ&#34;, vbInformation
</span></span><span class="line"><span class="cl">            Exit Sub
</span></span><span class="line"><span class="cl">        End If
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        &#39; éªŒè¯è¾“å…¥
</span></span><span class="line"><span class="cl">        If IsNumeric(quantityStr) Then
</span></span><span class="line"><span class="cl">            quantity = CInt(quantityStr)
</span></span><span class="line"><span class="cl">            If quantity &gt;= 1 And quantity &lt;= 100 Then
</span></span><span class="line"><span class="cl">                isValid = True &#39; æœ‰æ•ˆè¾“å…¥ï¼Œé€€å‡ºå¾ªç¯
</span></span><span class="line"><span class="cl">            Else
</span></span><span class="line"><span class="cl">                MsgBox &#34;æ•°é‡å¿…é¡»åœ¨1åˆ°100ä¹‹é—´&#34;, vbExclamation
</span></span><span class="line"><span class="cl">            End If
</span></span><span class="line"><span class="cl">        Else
</span></span><span class="line"><span class="cl">            MsgBox &#34;è¯·è¾“å…¥æœ‰æ•ˆçš„æ•°å­—&#34;, vbExclamation
</span></span><span class="line"><span class="cl">        End If
</span></span><span class="line"><span class="cl">    Loop
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; å¤„ç†æœ‰æ•ˆè¾“å…¥
</span></span><span class="line"><span class="cl">    MsgBox &#34;æ‚¨å·²è®¢è´­ &#34; &amp; quantity &amp; &#34; ä»¶å•†å“&#34;, vbInformation
</span></span><span class="line"><span class="cl">End Sub
</span></span></code></pre></div><h3 id="ç»“åˆæ–‡ä»¶æ“ä½œçš„inputboxåº”ç”¨">ç»“åˆæ–‡ä»¶æ“ä½œçš„InputBoxåº”ç”¨
</h3><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Sub InputBoxAndFileOperation()
</span></span><span class="line"><span class="cl">    Dim filePath As String
</span></span><span class="line"><span class="cl">    Dim fileNumber As Integer
</span></span><span class="line"><span class="cl">    Dim userInput As String
</span></span><span class="line"><span class="cl">    Dim i As Integer
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; ä½¿ç”¨InputBoxè·å–æ–‡ä»¶è·¯å¾„
</span></span><span class="line"><span class="cl">    filePath = InputBox( _
</span></span><span class="line"><span class="cl">        prompt:=&#34;è¯·è¾“å…¥è¦ä¿å­˜çš„æ–‡ä»¶è·¯å¾„å’Œåç§°:&#34; &amp; vbCrLf &amp; _
</span></span><span class="line"><span class="cl">                &#34;ä¾‹å¦‚: C:\data\mynotes.txt&#34;, _
</span></span><span class="line"><span class="cl">        title:=&#34;ä¿å­˜æ–‡ä»¶&#34;, _
</span></span><span class="line"><span class="cl">        default:=&#34;C:\data\notes.txt&#34; _
</span></span><span class="line"><span class="cl">    )
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; æ£€æŸ¥ç”¨æˆ·æ˜¯å¦å–æ¶ˆ
</span></span><span class="line"><span class="cl">    If filePath = &#34;&#34; Then
</span></span><span class="line"><span class="cl">        MsgBox &#34;æ“ä½œå·²å–æ¶ˆ&#34;, vbInformation
</span></span><span class="line"><span class="cl">        Exit Sub
</span></span><span class="line"><span class="cl">    End If
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; ä½¿ç”¨InputBoxè·å–è¦ä¿å­˜çš„å†…å®¹
</span></span><span class="line"><span class="cl">    userInput = InputBox( _
</span></span><span class="line"><span class="cl">        prompt:=&#34;è¯·è¾“å…¥è¦ä¿å­˜çš„å†…å®¹:&#34;, _
</span></span><span class="line"><span class="cl">        title:=&#34;è¾“å…¥å†…å®¹&#34; _
</span></span><span class="line"><span class="cl">    )
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    If userInput = &#34;&#34; Then
</span></span><span class="line"><span class="cl">        MsgBox &#34;æ²¡æœ‰è¾“å…¥å†…å®¹ï¼Œæ–‡ä»¶æœªä¿å­˜&#34;, vbInformation
</span></span><span class="line"><span class="cl">        Exit Sub
</span></span><span class="line"><span class="cl">    End If
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; ä¿å­˜åˆ°æ–‡ä»¶
</span></span><span class="line"><span class="cl">    On Error GoTo ErrorHandler
</span></span><span class="line"><span class="cl">    fileNumber = FreeFile
</span></span><span class="line"><span class="cl">    Open filePath For Output As #fileNumber
</span></span><span class="line"><span class="cl">    Print #fileNumber, &#34;å†…å®¹ä¿å­˜æ—¶é—´: &#34; &amp; Now()
</span></span><span class="line"><span class="cl">    Print #fileNumber, &#34;-------------------------&#34;
</span></span><span class="line"><span class="cl">    Print #fileNumber, userInput
</span></span><span class="line"><span class="cl">    Close #fileNumber
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    MsgBox &#34;å†…å®¹å·²æˆåŠŸä¿å­˜åˆ°:&#34; &amp; vbCrLf &amp; filePath, vbInformation
</span></span><span class="line"><span class="cl">    Exit Sub
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">ErrorHandler:
</span></span><span class="line"><span class="cl">    MsgBox &#34;ä¿å­˜æ–‡ä»¶æ—¶å‡ºé”™: &#34; &amp; Err.Description, vbCritical
</span></span><span class="line"><span class="cl">    On Error Resume Next
</span></span><span class="line"><span class="cl">    Close #fileNumber
</span></span><span class="line"><span class="cl">End Sub
</span></span></code></pre></div><h3 id="å¤šæ­¥éª¤è¾“å…¥æµç¨‹">å¤šæ­¥éª¤è¾“å…¥æµç¨‹
</h3><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Sub MultiStepInput()
</span></span><span class="line"><span class="cl">    Dim customerInfo(1 To 4) As String
</span></span><span class="line"><span class="cl">    Dim fields(1 To 4) As String
</span></span><span class="line"><span class="cl">    Dim i As Integer
</span></span><span class="line"><span class="cl">    Dim filePath As String
</span></span><span class="line"><span class="cl">    Dim fileNumber As Integer
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; å®šä¹‰è¦æ”¶é›†çš„å­—æ®µ
</span></span><span class="line"><span class="cl">    fields(1) = &#34;å®¢æˆ·å§“å&#34;
</span></span><span class="line"><span class="cl">    fields(2) = &#34;è”ç³»ç”µè¯&#34;
</span></span><span class="line"><span class="cl">    fields(3) = &#34;åœ°å€&#34;
</span></span><span class="line"><span class="cl">    fields(4) = &#34;è®¢å•é‡‘é¢&#34;
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; åˆ†æ­¥æ”¶é›†ä¿¡æ¯
</span></span><span class="line"><span class="cl">    For i = 1 To 4
</span></span><span class="line"><span class="cl">        customerInfo(i) = InputBox( _
</span></span><span class="line"><span class="cl">            prompt:=&#34;è¯·è¾“å…¥&#34; &amp; fields(i) &amp; &#34;:&#34;, _
</span></span><span class="line"><span class="cl">            title:=&#34;è¾“å…¥å®¢æˆ·ä¿¡æ¯ (&#34; &amp; i &amp; &#34;/4)&#34;, _
</span></span><span class="line"><span class="cl">            default:=&#34;&#34; _
</span></span><span class="line"><span class="cl">        )
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        &#39; æ£€æŸ¥æ˜¯å¦å–æ¶ˆ
</span></span><span class="line"><span class="cl">        If customerInfo(i) = &#34;&#34; Then
</span></span><span class="line"><span class="cl">            If MsgBox(&#34;ç¡®å®šè¦å–æ¶ˆè¾“å…¥å—?&#34;, vbYesNo + vbQuestion) = vbYes Then
</span></span><span class="line"><span class="cl">                MsgBox &#34;å·²å–æ¶ˆå®¢æˆ·ä¿¡æ¯è¾“å…¥&#34;, vbInformation
</span></span><span class="line"><span class="cl">                Exit Sub
</span></span><span class="line"><span class="cl">            Else
</span></span><span class="line"><span class="cl">                &#39; é‡æ–°è·å–å½“å‰å­—æ®µ
</span></span><span class="line"><span class="cl">                i = i - 1 &#39; å› ä¸ºå¾ªç¯ä¼šè‡ªåŠ¨+1ï¼Œæ‰€ä»¥è¿™é‡Œ-1
</span></span><span class="line"><span class="cl">            End If
</span></span><span class="line"><span class="cl">        End If
</span></span><span class="line"><span class="cl">    Next i
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; æ˜¾ç¤ºæ”¶é›†çš„ä¿¡æ¯
</span></span><span class="line"><span class="cl">    Dim summary As String
</span></span><span class="line"><span class="cl">    summary = &#34;æ”¶é›†çš„å®¢æˆ·ä¿¡æ¯å¦‚ä¸‹:&#34; &amp; vbCrLf
</span></span><span class="line"><span class="cl">    For i = 1 To 4
</span></span><span class="line"><span class="cl">        summary = summary &amp; fields(i) &amp; &#34;: &#34; &amp; customerInfo(i) &amp; vbCrLf
</span></span><span class="line"><span class="cl">    Next i
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; è¯¢é—®æ˜¯å¦ä¿å­˜
</span></span><span class="line"><span class="cl">    If MsgBox(summary &amp; vbCrLf &amp; &#34;æ˜¯å¦ä¿å­˜è¿™äº›ä¿¡æ¯?&#34;, vbYesNo + vbQuestion) = vbYes Then
</span></span><span class="line"><span class="cl">        filePath = &#34;C:\data\customers\&#34; &amp; Format(Now(), &#34;yyyymmdd_hhnnss&#34;) &amp; &#34;.txt&#34;
</span></span><span class="line"><span class="cl">        fileNumber = FreeFile
</span></span><span class="line"><span class="cl">        Open filePath For Output As #fileNumber
</span></span><span class="line"><span class="cl">        Print #fileNumber, summary
</span></span><span class="line"><span class="cl">        Close #fileNumber
</span></span><span class="line"><span class="cl">        MsgBox &#34;ä¿¡æ¯å·²ä¿å­˜åˆ°: &#34; &amp; filePath, vbInformation
</span></span><span class="line"><span class="cl">    End If
</span></span><span class="line"><span class="cl">End Sub
</span></span></code></pre></div><h2 id="ç»¼åˆæ¡ˆä¾‹æ–‡ä»¶ç®¡ç†å·¥å…·">ç»¼åˆæ¡ˆä¾‹ï¼šæ–‡ä»¶ç®¡ç†å·¥å…·
</h2><p>ä¸‹é¢æ˜¯ä¸€ä¸ªç»“åˆæ–‡ä»¶æ“ä½œå’ŒInputBoxçš„ç»¼åˆæ¡ˆä¾‹ï¼Œå®ç°ä¸€ä¸ªç®€å•çš„æ–‡ä»¶ç®¡ç†å·¥å…·ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Sub FileManagerTool()
</span></span><span class="line"><span class="cl">    Dim choice As Integer
</span></span><span class="line"><span class="cl">    Dim running As Boolean
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    running = True
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; ä¸»å¾ªç¯
</span></span><span class="line"><span class="cl">    Do While running
</span></span><span class="line"><span class="cl">        &#39; æ˜¾ç¤ºèœå•
</span></span><span class="line"><span class="cl">        choice = MsgBox( _
</span></span><span class="line"><span class="cl">            &#34;æ–‡ä»¶ç®¡ç†å·¥å…·&#34; &amp; vbCrLf &amp; vbCrLf &amp; _
</span></span><span class="line"><span class="cl">            &#34;1. è¯»å–æ–‡æœ¬æ–‡ä»¶&#34; &amp; vbCrLf &amp; _
</span></span><span class="line"><span class="cl">            &#34;2. åˆ›å»ºæ–°æ–‡ä»¶&#34; &amp; vbCrLf &amp; _
</span></span><span class="line"><span class="cl">            &#34;3. è¿½åŠ åˆ°æ–‡ä»¶&#34; &amp; vbCrLf &amp; _
</span></span><span class="line"><span class="cl">            &#34;4. æ‰¹é‡é‡å‘½åæ–‡ä»¶&#34; &amp; vbCrLf &amp; _
</span></span><span class="line"><span class="cl">            &#34;5. é€€å‡º&#34;, _
</span></span><span class="line"><span class="cl">            vbYesNoCancel + vbQuestion + vbSystemModal, _
</span></span><span class="line"><span class="cl">            &#34;æ–‡ä»¶ç®¡ç†å·¥å…·&#34; _
</span></span><span class="line"><span class="cl">        )
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        &#39; æ ¹æ®ç”¨æˆ·é€‰æ‹©æ‰§è¡Œç›¸åº”åŠŸèƒ½
</span></span><span class="line"><span class="cl">        Select Case choice
</span></span><span class="line"><span class="cl">            Case vbYes: ReadTextFileTool &#39; è¯»å–æ–‡æœ¬æ–‡ä»¶
</span></span><span class="line"><span class="cl">            Case vbNo: CreateNewFileTool &#39; åˆ›å»ºæ–°æ–‡ä»¶
</span></span><span class="line"><span class="cl">            Case vbCancel: AppendToFileTool &#39; è¿½åŠ åˆ°æ–‡ä»¶
</span></span><span class="line"><span class="cl">            &#39; å¯ä»¥åœ¨è¿™é‡Œæ·»åŠ å…¶ä»–åŠŸèƒ½çš„è°ƒç”¨
</span></span><span class="line"><span class="cl">            Case Else: running = False &#39; é€€å‡º
</span></span><span class="line"><span class="cl">        End Select
</span></span><span class="line"><span class="cl">    Loop
</span></span><span class="line"><span class="cl">End Sub
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">&#39; è¯»å–æ–‡æœ¬æ–‡ä»¶å·¥å…·
</span></span><span class="line"><span class="cl">Sub ReadTextFileTool()
</span></span><span class="line"><span class="cl">    Dim filePath As String
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; è·å–æ–‡ä»¶è·¯å¾„
</span></span><span class="line"><span class="cl">    filePath = InputBox( _
</span></span><span class="line"><span class="cl">        &#34;è¯·è¾“å…¥è¦è¯»å–çš„æ–‡æœ¬æ–‡ä»¶è·¯å¾„:&#34;, _
</span></span><span class="line"><span class="cl">        &#34;è¯»å–æ–‡ä»¶&#34;, _
</span></span><span class="line"><span class="cl">        &#34;C:\data\example.txt&#34; _
</span></span><span class="line"><span class="cl">    )
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    If filePath = &#34;&#34; Then Exit Sub
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨
</span></span><span class="line"><span class="cl">    If Dir(filePath) = &#34;&#34; Then
</span></span><span class="line"><span class="cl">        MsgBox &#34;æ–‡ä»¶ä¸å­˜åœ¨: &#34; &amp; filePath, vbExclamation
</span></span><span class="line"><span class="cl">        Exit Sub
</span></span><span class="line"><span class="cl">    End If
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; è¯»å–å¹¶æ˜¾ç¤ºæ–‡ä»¶å†…å®¹
</span></span><span class="line"><span class="cl">    Dim fileNumber As Integer
</span></span><span class="line"><span class="cl">    Dim content As String
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    fileNumber = FreeFile
</span></span><span class="line"><span class="cl">    Open filePath For Input As #fileNumber
</span></span><span class="line"><span class="cl">    content = Input(LOF(fileNumber), fileNumber)
</span></span><span class="line"><span class="cl">    Close #fileNumber
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; åˆ›å»ºæ˜¾ç¤ºå†…å®¹çš„å·¥ä½œè¡¨
</span></span><span class="line"><span class="cl">    Dim ws As Worksheet
</span></span><span class="line"><span class="cl">    On Error Resume Next
</span></span><span class="line"><span class="cl">    Set ws = ThisWorkbook.Sheets(&#34;æ–‡ä»¶å†…å®¹&#34;)
</span></span><span class="line"><span class="cl">    On Error GoTo 0
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    If ws Is Nothing Then
</span></span><span class="line"><span class="cl">        Set ws = ThisWorkbook.Sheets.Add
</span></span><span class="line"><span class="cl">        ws.Name = &#34;æ–‡ä»¶å†…å®¹&#34;
</span></span><span class="line"><span class="cl">    Else
</span></span><span class="line"><span class="cl">        ws.Cells.Clear
</span></span><span class="line"><span class="cl">    End If
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; æ˜¾ç¤ºæ–‡ä»¶ä¿¡æ¯å’Œå†…å®¹
</span></span><span class="line"><span class="cl">    ws.Cells(1, 1).Value = &#34;æ–‡ä»¶è·¯å¾„:&#34;
</span></span><span class="line"><span class="cl">    ws.Cells(1, 2).Value = filePath
</span></span><span class="line"><span class="cl">    ws.Cells(2, 1).Value = &#34;æ–‡ä»¶å¤§å°:&#34;
</span></span><span class="line"><span class="cl">    ws.Cells(2, 2).Value = FileLen(filePath) &amp; &#34; å­—èŠ‚&#34;
</span></span><span class="line"><span class="cl">    ws.Cells(3, 1).Value = &#34;ä¿®æ”¹æ—¶é—´:&#34;
</span></span><span class="line"><span class="cl">    ws.Cells(3, 2).Value = FileDateTime(filePath)
</span></span><span class="line"><span class="cl">    ws.Cells(5, 1).Value = &#34;æ–‡ä»¶å†…å®¹:&#34;
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; å°†å†…å®¹æŒ‰è¡Œæ‹†åˆ†
</span></span><span class="line"><span class="cl">    Dim lines() As String
</span></span><span class="line"><span class="cl">    lines = Split(content, vbCrLf)
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; å†™å…¥å†…å®¹åˆ°å·¥ä½œè¡¨
</span></span><span class="line"><span class="cl">    Dim i As Integer
</span></span><span class="line"><span class="cl">    For i = 0 To UBound(lines)
</span></span><span class="line"><span class="cl">        ws.Cells(6 + i, 1).Value = lines(i)
</span></span><span class="line"><span class="cl">    Next i
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; æ ¼å¼åŒ–å·¥ä½œè¡¨
</span></span><span class="line"><span class="cl">    ws.Columns(&#34;A:A&#34;).ColumnWidth = 50
</span></span><span class="line"><span class="cl">    ws.Rows(&#34;1:3&#34;).Font.Bold = True
</span></span><span class="line"><span class="cl">    ws.Range(&#34;A5&#34;).Font.Bold = True
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    MsgBox &#34;æ–‡ä»¶å†…å®¹å·²æ˜¾ç¤ºåœ¨ &#34;&#34;æ–‡ä»¶å†…å®¹&#34;&#34; å·¥ä½œè¡¨ä¸­&#34;, vbInformation
</span></span><span class="line"><span class="cl">End Sub
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">&#39; åˆ›å»ºæ–°æ–‡ä»¶å·¥å…·
</span></span><span class="line"><span class="cl">Sub CreateNewFileTool()
</span></span><span class="line"><span class="cl">    Dim filePath As String
</span></span><span class="line"><span class="cl">    Dim content As String
</span></span><span class="line"><span class="cl">    Dim fileNumber As Integer
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; è·å–æ–‡ä»¶è·¯å¾„
</span></span><span class="line"><span class="cl">    filePath = InputBox( _
</span></span><span class="line"><span class="cl">        &#34;è¯·è¾“å…¥è¦åˆ›å»ºçš„æ–‡ä»¶è·¯å¾„å’Œåç§°:&#34;, _
</span></span><span class="line"><span class="cl">        &#34;åˆ›å»ºæ–°æ–‡ä»¶&#34;, _
</span></span><span class="line"><span class="cl">        &#34;C:\data\newfile.txt&#34; _
</span></span><span class="line"><span class="cl">    )
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    If filePath = &#34;&#34; Then Exit Sub
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å·²å­˜åœ¨
</span></span><span class="line"><span class="cl">    If Dir(filePath) &lt;&gt; &#34;&#34; Then
</span></span><span class="line"><span class="cl">        If MsgBox(&#34;æ–‡ä»¶å·²å­˜åœ¨ï¼Œæ˜¯å¦è¦†ç›–?&#34;, vbYesNo + vbQuestion) = vbNo Then
</span></span><span class="line"><span class="cl">            Exit Sub
</span></span><span class="line"><span class="cl">        End If
</span></span><span class="line"><span class="cl">    End If
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; è·å–æ–‡ä»¶å†…å®¹
</span></span><span class="line"><span class="cl">    content = InputBox( _
</span></span><span class="line"><span class="cl">        &#34;è¯·è¾“å…¥æ–‡ä»¶å†…å®¹:&#34;, _
</span></span><span class="line"><span class="cl">        &#34;è¾“å…¥å†…å®¹&#34; _
</span></span><span class="line"><span class="cl">    )
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    If content = &#34;&#34; Then
</span></span><span class="line"><span class="cl">        If MsgBox(&#34;å†…å®¹ä¸ºç©ºï¼Œä»è¦åˆ›å»ºæ–‡ä»¶å—?&#34;, vbYesNo + vbQuestion) = vbNo Then
</span></span><span class="line"><span class="cl">            Exit Sub
</span></span><span class="line"><span class="cl">        End If
</span></span><span class="line"><span class="cl">    End If
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; åˆ›å»ºæ–‡ä»¶å¹¶å†™å…¥å†…å®¹
</span></span><span class="line"><span class="cl">    On Error GoTo ErrorHandler
</span></span><span class="line"><span class="cl">    fileNumber = FreeFile
</span></span><span class="line"><span class="cl">    Open filePath For Output As #fileNumber
</span></span><span class="line"><span class="cl">    Print #fileNumber, content
</span></span><span class="line"><span class="cl">    Close #fileNumber
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    MsgBox &#34;æ–‡ä»¶å·²åˆ›å»º: &#34; &amp; filePath, vbInformation
</span></span><span class="line"><span class="cl">    Exit Sub
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">ErrorHandler:
</span></span><span class="line"><span class="cl">    MsgBox &#34;åˆ›å»ºæ–‡ä»¶å¤±è´¥: &#34; &amp; Err.Description, vbCritical
</span></span><span class="line"><span class="cl">    On Error Resume Next
</span></span><span class="line"><span class="cl">    Close #fileNumber
</span></span><span class="line"><span class="cl">End Sub
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">&#39; è¿½åŠ åˆ°æ–‡ä»¶å·¥å…·
</span></span><span class="line"><span class="cl">Sub AppendToFileTool()
</span></span><span class="line"><span class="cl">    Dim filePath As String
</span></span><span class="line"><span class="cl">    Dim content As String
</span></span><span class="line"><span class="cl">    Dim fileNumber As Integer
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; è·å–æ–‡ä»¶è·¯å¾„
</span></span><span class="line"><span class="cl">    filePath = InputBox( _
</span></span><span class="line"><span class="cl">        &#34;è¯·è¾“å…¥è¦è¿½åŠ å†…å®¹çš„æ–‡ä»¶è·¯å¾„:&#34;, _
</span></span><span class="line"><span class="cl">        &#34;è¿½åŠ åˆ°æ–‡ä»¶&#34;, _
</span></span><span class="line"><span class="cl">        &#34;C:\data\log.txt&#34; _
</span></span><span class="line"><span class="cl">    )
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    If filePath = &#34;&#34; Then Exit Sub
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨
</span></span><span class="line"><span class="cl">    If Dir(filePath) = &#34;&#34; Then
</span></span><span class="line"><span class="cl">        If MsgBox(&#34;æ–‡ä»¶ä¸å­˜åœ¨ï¼Œæ˜¯å¦åˆ›å»ºæ–°æ–‡ä»¶?&#34;, vbYesNo + vbQuestion) = vbNo Then
</span></span><span class="line"><span class="cl">            Exit Sub
</span></span><span class="line"><span class="cl">        End If
</span></span><span class="line"><span class="cl">    End If
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; è·å–è¦è¿½åŠ çš„å†…å®¹
</span></span><span class="line"><span class="cl">    content = InputBox( _
</span></span><span class="line"><span class="cl">        &#34;è¯·è¾“å…¥è¦è¿½åŠ çš„å†…å®¹:&#34;, _
</span></span><span class="line"><span class="cl">        &#34;è¾“å…¥å†…å®¹&#34; _
</span></span><span class="line"><span class="cl">    )
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    If content = &#34;&#34; Then
</span></span><span class="line"><span class="cl">        MsgBox &#34;å†…å®¹ä¸ºç©ºï¼Œæœªè¿›è¡Œä»»ä½•æ“ä½œ&#34;, vbInformation
</span></span><span class="line"><span class="cl">        Exit Sub
</span></span><span class="line"><span class="cl">    End If
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    &#39; è¿½åŠ å†…å®¹
</span></span><span class="line"><span class="cl">    On Error GoTo ErrorHandler
</span></span><span class="line"><span class="cl">    fileNumber = FreeFile
</span></span><span class="line"><span class="cl">    Open filePath For Append As #fileNumber
</span></span><span class="line"><span class="cl">    Print #fileNumber, &#34;[&#34; &amp; Format(Now(), &#34;yyyy-mm-dd hh:nn:ss&#34;) &amp; &#34;] &#34; &amp; content
</span></span><span class="line"><span class="cl">    Close #fileNumber
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    MsgBox &#34;å†…å®¹å·²è¿½åŠ åˆ°æ–‡ä»¶: &#34; &amp; filePath, vbInformation
</span></span><span class="line"><span class="cl">    Exit Sub
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">ErrorHandler:
</span></span><span class="line"><span class="cl">    MsgBox &#34;æ“ä½œå¤±è´¥: &#34; &amp; Err.Description, vbCritical
</span></span><span class="line"><span class="cl">    On Error Resume Next
</span></span><span class="line"><span class="cl">    Close #fileNumber
</span></span><span class="line"><span class="cl">End Sub
</span></span></code></pre></div><h2 id="è¿›é˜¶å­¦ä¹ å»ºè®®">è¿›é˜¶å­¦ä¹ å»ºè®®
</h2><ol>
<li>
<p><strong>æ·±å…¥å­¦ä¹ å¯¹è±¡æ¨¡å‹</strong>ï¼š</p>
<ul>
<li>ç ”ç©¶Excelå¯¹è±¡æ¨¡å‹çš„å±‚æ¬¡ç»“æ„</li>
<li>æŒæ¡Workbookã€Worksheetã€Rangeç­‰æ ¸å¿ƒå¯¹è±¡çš„å±æ€§å’Œæ–¹æ³•</li>
</ul>
</li>
<li>
<p><strong>å­¦ä¹ æ­£åˆ™è¡¨è¾¾å¼</strong>ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&#39; å¼•ç”¨Microsoft VBScript Regular Expressions 5.5
</span></span><span class="line"><span class="cl">Sub RegexDemo()
</span></span><span class="line"><span class="cl">    Dim regEx As New RegExp
</span></span><span class="line"><span class="cl">    regEx.Pattern = &#34;\d{11}&#34; &#39; åŒ¹é…11ä½æ•°å­—ï¼ˆæ‰‹æœºå·ï¼‰
</span></span><span class="line"><span class="cl">    MsgBox regEx.Test(&#34;13800138000&#34;) &#39; è¾“å‡ºTrue
</span></span><span class="line"><span class="cl">End Sub
</span></span></code></pre></div></li>
<li>
<p><strong>å­¦ä¹ å­—å…¸å¯¹è±¡</strong>ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&#39; å¼•ç”¨Microsoft Scripting Runtime
</span></span><span class="line"><span class="cl">Sub DictionaryDemo()
</span></span><span class="line"><span class="cl">    Dim dict As New Dictionary
</span></span><span class="line"><span class="cl">    dict.Add &#34;Name&#34;, &#34;å¼ ä¸‰&#34;
</span></span><span class="line"><span class="cl">    dict.Add &#34;Age&#34;, 30
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    MsgBox dict(&#34;Name&#34;) &#39; è¾“å‡ºï¼šå¼ ä¸‰
</span></span><span class="line"><span class="cl">End Sub
</span></span></code></pre></div></li>
<li>
<p><strong>å­¦ä¹ ç±»æ¨¡å—</strong>ï¼šåˆ›å»ºè‡ªå®šä¹‰å¯¹è±¡ï¼Œæé«˜ä»£ç å¤ç”¨æ€§</p>
</li>
<li>
<p><strong>æ¢ç´¢å…¶ä»–Officeåº”ç”¨</strong>ï¼šå°†VBAçŸ¥è¯†åº”ç”¨åˆ°Wordã€PowerPointã€Outlookç­‰</p>
</li>
</ol>
<h2 id="æ€»ç»“">æ€»ç»“
</h2><p>é€šè¿‡æœ¬æ•™ç¨‹ä¸ºVBAçš„æ ¸å¿ƒè¯­æ³•ã€Excelå¯¹è±¡æ¨¡å‹æ“ä½œåŠå®ç”¨è„šæœ¬ç¼–å†™ã€‚å»ºè®®ä»å½•åˆ¶å®å¼€å§‹ï¼Œé€æ­¥åˆ†æç”Ÿæˆçš„ä»£ç ï¼Œå¹¶å°è¯•ä¿®æ”¹ä»¥æ»¡è¶³å®é™…éœ€æ±‚ã€‚</p>
<blockquote>
<p>æ³¨æ„ï¼šåœ¨è¿è¡Œä»»ä½•VBAä»£ç å‰ï¼Œè¯·å¤‡ä»½é‡è¦æ•°æ®ã€‚å¯¹äºå¤æ‚æ“ä½œï¼Œå»ºè®®å…ˆåœ¨æµ‹è¯•ç¯å¢ƒä¸­éªŒè¯ã€‚</p>
</blockquote>
<h2 id="é™„å½•">é™„å½•
</h2><ol>
<li><strong>å®˜æ–¹æ–‡æ¡£</strong>ï¼š
<ul>
<li><a class="link" href="https://learn.microsoft.com/zh-cn/office/vba/library-reference/concepts/getting-started-with-vba-in-office"  target="_blank" rel="noopener"
    >Microsoft Learn VBAæ•™ç¨‹</a>

   <span style="white-space: nowrap;"><svg width=".7em"
       height=".7em" viewBox="0 0 21 21" xmlns="http://www.w3.org/2000/svg">
       <path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
       <path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
           fill="currentColor">
   </svg></span>
   
    </li>
</ul>
</li>
<li><strong>ä¹¦ç±</strong>ï¼š
<ul>
<li>ã€ŠExcel VBAä»å…¥é—¨åˆ°ç²¾é€šã€‹</li>
<li>ã€ŠVBAç»å…¸åº”ç”¨69ä¾‹ã€‹</li>
</ul>
</li>
<li><strong>ç¤¾åŒºä¸è®ºå›</strong>ï¼š
<ul>
<li><a class="link" href="https://club.excelhome.net/"  target="_blank" rel="noopener"
    >ExcelHomeæŠ€æœ¯è®ºå›</a>

   <span style="white-space: nowrap;"><svg width=".7em"
       height=".7em" viewBox="0 0 21 21" xmlns="http://www.w3.org/2000/svg">
       <path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
       <path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
           fill="currentColor">
   </svg></span>
   
    </li>
<li><a class="link" href="https://stackoverflow.com/questions/tagged/vba"  target="_blank" rel="noopener"
    >Stack Overflow VBAä¸“åŒº</a>

   <span style="white-space: nowrap;"><svg width=".7em"
       height=".7em" viewBox="0 0 21 21" xmlns="http://www.w3.org/2000/svg">
       <path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
       <path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
           fill="currentColor">
   </svg></span>
   
    </li>
</ul>
</li>
</ol>
<h3 id="å‚è€ƒæ–‡ç« ">å‚è€ƒæ–‡ç« 
</h3>
</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="www.allergicrosen.xyz/tags/vba/">VBA</a>
        
            <a href="www.allergicrosen.xyz/tags/%E7%BC%96%E7%A8%8B/">ç¼–ç¨‹</a>
        
    </section>


    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under CC BY-NC-SA 4.0 è½¬è½½è¯·ç•™è¨€å‘ŠçŸ¥</span>
    </section>
    <section class="article-lastmod">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



        <span>
            æœ€åæ›´æ–°äº 2025-10-20 22:30
        </span>
    </section></footer>


    
        <link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css"integrity="sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI&#43;WdtXRGWt2kTvGFasHpSy3SV"crossorigin="anonymous"
            ><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"integrity="sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG&#43;vnGctmUb0ZY0l8"crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"integrity="sha384-&#43;VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4&#43;/RRE05"crossorigin="anonymous"
                defer
                >
            </script><script>
    window.addEventListener("DOMContentLoaded", () => {
        renderMathInElement(document.body, {
            delimiters: [
                { left: "$$", right: "$$", display: true },
                { left: "$", right: "$", display: false },
                { left: "\\(", right: "\\)", display: false },
                { left: "\\[", right: "\\]", display: true }
            ],
            ignoredClasses: ["gist"]
        });})
</script>
    
</article>

    

    

<aside class="related-content--wrapper">
    <h2 class="section-title">ç›¸å…³æ–‡ç« </h2>
    <div class="related-content">
        <div class="flex article-list--tile">
            
                
<article class="">
    <a href="www.allergicrosen.xyz/p/vba_array-and-variable/">
        
        

        <div class="article-details">
            <h2 class="article-title">VBAæ•°ç»„ä¸å˜é‡</h2>
        </div>
    </a>
</article>

            
        </div>
    </div>
</aside>

     
    
        
    <script
    src="https://giscus.app/client.js"
    data-repo="allergicrosen/myblog"
    data-repo-id="R_kgDOM21aPQ"
    data-category="Announcements"
    data-category-id="DIC_kwDOM21aPc4Cn0lU"
    data-mapping="pathname"
    data-strict="0"
    data-reactions-enabled="1"
    data-emit-metadata="0"
    data-input-position="top"
    data-theme="light"
    data-lang="en"
    crossorigin="anonymous"
    async
></script>
<script>
    function setGiscusTheme(theme) {
        let giscus = document.querySelector("iframe.giscus-frame");
        if (giscus) {
            giscus.contentWindow.postMessage(
                {
                    giscus: {
                        setConfig: {
                            theme: theme,
                        },
                    },
                },
                "https://giscus.app"
            );
        }
    }

    (function () {
        addEventListener("message", (e) => {
            if (event.origin !== "https://giscus.app") return;
            handler();
        });
        window.addEventListener("onColorSchemeChange", handler);

        function handler() {
            if (document.documentElement.dataset.scheme === "light") {
                setGiscusTheme('light');
            } else {
                setGiscusTheme('dark_dimmed');
            }
        }
    })();
</script>

    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2024 - 
        
        2025 allergicrosen
    </section>
    
    <section class="powerby">
        ä½¿ç”¨ <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> æ„å»º <br />
        ä¸»é¢˜ <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.27.0">Stack</a></b> ç”± <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a> è®¾è®¡
    </section>
    
    <section class="running-time">
    æœ¬åšå®¢å·²ç¨³å®šè¿è¡Œ
    <span id="runningdays" class="running-days"></span>
    </section>


        
    <section class="game-link">
        <div class="game-divider">
            <span class="divider-text">ç©ä¸ªå°æ¸¸æˆå§</span>
        </div>
        <a href="/games/2048_game.html" target="_blank" class="game-button">
            <i class="fas fa-gamepad"></i> 2048
        </a>

    

        <a href="/games/Gsnake_game.html" target="_blank" class="game-button">
            <i class="fas fa-gamepad"></i> è´ªåƒè›‡
        </a>
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="www.allergicrosen.xyz/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>





<div id="particles-js"></div>

<script src=www.allergicrosen.xyz/background/particles.min.js></script>
<script>
  particlesJS.load('particles-js', "www.allergicrosen.xyz/background/particlesjs-config.json", function() {
    console.log('particles.js loaded - callback');
  });
</script>

<style>
  #particles-js {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    z-index: -1;
  }
</style>



<script>
  let s1 = '2024-9-09'; 
  s1 = new Date(s1.replace(/-/g, "/"));
  let s2 = new Date();
  let timeDifference = s2.getTime() - s1.getTime();

  let days = Math.floor(timeDifference / (1000 * 60 * 60 * 24));
  let hours = Math.floor((timeDifference % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
  let minutes = Math.floor((timeDifference % (1000 * 60 * 60)) / (1000 * 60));

  let result = days + "å¤©" + hours + "å°æ—¶" + minutes + "åˆ†é’Ÿ";
  document.getElementById('runningdays').innerHTML = result;
</script>

<script>

const live2d_path = "https://fastly.jsdelivr.net/gh/stevenjoezhang/live2d-widget@latest/";

const cssPath = "www.allergicrosen.xyz/waifu/waifu.css"
const waifutipsjsonPath = "www.allergicrosen.xyz/waifu/waifu-tips.json"

function loadExternalResource(url, type) {
	return new Promise((resolve, reject) => {
		let tag;

		if (type === "css") {
			tag = document.createElement("link");
			tag.rel = "stylesheet";
			tag.href = url;
		}
		else if (type === "js") {
			tag = document.createElement("script");
			tag.src = url;
		}
		if (tag) {
			tag.onload = () => resolve(url);
			tag.onerror = () => reject(url);
			document.head.appendChild(tag);
		}
	});
}


if (screen.width >= 768) {
	Promise.all([
		loadExternalResource(cssPath, "css"),
		loadExternalResource(live2d_path + "live2d.min.js", "js"),
		loadExternalResource(live2d_path + "waifu-tips.js", "js")
	]).then(() => {
		
		initWidget({
			waifuPath: waifutipsjsonPath,
			
			cdnPath: "https://fastly.jsdelivr.net/gh/fghrsh/live2d_api/",
			tools: ["hitokoto", "asteroids", "switch-model", "switch-texture", "photo", "info", "quit"]
		});
	});
}

</script>


<script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script>

<script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script>

<meting-js
	server="netease"
    fixed="true"
	type="playlist"
	id="2566074903">
</meting-js>

<script
    src="https://cdn.jsdelivr.net/gh/zhixuan2333/gh-blog@v0.1.0/js/nprogress.min.js"
    integrity="sha384-bHDlAEUFxsRI7JfULv3DTpL2IXbbgn4JHQJibgo5iiXSK6Iu8muwqHANhun74Cqg"
    crossorigin="anonymous"
></script>
<link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/gh/zhixuan2333/gh-blog@v0.1.0/css/nprogress.css"
    integrity="sha384-KJyhr2syt5+4M9Pz5dipCvTrtvOmLk/olWVdfhAp858UCa64Ia5GFpTN7+G4BWpE"
    crossorigin="anonymous"
/>
<script>
    NProgress.start();
    document.addEventListener("readystatechange", () => {
        if (document.readyState === "interactive") NProgress.inc(0.8);
        if (document.readyState === "complete") NProgress.done();
    });
</script>



<script defer src="https://cn.vercount.one/js"></script>
<script>
  function showHideView() {
      
      let viewCounts = document.querySelectorAll("#viewCount");
      if (viewCounts) {
          
          let article =  document.querySelector(".article-page");
          if (!article) {
              viewCounts.forEach(ele => {
                  ele.style.display = 'none';
              });
          }
      }
  }
  
  showHideView();
</script>

<style>
  .highlight {
       
      max-height: 400px;
      overflow: hidden;
  }

  .code-show {
      max-height: none !important;
  }

  .code-more-box {
      width: 100%;
      padding-top: 78px;
      background-image: -webkit-gradient(linear, left top, left bottom, from(rgba(255, 255, 255, 0)), to(#fff));
      position: absolute;
      left: 0;
      right: 0;
      bottom: 0;
      z-index: 1;
  }

  .code-more-btn {
      display: block;
      margin: auto;
      width: 44px;
      height: 22px;
      background: #f0f0f5;
      border-top-left-radius: 8px;
      border-top-right-radius: 8px;
      padding-top: 6px;
      cursor: pointer;
  }

  .code-more-img {
      cursor: pointer !important;
      display: block;
      margin: auto;
      width: 22px;
      height: 16px;
  }
</style>

<script>
function initCodeMoreBox() {
  let codeBlocks = document.querySelectorAll(".highlight");
  if (!codeBlocks) {
    return;
  }
  codeBlocks.forEach(codeBlock => {
    
    if (codeBlock.scrollHeight <= codeBlock.clientHeight) {
      return;
    }
    
    
    let codeMoreBox = document.createElement('div');
    codeMoreBox.classList.add('code-more-box');
    
    let codeMoreBtn = document.createElement('span');
    codeMoreBtn.classList.add('code-more-btn');
    codeMoreBtn.addEventListener('click', () => {
      codeBlock.classList.add('code-show');
      codeMoreBox.style.display = 'none';
      
      window.dispatchEvent(new Event('resize'))
    })
    
    let img = document.createElement('img');
    img.classList.add('code-more-img');
    img.src = "www.allergicrosen.xyz/icons/codeMore.png"
    
    codeMoreBtn.appendChild(img);
    codeMoreBox.appendChild(codeMoreBtn);
    codeBlock.appendChild(codeMoreBox)
  })
}

initCodeMoreBox();
</script>


<style>
  #backTopBtn {
      display: none;
      position: fixed;
      bottom: 15px;
      z-index: 99;
      cursor: pointer;
      width: 30px;
      height: 30px;
      background-image: url(www.allergicrosen.xyz/icons/backTop.svg);
  }
</style>

<script>
  

  function initScrollTop() {
      let rightSideBar = document.querySelector(".right-sidebar");
      if (!rightSideBar) {
          return;
      }
      
      let btn = document.createElement("div");
      btn.id = "backTopBtn";
      btn.onclick = backToTop
      rightSideBar.appendChild(btn)
      
      window.onscroll = function() {
          
          if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
              btn.style.display = "block";
          } else {
              btn.style.display = "none";
          }
      };
  }

  

  function backToTop(){
      window.scrollTo({ top: 0, behavior: "smooth" })
  }

  initScrollTop();
</script>




    </body>
</html>
